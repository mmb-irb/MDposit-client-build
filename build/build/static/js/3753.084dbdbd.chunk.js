"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[2527,3753],{507:(e,n,t)=>{t.d(n,{A:()=>y});var r=t(65043),a=t(2260),s=t(32143),l=t(57972),i=t(37597),o=t(14256),c=t(67784),d=t(17392),u=t(92127),m=t(12639),f=t(17545);const h="style_horizontal__2DIWx",p="style_horizontal-margined__e9fQR";var g=t(70579);const x=[{label:"All residues",value:"residue_indices"},{label:"Interface residues",value:"interface_indices"}],y=e=>{let{interactions:n,selectedInteraction:t,setSelectedInteraction:y,selectedResidues:A,setSelectedResidues:_,selectedOrder:b,handleToggleOrder:v,firstOrderLabel:j,firstOrderTooltip:S,secondOrderLabel:w,secondOrderTooltip:N,toggleOrderTooltip:$,interfaceOnly:C=!1}=e;const R=n[t];return(0,g.jsxs)(r.Suspense,{fallback:(0,g.jsx)(f.A,{}),children:[(0,g.jsx)(a.A,{value:t,onChange:e=>{y(e.target.value)},className:p,children:n.map(((e,n)=>(0,g.jsx)(s.A,{value:n,disabled:e.failed,children:e.label||e.name},n)))}),A&&(0,g.jsx)(l.A,{value:A,onChange:e=>{_(e.target.value)},className:h,children:x.map(((e,n)=>(0,g.jsx)(i.A,{value:e.value,control:(0,g.jsx)(o.A,{color:"primary"}),label:e.label,disabled:"All residues"===e.label&&C},n)))}),void 0!==b&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.A,{label:j,title:S,value:b?R.agent_1:R.agent_2}),(0,g.jsx)(d.A,{title:$,onClick:()=>{v()},size:"large",children:(0,g.jsx)(u.g,{icon:m._qq})}),(0,g.jsx)(c.A,{label:w,title:N,value:b?R.agent_2:R.agent_1})]})]})}},10419:(e,n,t)=>{t.d(n,{A:()=>l});var r=t(65043),a=t(29449),s=t(66496);const l=()=>{const{chains:e,metadata:n,topology:t}=(0,r.useContext)(a.f),{file:l}=(0,r.useContext)(a.I);return(0,r.useMemo)((()=>{if(!t)return[];const r=[],a=n&&n.LIGANDS;if(n&&e){const a=n.CHAINNAMES;if(a)for(const n of e){const e=a[n];r.push({name:e?e+" (Chain "+n+")":"Chain "+n,selection:":"+n})}else{[{name:"Protein",selection:"protein"},{name:"Nucleic acids",selection:"nucleic"}].forEach((e=>{(0,s.w1)(e.selection,l)&&r.push(e)}))}t.chainNames.forEach((n=>{if(-1!==e.indexOf(n))return;if(t.getChainByName(n).residues.every((e=>"ligand"===e.referenceType)))return;const s=a&&a[n]||n;r.push({name:s,selection:":"+n,type:"licorice",color:"purple",opacity:.5})}))}else r.push({name:"Main structure"});if(a)for(const e of a)if("string"===typeof e){const n=t.getReferenceResidueIndices(e);if(!n||0===n.length)continue;const{rangedSelection:a}=t.residueIndices2Ngl(n);r.push({name:e,selection:a,type:"ball+stick",color:"element"})}else{if(!e.ngl)continue;r.push({name:e.name,selection:e.ngl,type:"licorice"})}const i=[];if(t.residueAtomIndices.forEach((e=>{e.length>1||i.push(e[0])})),i.length>0){const e="@"+i.join(",");r.push({name:"Ions",selection:e,type:"spacefill",color:"element"})}const o=[];r.forEach((e=>{const n=void 0===e.type||"cartoon"===e.type,t=(0,s.kn)(e.selection,n,l);o.push(...t)}));const c=t.residueCount,d=[];for(let e=0;e<c;e++)-1===o.indexOf(e)&&d.push(e);if(d.length>0){const{rangedSelection:e}=t.residueIndices2Ngl(d);r.push({name:"Other",selection:e,type:"licorice",color:"grey",opacity:.3})}return r}),[e,n,t,l])}},13826:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var r=t(65043),a=t(26494),s=t(85865),l=t(43845),i=t(58338),o=t(10939),c=t(17545),d=t(34088),u=t(10419),m=t(29449),f=t(95747),h=t(52527),p=t(507),g=t(24310),x=t(70579);const y=["First frame","Second frame"],A=["First frame interface","Second frame interface"],_={base:["red","blue"],interface:[["orange","yellow"],["purple","green"]]},b=()=>{const{accessionAndMdNumber:e,metadata:n,interactions:t,topology:b}=(0,r.useContext)(m.f),v=(0,r.useRef)(null),j=(0,u.A)(),[S,w]=(0,r.useState)(null),[N,$]=(0,r.useState)(0),C=`${f.nP}/${e}/analyses/rmsd-pairwise/`,{loading:R,payload:E,error:O}=(0,i.A)(C),I=(0,r.useMemo)((()=>{if(!t)return[{name:"Overall"}];t.forEach((e=>{e.label=e.name+" (interface residues)"}));return[{name:"Overall"},...t]}),[t]),{rmsds:z,AxesValues:M}=(0,r.useMemo)((()=>{if(!E)return{};const e=I[N],t=E.data.find((n=>n.name===e.name));if(!t)throw new Error(`Dataset for interaction "${e.name}" not found`);const r=t.rmsds,a=r.length,s=Math.floor(n.mdFrames/(a-1));return{rmsds:r,AxesValues:Array(a).fill(void 0).map(((e,n)=>n*s))}}),[E,n,I,N]),[k,F]=(0,r.useState)(null);(0,r.useMemo)((()=>{if(!S)return F(null);F((e=>null===e?S.map(((e,n)=>({name:"Frame "+(0===n?"A":"B"),frame:e}))):(S.forEach(((n,t)=>{const r=e[t];r.name="Frame "+(0===t?"A":"B"),r.frame=n})),[...e])))}),[S]);const[T,D]=(0,r.useState)(null);return(0,r.useMemo)((()=>{if(!k)return D(null);const e=I[N],n=[{name:e.agent_1,interface:e.interface_indices_1},{name:e.agent_2,interface:e.interface_indices_2}];D((e=>{const t=[],r=N>0,a=!(!e||!e.find((e=>e.reference&&e.reference.includes(A[0]))));return null===e?k.forEach(((e,n)=>{j.forEach((a=>{const s={...a};s.name=`${e.name} - ${a.name}`,s.color=_.base[n],s.component=e.name,s.reference=`${y[n]} - ${a.name}`,r&&(s.name+=" reference",s.opacity=.1),t.push(s)}))})):k.forEach(((n,s)=>{j.forEach((l=>{const i=`${y[s]} - ${l.name}`,o=e.find((e=>e.reference===i));if(!o)throw new Error(`No previous representation with reference ${i}`);const c=o.name.split(" - ")[0];o.name=o.name.replace(c,n.name),o.component=n.name,r&&!a&&(o.name+=" reference",o.opacity=.1),!r&&a&&(o.name=o.name.replace(" reference",""),o.opacity=1),t.push(o)}))})),r&&(!1===a?k.forEach(((e,r)=>{n.forEach(((n,a)=>{const s=n.interface&&b.residueIndices2Ngl(n.interface);t.push({name:`${e.name} - ${n.name} interface`,color:_.interface[r][a],selection:s.rangedSelection,type:"licorice",component:e.name,reference:`${A[r]} - ${n.name}`})}))})):k.forEach(((r,a)=>{n.forEach((n=>{const s=n.interface&&b.residueIndices2Ngl(n.interface),l=`${A[a]} - ${n.name}`,i=e.find((e=>e.reference===l));i.name=`${r.name} - ${n.name} interface`,i.selection=s.rangedSelection,i.component=r.name,t.push(i)}))}))),e&&e.filter((e=>e.custom)).forEach((e=>{e.component=k[0].name,t.push(e)})),t}))}),[k,b,I,N,j]),R?(0,x.jsx)(c.A,{}):O?O.toString():E?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.A,{children:(0,x.jsxs)(a.A,{className:h.default.horizontal,children:[(0,x.jsx)(s.A,{variant:"h6",children:"Residues selection:"}),(0,x.jsx)(p.A,{interactions:I,selectedInteraction:N,setSelectedInteraction:$}),S&&(0,x.jsxs)("div",{children:[k&&k.map(((e,n)=>(0,x.jsx)(l.A,{label:"Frame "+e.frame,style:{margin:"0.2em",backgroundColor:0===n?"red":"blue"}},n))),N>0&&k&&k.map(((e,n)=>{const t=I[N];return[t.agent_1,t.agent_2].map(((t,r)=>(0,x.jsx)(l.A,{label:"Frame "+e.frame+" - "+t,style:{margin:"0.2em",backgroundColor:0===r?0===n?"orange":"purple":0===n?"yellow":"green"}},r)))}))]})]})}),(0,x.jsx)(o.A,{className:h.default.margined,id:"heatmap",children:(0,x.jsx)(a.A,{children:(0,x.jsx)(g.A,{inputData:{data:z,xLabels:M,yLabels:M},onTooltip:e=>{let{value:n,xAxisValue:t,yAxisValue:r}=e;return`${t} - ${r}\n${Math.round(100*n)/100} \xc5`},onClick:e=>{let{xAxisValue:n,yAxisValue:t}=e;return w([n,t])},legendTitle:"RMSD (\xc5)",maxColor:"red",minColor:"blue",xTitle:"Frames",yTitle:"Frames"})})}),(0,x.jsx)(d.A,{newViewer:k?{componentsState:[k,F],representationsState:[T,D],selRef:S,viewerRef:v}:null,onNail:e=>w((n=>e.selRef===n?null:n)),onClose:e=>w((n=>e.selRef===n?null:n))})]}):"Something bad happened"}},34088:(e,n,t)=>{t.d(n,{A:()=>m});var r=t(65043),a=t(43126),s=t(10939);const l="style_rnd__Txifm",i="style_floating-card__HHpby";var o=t(70579);const c=(0,r.lazy)((()=>Promise.all([t.e(7784),t.e(8095),t.e(3845),t.e(9070),t.e(2594),t.e(7955),t.e(349),t.e(1235),t.e(9117)]).then(t.bind(t,92428))));let d=0;const u=e=>{const n=e.viewerRef||(0,r.useRef)(null),[t,u]=(0,r.useState)((()=>{const{innerWidth:e,innerHeight:n,scrollY:t}=window,r=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,n/4),150),s=1.5*a;return{width:2*a,height:s,x:0,y:n-r-s-20+t}}));return(0,o.jsx)(a.p,{position:{x:t.x,y:t.y},size:{width:t.width,height:t.height},style:{zIndex:(d+=1,d)},className:l,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{u({...t})},onResizeStart:()=>{u({...t})},onDragStop:(e,n)=>{0===e.layerX&&0===e.layerY||t.x===n.x&&t.y===n.y||u({...t,x:n.x,y:n.y})},onResize:()=>n.current&&n.current.autoResize(),onResizeStop:(e,n,t,r,a)=>{u({width:t.style.width,height:t.style.height,...a})},children:(0,o.jsx)(s.A,{className:i,elevation:4,children:(0,o.jsx)(r.Suspense,{fallback:null,children:(0,o.jsx)(c,{className:i,ref:n,startsPlaying:!1,...e})})})})},m=e=>{let{newViewer:n,nailing:t=!0,onNail:a,onClose:s}=e;const[l,i]=(0,r.useState)([]),c=[...l],d=(0,r.useRef)([]);if(n){const e=()=>{let e=0;for(;e<999;){if(-1===d.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};n.id=e(),n.close=()=>{t&&i((e=>{const t=[...e],r=e.indexOf(n);return-1!==r&&t.splice(r,1),t})),s&&s(n),d.current.push(n.id)},t&&(n.nail=()=>{i((e=>[...e,n])),a&&a(n),d.current.push(n.id)}),c.push(n)}return c.map((e=>(0,o.jsx)(u,{...e},e.id)))}},52527:(e,n,t)=>{t.r(n),t.d(n,{default:()=>r});const r={widest:"style_widest__hZ7sO",margined:"style_margined__GphyO","margined-bottom":"style_margined-bottom__KpiYO",horizontal:"style_horizontal__1xLer"}}}]);
//# sourceMappingURL=3753.084dbdbd.chunk.js.map