"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[942,8870],{507:(e,s,t)=>{t.d(s,{A:()=>p});var n=t(65043),i=t(2260),a=t(32143),l=t(57972),r=t(37597),d=t(14256),o=t(67784),c=t(17392),u=t(92127),h=t(12639),f=t(17545);const x="style_horizontal__2DIWx",g="style_horizontal-margined__e9fQR";var m=t(70579);const _=[{label:"All residues",value:"residue_indices"},{label:"Interface residues",value:"interface_indices"}],p=e=>{let{interactions:s,selectedInteraction:t,setSelectedInteraction:p,selectedResidues:y,setSelectedResidues:b,selectedOrder:v,handleToggleOrder:A,firstOrderLabel:j,firstOrderTooltip:R,secondOrderLabel:S,secondOrderTooltip:w,toggleOrderTooltip:C,interfaceOnly:D=!1}=e;const O=s[t];return(0,m.jsxs)(n.Suspense,{fallback:(0,m.jsx)(f.A,{}),children:[(0,m.jsx)(i.A,{value:t,onChange:e=>{p(e.target.value)},className:g,children:s.map(((e,s)=>(0,m.jsx)(a.A,{value:s,disabled:e.failed,children:e.label||e.name},s)))}),y&&(0,m.jsx)(l.A,{value:y,onChange:e=>{b(e.target.value)},className:x,children:_.map(((e,s)=>(0,m.jsx)(r.A,{value:e.value,control:(0,m.jsx)(d.A,{color:"primary"}),label:e.label,disabled:"All residues"===e.label&&D},s)))}),void 0!==v&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(o.A,{label:j,title:R,value:v?O.agent_1:O.agent_2}),(0,m.jsx)(c.A,{title:C,onClick:()=>{A()},size:"large",children:(0,m.jsx)(u.g,{icon:h._qq})}),(0,m.jsx)(o.A,{label:S,title:w,value:v?O.agent_2:O.agent_1})]})]})}},34088:(e,s,t)=>{t.d(s,{A:()=>h});var n=t(65043),i=t(43126),a=t(10939);const l="style_rnd__Txifm",r="style_floating-card__HHpby";var d=t(70579);const o=(0,n.lazy)((()=>Promise.all([t.e(7784),t.e(8095),t.e(3845),t.e(9070),t.e(2594),t.e(7955),t.e(349),t.e(1235),t.e(9117)]).then(t.bind(t,92428))));let c=0;const u=e=>{const s=e.viewerRef||(0,n.useRef)(null),[t,u]=(0,n.useState)((()=>{const{innerWidth:e,innerHeight:s,scrollY:t}=window,n=document.querySelector("main").offsetTop,i=Math.max(Math.min(e/4,s/4),150),a=1.5*i;return{width:2*i,height:a,x:0,y:s-n-a-20+t}}));return(0,d.jsx)(i.p,{position:{x:t.x,y:t.y},size:{width:t.width,height:t.height},style:{zIndex:(c+=1,c)},className:l,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{u({...t})},onResizeStart:()=>{u({...t})},onDragStop:(e,s)=>{0===e.layerX&&0===e.layerY||t.x===s.x&&t.y===s.y||u({...t,x:s.x,y:s.y})},onResize:()=>s.current&&s.current.autoResize(),onResizeStop:(e,s,t,n,i)=>{u({width:t.style.width,height:t.style.height,...i})},children:(0,d.jsx)(a.A,{className:r,elevation:4,children:(0,d.jsx)(n.Suspense,{fallback:null,children:(0,d.jsx)(o,{className:r,ref:s,startsPlaying:!1,...e})})})})},h=e=>{let{newViewer:s,nailing:t=!0,onNail:i,onClose:a}=e;const[l,r]=(0,n.useState)([]),o=[...l],c=(0,n.useRef)([]);if(s){const e=()=>{let e=0;for(;e<999;){if(-1===c.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};s.id=e(),s.close=()=>{t&&r((e=>{const t=[...e],n=e.indexOf(s);return-1!==n&&t.splice(n,1),t})),a&&a(s),c.current.push(s.id)},t&&(s.nail=()=>{r((e=>[...e,s])),i&&i(s),c.current.push(s.id)}),o.push(s)}return o.map((e=>(0,d.jsx)(u,{...e},e.id)))}},54519:(e,s,t)=>{t.r(s),t.d(s,{default:()=>b});var n=t(65043),i=t(26494),a=t(85865),l=t(8939),r=t(24056),d=t(58338),o=t(10939),c=t(17545),u=t(34088),h=t(29449),f=t(95747),x=t(507),g=t(24310),m=t(58870),_=t(70579);const p={r:0,g:0,b:255},y={r:255,g:0,b:0},b=()=>{const{accessionAndMdNumber:e,topology:s,interactions:t}=(0,n.useContext)(h.f),[b,v]=(0,n.useState)(0),[A,j]=(0,n.useState)("interface_indices"),[R,S]=(0,n.useState)(null),[w,C]=(0,n.useState)("mean"),D=`${f.nP}/${e}/analyses/dist-perres/`,{loading:O,payload:T,error:z}=(0,d.A)(D),{heatmapData:I,residuesX:N,residuesY:k,xTitle:L,yTitle:M,isReduced:V}=(0,n.useMemo)((()=>{if(O||z||!T||!s||!t)return{};const e=t[b],n=T.data.find((s=>s.name===e.name)),i="mean"===w?n.means:n.stdvs;let a;const l=i[0].length,r=i.length;if(r===e.residue_indices_2.length&&l===e.residue_indices_1.length)a=!1;else{if(r!==e.interface_indices_2.length||l!==e.interface_indices_1.length)throw new Error("The numbers of values in data does not match any number of residues in the interaction (neither all or interface)");a=!0}const d=e[A+"_1"],o=e[A+"_2"];let c=[];if(a)if("interface_indices"===A)c=i;else{const s=e.interface_indices_1,t=e.interface_indices_2;for(const e of o){const n=t.indexOf(e);let a;if(-1!==n){a=[];for(const e of d){const t=s.indexOf(e);-1!==t?a.push(i[n][t]):a.push(10)}c.push(a)}else{const e=d.length;a=new Array(e).fill(10),c.push(a)}}}else if("residue_indices"===A)c=i;else{const s=e.residue_indices_1,t=e.residue_indices_2;for(const e of o){const n=t.indexOf(e),a=[];for(const e of d){const t=s.indexOf(e);a.push(i[n][t])}c.push(a)}}const[u,h]=[d,o].map((e=>e.map((e=>s.getResidueByIndex(e).standardLabel))));return{heatmapData:{data:c,xLabels:u,yLabels:h},residuesX:d,residuesY:o,xTitle:e.agent_1,yTitle:e.agent_2,isReduced:a}}),[O,z,T,s,t,b,A,w]),H=(0,n.useCallback)((e=>{const t=s.getResidueByIndex(e);return{forResidue:e,forDistance:t.hasCAlpha?t.number.toString()+":"+t.chainName+".CA":null}}),[s]),W=(0,n.useCallback)((e=>{let{value:s,xAxisValue:t,yAxisValue:n}=e;return t+" - "+n+"\n"+Math.round(100*s)/100+" \xc5"}),[]),Y=(0,n.useCallback)((e=>{let{xIndex:s,yIndex:t}=e;const n=H(N[s]),i=H(k[t]);S({residues:[n.forResidue,i.forResidue],distance:n.forDistance&&i.forDistance&&[[n.forDistance,i.forDistance]]})}),[N,k,H]);if(O)return(0,_.jsx)(c.A,{});if(z)return z.toString();if(!T)return"Something bad happened";if(!s||!t)return(0,_.jsx)(c.A,{});return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(o.A,{children:(0,_.jsxs)(i.A,{className:m.default.horizontal,children:[(0,_.jsx)(a.A,{variant:"h6",children:"Residues selection:"}),(0,_.jsx)(x.A,{interactions:t,selectedInteraction:b,setSelectedInteraction:v,selectedResidues:A,setSelectedResidues:j,interfaceOnly:V})]})}),(0,_.jsx)(o.A,{className:m.default.margined,id:"heatmap",children:(0,_.jsxs)(i.A,{children:[(0,_.jsxs)(l.A,{value:w,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:(e,s)=>{C(s)},className:m.default["margined-bottom"],children:[(0,_.jsx)(r.A,{value:"mean",label:"Residues distance averages"}),(0,_.jsx)(r.A,{value:"stdv",label:"Residues distance standard deviations"})]}),(0,_.jsx)(g.A,{inputData:I,onTooltip:W,onClick:Y,legendTitle:"mean"===w?"Distance average (\xc5)":"Distance standard deviation (\xc5)",maxValueColor:p,minValueColor:y,totalHeight:1===I.yLabels.length?30:void 0,xTitle:L,yTitle:M})]})}),(0,_.jsx)(u.A,{newViewer:R?{selectedResidueIndices:R.residues,selectedDistances:R.distance}:null,onNail:e=>S((s=>s&&s.residues===e.selectedResidueIndices?null:s)),onClose:e=>S((s=>s&&s.residues===e.selectedResidueIndices?null:s))})]})}},58870:(e,s,t)=>{t.r(s),t.d(s,{default:()=>n});const n={margined:"style_margined__JbZJ6","margined-bottom":"style_margined-bottom__WRBwE",horizontal:"style_horizontal__NH+ZS"}}}]);
//# sourceMappingURL=942.c26b2a7b.chunk.js.map