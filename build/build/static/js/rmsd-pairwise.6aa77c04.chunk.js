"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3682],{10419:(e,n,r)=>{r.d(n,{A:()=>o});var t=r(65043),a=r(29449),s=r(66496);const o=()=>{const{chains:e,metadata:n,topology:r}=(0,t.useContext)(a.f),{file:o}=(0,t.useContext)(a.I);return(0,t.useMemo)((()=>{if(!r)return[];const t=[],a=n&&n.LIGANDS;if(n&&e){const a=n.CHAINNAMES;if(a)for(const n of e){const e=a[n];t.push({name:e?e+" (Chain "+n+")":"Chain "+n,selection:":"+n})}else{[{name:"Protein",selection:"protein"},{name:"Nucleic acids",selection:"nucleic"}].forEach((e=>{(0,s.w1)(e.selection,o)&&t.push(e)}))}r.chainNames.forEach((n=>{if(-1!==e.indexOf(n))return;if(r.getChainByName(n).residues.every((e=>e.isLigand)))return;const s=a&&a[n]||n;t.push({name:s,selection:":"+n,type:"licorice",color:"purple",opacity:.5})}))}else t.push({name:"Main structure"});if(a)for(const e of a)if("string"===typeof e){const n=r.getReferenceResidueIndices(e);if(!n||0===n.length)continue;const{rangedSelection:a}=r.residueIndices2Ngl(n);t.push({name:e,selection:a,type:"ball+stick",color:"element"})}else{if(!e.ngl)continue;t.push({name:e.name,selection:e.ngl,type:"licorice"})}const c=[];if(r.residueAtomIndices.forEach((e=>{e.length>1||c.push(e[0])})),c.length>0){const e="@"+c.join(",");t.push({name:"Ions",selection:e,type:"spacefill",color:"element"})}const i=[];t.forEach((e=>{const n=void 0===e.type||"cartoon"===e.type,r=(0,s.kn)(e.selection,n,o);i.push(...r)}));const l=r.residueCount,m=[];for(let e=0;e<l;e++)-1===i.indexOf(e)&&m.push(e);if(m.length>0){const{rangedSelection:e}=r.residueIndices2Ngl(m);t.push({name:"Other",selection:e,type:"licorice",color:"grey",opacity:.3})}return t}),[e,n,r,o])}},68542:(e,n,r)=>{r.r(n),r.d(n,{default:()=>S});var t=r(65043),a=r(26494),s=r(85865),o=r(43845),c=r(58338),i=r(10939),l=r(17545),m=r(34088),u=r(10419),f=r(29449),d=r(95747);const p="style_margined__GphyO",h="style_horizontal__1xLer";var g=r(507),y=r(24310),x=r(70579);const A=["First frame","Second frame"],$=["First frame interface","Second frame interface"],E={base:["red","blue"],interface:[["orange","yellow"],["purple","green"]]},S=()=>{const{accessionAndMdNumber:e,metadata:n,interactions:r,topology:S}=(0,t.useContext)(f.f),b=(0,t.useRef)(null),C=(0,u.A)(),[N,j]=(0,t.useState)(null),[w,_]=(0,t.useState)(0),v=`${d.nP}/${e}/analyses/rmsd-pairwise/`,{loading:I,payload:M,error:F}=(0,c.A)(v),k=(0,t.useMemo)((()=>{if(!r)return[{name:"Overall"}];r.forEach((e=>{e.label=e.name+" (interface residues)"}));return[{name:"Overall"},...r]}),[r]),{rmsds:R,AxesValues:V}=(0,t.useMemo)((()=>{if(!M)return{};const e=k[w],r=M.data.find((n=>n.name===e.name));if(!r)throw new Error(`Dataset for interaction "${e.name}" not found`);const t=r.rmsds,a=t.length,s=Math.floor(n.mdFrames/(a-1));return{rmsds:t,AxesValues:Array(a).fill(void 0).map(((e,n)=>n*s))}}),[M,n,k,w]),[O,L]=(0,t.useState)(null);(0,t.useMemo)((()=>{if(!N)return L(null);L((e=>null===e?N.map(((e,n)=>({name:`${n}. Frame ${e}`,frame:e}))):(N.forEach(((n,r)=>{const t=e[r];t.name=`${r}. Frame ${n}`,t.frame=n})),[...e])))}),[N]);const[D,T]=(0,t.useState)(null);return(0,t.useMemo)((()=>{if(!O)return T(null);const e=k[w],n=[{name:e.agent_1,interface:e.interface_indices_1},{name:e.agent_2,interface:e.interface_indices_2}];T((e=>{const r=[],t=w>0,a=!(!e||!e.find((e=>e.reference&&e.reference.includes($[0]))));return null===e?O.forEach(((e,n)=>{C.forEach((a=>{const s={...a};s.name=`${e.name} - ${a.name}`,s.color=E.base[n],s.component=e.name,s.reference=`${A[n]} - ${a.name}`,t&&(s.name+=" reference",s.opacity=.1),r.push(s)}))})):O.forEach(((n,s)=>{C.forEach((o=>{const c=`${A[s]} - ${o.name}`,i=e.find((e=>e.reference===c));if(!i)throw new Error(`No previous representation with reference ${c}`);const l=i.name.split(" - ")[0];i.name=i.name.replace(l,n.name),i.component=n.name,t&&!a&&(i.name+=" reference",i.opacity=.1),!t&&a&&(i.name=i.name.replace(" reference",""),i.opacity=1),r.push(i)}))})),t&&(!1===a?O.forEach(((e,t)=>{n.forEach(((n,a)=>{const s=n.interface&&S.residueIndices2Ngl(n.interface);r.push({name:`${e.name} - ${n.name} interface`,color:E.interface[t][a],selection:s.rangedSelection,type:"licorice",component:e.name,reference:`${$[t]} - ${n.name}`})}))})):O.forEach(((t,a)=>{n.forEach((n=>{const s=n.interface&&S.residueIndices2Ngl(n.interface),o=`${$[a]} - ${n.name}`,c=e.find((e=>e.reference===o));c.name=`${t.name} - ${n.name} interface`,c.selection=s.rangedSelection,c.component=t.name,r.push(c)}))}))),e&&e.filter((e=>e.custom)).forEach((e=>{e.component=O[0].name,r.push(e)})),r}))}),[O,S,k,w,C]),I?(0,x.jsx)(l.A,{}):F?F.toString():M?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.A,{children:(0,x.jsxs)(a.A,{className:h,children:[(0,x.jsx)(s.A,{variant:"h6",children:"Residues selection:"}),(0,x.jsx)(g.A,{interactions:k,selectedInteraction:w,setSelectedInteraction:_}),N&&(0,x.jsxs)("div",{children:[O&&O.map(((e,n)=>(0,x.jsx)(o.A,{label:"Frame "+e.frame,style:{margin:"0.2em",backgroundColor:0===n?"red":"blue"}},n))),w>0&&O&&O.map(((e,n)=>{const r=k[w];return[r.agent_1,r.agent_2].map(((r,t)=>(0,x.jsx)(o.A,{label:"Frame "+e.frame+" - "+r,style:{margin:"0.2em",backgroundColor:0===t?0===n?"orange":"purple":0===n?"yellow":"green"}},t)))}))]})]})}),(0,x.jsx)(i.A,{className:p,id:"heatmap",children:(0,x.jsx)(a.A,{children:(0,x.jsx)(y.A,{inputData:{data:R,xLabels:V,yLabels:V},onTooltip:e=>{let{value:n,xAxisValue:r,yAxisValue:t}=e;return`${r} - ${t}\n${Math.round(100*n)/100} \xc5`},onClick:e=>{let{xAxisValue:n,yAxisValue:r}=e;return j([n,r])},legendTitle:"RMSD (\xc5)",maxColor:"red",minColor:"blue",xTitle:"Frames",yTitle:"Frames"})})}),(0,x.jsx)(m.A,{newViewer:O?{componentsState:[O,L],representationsState:[D,T],selRef:N,viewerRef:b}:null,onNail:e=>j((n=>e.selRef===n?null:n)),onClose:e=>j((n=>e.selRef===n?null:n))})]}):"Something bad happened"}}}]);
//# sourceMappingURL=rmsd-pairwise.6aa77c04.chunk.js.map