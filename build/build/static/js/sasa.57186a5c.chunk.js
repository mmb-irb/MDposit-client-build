"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[1079,9117],{64711:(e,s,t)=>{t.r(s),t.d(s,{default:()=>_});var a=t(65043),n=t(89257),l=t(85865),r=t(32577),o=t(10939),i=t(92428),c=t(10419),d=t(17545),u=t(58338),p=t(29449),m=t(95747);const h="style_graphcard__Cgh8H",f="style_graph__rikGP",x="style_graph-placeholder__ef29F",g="style_nglcard__lD0br",y="style_container__lvt9H";var b=t(82746),A=t(48838),S=t(75291),C=t(70579);const v={triggerOnce:!0,rootMargin:"100px"},k=["grey","yellow","red"],j={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},_=()=>{const[e,s]=(0,n.Wx)(v),{accession:t,accessionAndMdNumber:_,metadata:R,topology:M,populations:N}=(0,a.useContext)(p.f),T=(0,c.A)(),$=(0,a.useRef)(null),I=(0,a.useRef)(null),{loading:w,payload:E,error:L}=(0,u.A)(`${m.nP}/${_}/analyses/sasa/`),[P,D]=(0,a.useState)([]),{components:F,representations:W,framesNumber:H,xAxisStep:B,xAxisLabel:Y,isEnsemble:G,xTooltip:O,xWeights:U,data:V}=(0,a.useMemo)((()=>{if(!M||!R||!E||N&&N.loading)return{};const e=M.residueCount;if(e!==E.saspf.length)throw new Error("Number of residues in the analysis does not match number of residues in the topology");const s={saspf:[],means:[],stdvs:[]};for(let r=0;r<e;r++){1===M.getResidueByIndex(r).atomCount?(s.saspf[r]=null,s.means[r]=null,s.stdvs[r]=null):(s.saspf[r]=E.saspf[r],s.means[r]=E.means[r],s.stdvs[r]=E.stdvs[r])}let t;for(let r=0;r<e;r++)if(s.saspf[r]){if(void 0!==t){t=null;break}t=r}null!==t&&D([{color:"black",index:t}]);const a=s.means,n=Math.max(...a),l=Math.min(...a),o=(0,r.m4Y)().range(k).domain([l,(l+n)/2,n]),i=b.ColormakerRegistry.addScheme((function(e){this.atomColor=e=>{const s=e.residueIndex;if(1===M.getResidueByIndex(s).atomCount)return 16777215;const t=a[s];if(null===t)return 16777215;const n=(0,r.yWT)(o(t)).formatHex();return parseInt(n.substring(1),16)}})),c=E.step,d=[{trajectoryURLs:[`${`${m.nP}/${_}/files/trajectory`}?frames=1:${R.mdFrames}:${c}`]}],u=[];T.forEach((e=>{const s={...e};s.color="custom",s.customScheme=i,s.type="spacefill",u.push(s)}));const p=s.saspf[0].length,h=R.timeLength,f="ensemble"===R.TYPE;let x,g,y,A;if(f||!h?(x=c,g="Frames",y=e=>"frame "+e):(x=h/(p-1),g="Time (ns)",y=e=>+e.toFixed(2)+" ns"),N&&N.payload){A=[];for(let e=0;e<N.payload.length;e+=x)A.push(N.payload[e])}return{components:d,representations:u,framesNumber:p,xAxisStep:x,xAxisLabel:g,isEnsemble:f,xTooltip:y,xWeights:A,data:s}}),[E,M,R,t,T,N,D]),{selectedData:q,selectedResidueIndices:z}=(0,a.useMemo)((()=>{const e={},s=[];return P.forEach(((t,a)=>{const n={data:V.saspf[t.index]};n.color=t.color,e[a]=n,s.push(t.index)})),{selectedData:e,selectedResidueIndices:s}}),[V,P]),J=(0,a.useCallback)((e=>{$.current.togglePlaying(!1),$.current.currentFrame=e}),[]),K=(0,a.useCallback)((e=>{if(!I.current)return;const s=Math.round(e*(H-1));I.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]}),[H]),Q=(0,a.useCallback)(((e,s,t)=>{const a={color:t,index:s};D((e=>[...e,a]))}),[D]),X=(0,a.useCallback)(((e,s)=>{D((e=>e.filter((e=>e.index!==s))))}),[D]),Z=(0,a.useCallback)((()=>{D([])}),[D]),ee=(0,a.useCallback)(((e,s)=>{const t=V.means[s],a=V.stdvs[s];return`Mean SAS: ${Math.round(100*t)/100}\nStandard deviation: ${Math.round(100*a)/100}`}),[V]);return w||N&&N.loading?(0,C.jsx)(d.A,{}):L?L.toString():N&&N.error?N.error.toString():E?N&&!N.payload?"Something bad happened with populations":M&&R?(0,C.jsxs)(a.Suspense,{fallback:(0,C.jsx)(d.A,{}),children:[M.residueCount>1&&(0,C.jsx)(o.A,{children:(0,C.jsx)(A.A,{residueValues:V.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:Q,onDeselect:X,onClean:Z,onTooltip:ee})}),(0,C.jsx)(o.A,{className:h,children:P.length>0?(0,C.jsx)(S.default,{yData:q,step:B,xAxisLabel:Y,yAxisLabel:"Relative SAS (\xc5\xb2)",type:G?"dots":"line",xWeights:U,xTooltip:O,onSelect:J,className:f,ref:I}):(0,C.jsx)("div",{className:x,children:(0,C.jsx)(l.A,{variant:"h6",children:"No residue selected"})})}),(0,C.jsx)(o.A,{className:g,ref:e,children:s?(0,C.jsx)(i.default,{className:y,startingComponents:F,startingRepresentations:W,selectedResidueIndices:z,onProgress:K,ref:$,framesSelect:!1,highlightTypes:j}):(0,C.jsx)("div",{style:{height:"50vh"}})})]}):(0,C.jsx)(d.A,{}):"Something bad happened"}}}]);
//# sourceMappingURL=sasa.57186a5c.chunk.js.map