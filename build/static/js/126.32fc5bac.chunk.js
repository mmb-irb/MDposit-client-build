"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[126,3283],{10126:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var s=n(65043),a=n(83283),r=n(58338),i=n(41399),o=n(29449),l=n(95747),d=n(26494),c=n(85865),u=n(99070),h=n(10939),m=n(17545),f=n(38030),p=n(34088),g=n(92249),y=n(70579);const x=(0,s.lazy)(()=>n.e(1483).then(n.bind(n,53099))),v=()=>{const{accessionAndMdNumber:e,files:t}=(0,s.useContext)(o.f),[n,v]=(0,s.useState)(null),[w,_]=(0,s.useState)(14),[b,j]=(0,s.useState)(20),[A,N]=(0,s.useState)("Overall"),S=(0,r.A)(`${l.nP}/${e}/analyses/clusters`),M=(0,s.useMemo)(()=>S&&S.payload&&S.payload.map(e=>e.name),[S]),z=(0,s.useMemo)(()=>{if(!S.payload)return;const e=S.payload.find(e=>e.name===A);if(!e)throw new Error(`Analysis ${A} is not found in the summary`);return e.analysis},[A,S.payload]),C=z?`${l.nP}/${e}/analyses/${z}`:null,R=(0,r.A)(C),$=(0,s.useRef)(R.payload);(0,s.useMemo)(()=>{R.payload&&($.current=R.payload)},[R.payload]);const k=$.current,E=(0,s.useMemo)(()=>{if(!z)return[];const n=`${z.replace("-","_")}_screenshot_`;return t.filter(e=>e.includes(n)).sort().map(t=>`${l.nP}/${e}/files/${t}`)},[t,z]),q=(0,i.A)(E),P=q.some(e=>e.loading),D=(0,s.useRef)(null);(0,s.useMemo)(()=>{P||(D.current=q.map(e=>e&&e.payload?"data:image/png;base64,"+Buffer.from(e.payload,"binary").toString("base64"):null))},[q,P]);const F=D.current,{graphData:O,availableLinks:I,clusterIndices:L,version:Y,step:H}=(0,s.useMemo)(()=>{if(!k)return{};k.clusters.forEach((e,t)=>{e.index=t});const e=[...k.clusters].sort((e,t)=>t.frames.length-e.frames.length).slice(0,w),t=e.map(e=>e.main),n=e.reduce((e,t)=>e+t.frames.length,0),s=e.map(e=>e.frames.length/n),a=e.map(e=>e.index),r=s[0],i=[];s.forEach((e,n)=>{const s=1e4*e/r,a={id:n,radius:Math.sqrt(s/Math.PI),value:t[n],text:`Population: ${Math.round(1e4*e)/100} %\nFrame: ${t[n]}`};i.push(a)});const o=[],l=k.transitions.filter(e=>a.includes(e.from)&&a.includes(e.to)),d=l.length,c=l.sort((e,t)=>t.count-e.count),u=c.map(e=>e.count),h=u[0],m=u[u.length-1],f=h===m?1:9/(m-h);c.forEach((e,t)=>{if(t>=b)return;const n=a.indexOf(e.from);if(-1===n)throw new Error("Not found source cluster index");const s=a.indexOf(e.to);if(-1===s)throw new Error("Not found target cluster index");const r=10-(e.count-h)*f,i=o.find(e=>e.source===s&&e.target===n);if(i)i.width+=r;else{const e={source:n,target:s,width:r};o.push(e)}});const p=new g.A(k.version),y=k.step;return{graphData:{nodes:i,links:o},availableLinks:d,clusterIndices:a,version:p,step:y}},[k,w,b]),T=(0,s.useMemo)(()=>{if(L&&F)return L.map(e=>F[e])},[L,F]),V=(0,s.useCallback)(e=>{const t=Y.equals("0.0")?e.value*H:e.value;v(t)},[v,Y,H]);return k?T?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.A,{className:a.default["vertical-margin"],children:(0,y.jsx)(f.A,{label:"Clusters analysis",options:M,selection:A,setter:N})}),(0,y.jsx)(h.A,{children:(0,y.jsxs)("div",{className:R.loading?a.default.disabled:a.default.enabled,children:[(0,y.jsx)(x,{data:O,images:T,selectedNodeValue:n,onSelectNode:V,className:a.default.graph}),(0,y.jsxs)(d.A,{children:[(0,y.jsxs)("div",{className:a.default.horizontal,children:[(0,y.jsx)(c.A,{variant:"h7",className:a.default.wide25,children:"Number of nodes: "}),(0,y.jsx)(u.Ay,{title:"Change number of nodes",value:w,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{_(t)},min:2,max:k.clusters.length,valueLabelDisplay:"auto",className:a.default.wide75})]}),(0,y.jsxs)("div",{className:a.default.horizontal,children:[(0,y.jsx)(c.A,{variant:"h7",className:a.default.wide25,children:"Number of links: "}),(0,y.jsx)(u.Ay,{title:"Change the RMSD cutoff",value:b,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{j(t)},min:0,max:I,valueLabelDisplay:"auto",className:a.default.wide75})]})]})]})}),(0,y.jsx)(p.A,{newViewer:n?{requestedFrame:n}:null,onNail:e=>v(t=>e.requestedFrame===t?null:t),onClose:e=>v(t=>e.requestedFrame===t?null:t)})]}):(0,y.jsx)(m.A,{}):R.loading?(0,y.jsx)(m.A,{}):R.error?R.error.toString():"Something bad happened"}},10939:(e,t,n)=>{n.d(t,{A:()=>c});var s=n(65043),a=n(12110),r=n(17604);const i="style_container__M9GCG";var o=n(70579);const l={opacity:[0,1]};(0,r.A)()||(l.transform=["translateY(50px)","translateY(0)"]);const d={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},c=(0,s.forwardRef)((e,t)=>{let{overrideComponent:n,...r}=e;const c=(0,s.useRef)(null);(0,s.useLayoutEffect)(()=>{const e=c.current&&c.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex(t=>e===t),n=e.animate(l,{...d,delay:150*t});return()=>n.cancel()},[]);const u=n?"section":a.A;return(0,o.jsx)("div",{ref:c,className:i,children:(0,o.jsx)(u,{component:"section",...r,ref:t})})})},34088:(e,t,n)=>{n.d(t,{A:()=>h});var s=n(65043),a=n(43126),r=n(10939);const i="style_rnd__Txifm",o="style_floating-card__HHpby";var l=n(70579);const d=(0,s.lazy)(()=>Promise.all([n.e(7784),n.e(8095),n.e(3845),n.e(9070),n.e(247),n.e(7955),n.e(8677),n.e(3471),n.e(335),n.e(9117)]).then(n.bind(n,14696)));let c=0;const u=e=>{const t=e.viewerRef||(0,s.useRef)(null),[n,u]=(0,s.useState)(()=>{const{innerWidth:e,innerHeight:t,scrollY:n}=window,s=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,t/4),150),r=1.5*a;return{width:2*a,height:r,x:0,y:t-s-r-20+n}});return(0,l.jsx)(a.p,{position:{x:n.x,y:n.y},size:{width:n.width,height:n.height},style:{zIndex:(c+=1,c)},className:i,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{u({...n})},onResizeStart:()=>{u({...n})},onDragStop:(e,t)=>{0===e.layerX&&0===e.layerY||n.x===t.x&&n.y===t.y||u({...n,x:t.x,y:t.y})},onResize:()=>t.current&&t.current.autoResize(),onResizeStop:(e,t,n,s,a)=>{u({width:n.style.width,height:n.style.height,...a})},children:(0,l.jsx)(r.A,{className:o,elevation:4,children:(0,l.jsx)(s.Suspense,{fallback:null,children:(0,l.jsx)(d,{className:o,ref:t,startsPlaying:!1,...e})})})})},h=e=>{let{newViewer:t,nailing:n=!0,onNail:a,onClose:r}=e;const[i,o]=(0,s.useState)([]),d=[...i],c=(0,s.useRef)([]);if(t){const e=()=>{let e=0;for(;e<999;){if(-1===c.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};t.id=e(),t.close=()=>{n&&o(e=>{const n=[...e],s=e.indexOf(t);return-1!==s&&n.splice(s,1),n}),r&&r(t),c.current.push(t.id)},n&&(t.nail=()=>{o(e=>[...e,t]),a&&a(t),c.current.push(t.id)}),d.push(t)}return d.map(e=>(0,l.jsx)(u,{...e},e.id))}},38030:(e,t,n)=>{n.d(t,{A:()=>c});n(65043);var s=n(26494),a=n(85865),r=n(2260),i=n(32143);const o="style_content__eXhNP",l="style_horizontal-margined__w4tJp";var d=n(70579);const c=e=>{let{label:t,options:n,selection:c,setter:u,disabled:h}=e;if(!n)return"Missing options argument";if(!c)return"Missing selection argument";if(!u)return"Missing setter argument";return(0,d.jsxs)(s.A,{className:o,children:[t&&(0,d.jsx)(a.A,{variant:"h5",children:t}),(0,d.jsx)(r.A,{value:c,onChange:e=>{u(e.target.value)},className:l,disabled:h,children:n.map((e,t)=>(0,d.jsx)(i.A,{value:e,children:e},t))})]})}},83283:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});const s={graph:"style_graph__Q1ja5",horizontal:"style_horizontal__makgF",wide25:"style_wide25__KqdCT",wide75:"style_wide75__p0NKz",enabled:"style_enabled__ndc27",disabled:"style_disabled__s5ohr","vertical-margin":"style_vertical-margin__5aQXR"}},92249:(e,t,n)=>{n.d(t,{A:()=>a});class s{constructor(e){void 0===e&&(e="0.0.0");const t=e.split(".");if(this.major=t[0]&&+t[0],this.major>999)throw new Error("Major version is greater than 999 and this is not allowed");if(this.minor=t[1]&&+t[1],this.minor>999)throw new Error("Minor version is greater than 999 and this is not allowed");if(this.patch=t[2]&&+t[2],this.patch>999)throw new Error("Patch version is greater than 999 and this is not allowed")}toString(){let e=this.major.toString();return void 0===this.minor?e:(e+="."+this.minor.toString(),void 0===this.patch||(e+="."+this.patch.toString()),e)}equals(e){return"string"===typeof e?this.equals(new s(e)):e.major===this.major&&((void 0===e.minor||e.minor===this.minor)&&(void 0===e.patch||e.patch===this.patch))}}s.prototype.valueOf=function(){return 1e6*this.major+1e3*(this.minor||0)+(this.patch||0)};const a=s}}]);
//# sourceMappingURL=126.32fc5bac.chunk.js.map