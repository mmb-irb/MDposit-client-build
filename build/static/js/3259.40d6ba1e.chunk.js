"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3259,7732,9117],{23621:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(65043),n=t(89257),l=t(85865),r=t(32577),o=t(10939),i=t(92428),d=t(10419),c=t(17545),u=t(58338),p=t(29449),h=t(95747),f=t(27732),m=t(82746),g=t(48838),x=t(75291),y=t(70579);const b={triggerOnce:!0,rootMargin:"100px"},A=["grey","yellow","red"],S={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},C=()=>{const[e,s]=(0,n.Wx)(b),{accessionAndMdNumber:t,metadata:C,topology:k,populations:v}=(0,a.useContext)(p.f),j=(0,d.A)(),_=(0,a.useRef)(null),R=(0,a.useRef)(null),{loading:$,payload:M,error:N}=(0,u.A)(`${h.nP}/${t}/analyses/sasa/`),[T,I]=(0,a.useState)([]),{components:w,representations:E,framesNumber:L,xAxisStep:P,xAxisLabel:D,isEnsemble:F,xTooltip:W,xWeights:H,data:B}=(0,a.useMemo)((()=>{if(!k||!C||!M||v&&v.loading)return{};const e=k.residueCount;if(e!==M.saspf.length)throw new Error(`Number of residues in the analysis (${M.saspf.length}) does not match number of residues in the topology (${e})`);const s={saspf:[],means:[],stdvs:[]};for(let t=0;t<e;t++){1===k.getResidueByIndex(t).atomCount?(s.saspf[t]=null,s.means[t]=null,s.stdvs[t]=null):(s.saspf[t]=M.saspf[t],s.means[t]=M.means[t],s.stdvs[t]=M.stdvs[t])}let a;for(let t=0;t<e;t++)if(s.saspf[t]){if(void 0!==a){a=null;break}a=t}null!==a&&I([{color:"black",index:a}]);const n=s.means,l=Math.max(...n),o=Math.min(...n),i=(0,r.m4Y)().range(A).domain([o,(o+l)/2,l]),d=m.ColormakerRegistry.addScheme((function(e){this.atomColor=e=>{const s=e.residueIndex;if(1===k.getResidueByIndex(s).atomCount)return 16777215;const t=n[s];if(null===t)return 16777215;const a=(0,r.yWT)(i(t)).formatHex();return parseInt(a.substring(1),16)}})),c=M.step,u=[{trajectoryURLs:[`${`${h.nP}/${t}/files/trajectory`}?frames=1:${C.mdFrames}:${c}`]}],p=[];j.forEach((e=>{const s={...e};s.color="custom",s.customScheme=d,s.type="spacefill",p.push(s)}));const f=s.saspf[0].length,g=C.timeLength,x="ensemble"===C.TYPE;let y,b,S,_;if(x||!g?(y=c,b="Frames",S=e=>"frame "+e):(y=g/(f-1),b="Time (ns)",S=e=>+e.toFixed(2)+" ns"),v&&v.payload){_=[];for(let e=0;e<v.payload.length;e+=y)_.push(v.payload[e])}return{components:u,representations:p,framesNumber:f,xAxisStep:y,xAxisLabel:b,isEnsemble:x,xTooltip:S,xWeights:_,data:s}}),[M,k,C,t,j,v,I]),{selectedData:Y,selectedResidueIndices:G}=(0,a.useMemo)((()=>{const e={},s=[];return T.forEach(((t,a)=>{const n={data:B.saspf[t.index]};n.color=t.color,e[a]=n,s.push(t.index)})),{selectedData:e,selectedResidueIndices:s}}),[B,T]),O=(0,a.useCallback)((e=>{_.current.togglePlaying(!1),_.current.currentFrame=e}),[]),U=(0,a.useCallback)((e=>{if(!R.current)return;const s=Math.round(e*(L-1));R.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]}),[L]),V=(0,a.useCallback)(((e,s,t)=>{const a={color:t,index:s};I((e=>[...e,a]))}),[I]),q=(0,a.useCallback)(((e,s)=>{I((e=>e.filter((e=>e.index!==s))))}),[I]),z=(0,a.useCallback)((()=>{I([])}),[I]),J=(0,a.useCallback)(((e,s)=>{const t=B.means[s],a=B.stdvs[s];return`Mean SAS: ${Math.round(100*t)/100}\nStandard deviation: ${Math.round(100*a)/100}`}),[B]);return $||v&&v.loading?(0,y.jsx)(c.A,{}):N?N.toString():v&&v.error?v.error.toString():M?v&&!v.payload?"Something bad happened with populations":k&&C?(0,y.jsxs)(a.Suspense,{fallback:(0,y.jsx)(c.A,{}),children:[k.residueCount>1&&(0,y.jsx)(o.A,{children:(0,y.jsx)(g.A,{residueValues:B.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:V,onDeselect:q,onClean:z,onTooltip:J})}),(0,y.jsx)(o.A,{className:f.default.graphcard,children:T.length>0?(0,y.jsx)(x.default,{yData:Y,step:P,xAxisLabel:D,yAxisLabel:"Relative SAS (\xc5\xb2)",type:F?"dots":"line",xWeights:H,xTooltip:W,onSelect:O,className:f.default.graph,ref:R}):(0,y.jsx)("div",{className:f.default["graph-placeholder"],children:(0,y.jsx)(l.A,{variant:"h6",children:"No residue selected"})})}),(0,y.jsx)(o.A,{className:f.default.nglcard,ref:e,children:s?(0,y.jsx)(i.default,{className:f.default.container,startingComponents:w,startingRepresentations:E,selectedResidueIndices:G,onProgress:U,ref:_,framesSelect:!1,highlightTypes:S}):(0,y.jsx)("div",{style:{height:"50vh"}})})]}):(0,y.jsx)(c.A,{}):"Something bad happened"}},27732:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});const a={graphcard:"style_graphcard__Cgh8H",graph:"style_graph__rikGP","graph-placeholder":"style_graph-placeholder__ef29F",nglcard:"style_nglcard__lD0br",container:"style_container__lvt9H"}}}]);
//# sourceMappingURL=3259.40d6ba1e.chunk.js.map