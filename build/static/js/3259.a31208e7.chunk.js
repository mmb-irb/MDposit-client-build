"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3259,7732,9117],{23621:(e,s,a)=>{a.r(s),a.d(s,{default:()=>v});var t=a(89379),n=a(65043),l=a(89257),r=a(85865),o=a(57631),c=a(10939),i=a(14696),d=a(17545),u=a(58338),p=a(29449),f=a(95747),h=a(27732),m=a(82746),g=a(48838),x=a(75291),y=a(70579);const b={triggerOnce:!0,rootMargin:"100px"},A=["grey","yellow","red"],S={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},v=()=>{const[e,s]=(0,l.Wx)(b),{accessionAndMdNumber:a,metadata:v,topology:j,populations:k}=(0,n.useContext)(p.f),C=j&&j.defaultRepresentations,_=(0,n.useRef)(null),R=(0,n.useRef)(null),{loading:M,payload:N,error:T}=(0,u.A)("".concat(f.nP,"/").concat(a,"/analyses/sasa/")),[I,w]=(0,n.useState)([]),{components:D,representations:E,framesNumber:L,xAxisStep:P,xAxisLabel:F,isEnsemble:W,xTooltip:H,xWeights:B,data:Y}=(0,n.useMemo)(()=>{if(!j||!v||!N||k&&k.loading)return{};const e=j.residueCount;if(e!==N.saspf.length)throw new Error("Number of residues in the analysis (".concat(N.saspf.length,") does not match number of residues in the topology (").concat(e,")"));const s={saspf:[],means:[],stdvs:[]};for(let a=0;a<e;a++){"ion"===j.getResidueByIndex(a).classification?(s.saspf[a]=null,s.means[a]=null,s.stdvs[a]=null):(s.saspf[a]=N.saspf[a],s.means[a]=N.means[a],s.stdvs[a]=N.stdvs[a])}let n;for(let a=0;a<e;a++)if(s.saspf[a]){if(void 0!==n){n=null;break}n=a}null!==n&&w([{color:"black",index:n}]);const l=s.means,r=Math.max(...l),c=Math.min(...l),i=(0,o.m4Y)().range(A).domain([c,(c+r)/2,r]),d=m.hD.addScheme(function(e){this.atomColor=e=>{const s=e.residueIndex;if("ion"===j.getResidueByIndex(s).classification)return 16777215;const a=l[s];if(null===a)return 16777215;const t=(0,o.yWT)(i(a)).formatHex();return parseInt(t.substring(1),16)}}),u=N.step,p="".concat(f.nP,"/").concat(a,"/files/trajectory"),h=[{trajectoryURLs:["".concat(p,"?frames=1:").concat(v.mdFrames,":").concat(u)]}],g=[];C.forEach(e=>{const s=(0,t.A)({},e);s.color="custom",s.customScheme=d,s.type="spacefill",g.push(s)});const x=s.saspf.find(e=>null!==e).length,y=v.timeLength,b="ensemble"===v.TYPE;let S,_,R,M;if(b||!y?(S=u,_="Frames",R=e=>"frame "+e):(S=y/(x-1),_="Time (ns)",R=e=>+e.toFixed(2)+" ns"),k&&k.payload){M=[];for(let e=0;e<k.payload.length;e+=S)M.push(k.payload[e])}return{components:h,representations:g,framesNumber:x,xAxisStep:S,xAxisLabel:_,isEnsemble:b,xTooltip:R,xWeights:M,data:s}},[N,j,v,a,C,k,w]),{selectedData:G,selectedResidueIndices:O}=(0,n.useMemo)(()=>{const e={},s=[];return I.forEach((a,t)=>{const n={data:Y.saspf[a.index]};n.color=a.color,e[t]=n,s.push(a.index)}),{selectedData:e,selectedResidueIndices:s}},[Y,I]),U=(0,n.useCallback)(e=>{_.current.togglePlaying(!1),_.current.currentFrame=e},[]),V=(0,n.useCallback)(e=>{if(!R.current)return;const s=Math.round(e*(L-1));R.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]},[L]),q=(0,n.useCallback)((e,s,a)=>{const t={color:a,index:s};w(e=>[...e,t])},[w]),z=(0,n.useCallback)((e,s)=>{w(e=>e.filter(e=>e.index!==s))},[w]),J=(0,n.useCallback)(()=>{w([])},[w]),K=(0,n.useCallback)((e,s)=>{const a=Y.means[s],t=Y.stdvs[s],n=Math.round(100*a)/100,l=Math.round(100*t)/100;return"Mean SAS: ".concat(n,"\nStandard deviation: ").concat(l)},[Y]);return M||k&&k.loading?(0,y.jsx)(d.A,{}):T?T.toString():k&&k.error?k.error.toString():N?k&&!k.payload?"Something bad happened with populations":j&&v?(0,y.jsxs)(n.Suspense,{fallback:(0,y.jsx)(d.A,{}),children:[j.residueCount>1&&(0,y.jsx)(c.A,{children:(0,y.jsx)(g.A,{residueValues:Y.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:q,onDeselect:z,onClean:J,onTooltip:K})}),(0,y.jsx)(c.A,{className:h.default.graphcard,children:I.length>0?(0,y.jsx)(x.default,{yData:G,step:P,xAxisLabel:F,yAxisLabel:"Relative SAS (\xc5\xb2)",type:W?"dots":"line",xWeights:B,xTooltip:H,onSelect:U,className:h.default.graph,ref:R}):(0,y.jsx)("div",{className:h.default["graph-placeholder"],children:(0,y.jsx)(r.A,{variant:"h6",children:"No residue selected"})})}),(0,y.jsx)(c.A,{className:h.default.nglcard,ref:e,children:s?(0,y.jsx)(i.default,{className:h.default.container,startingComponents:D,startingRepresentations:E,selectedResidueIndices:O,onProgress:V,ref:_,framesSelect:!1,highlightTypes:S}):(0,y.jsx)("div",{style:{height:"50vh"}})})]}):(0,y.jsx)(d.A,{}):"Something bad happened"}},27732:(e,s,a)=>{a.r(s),a.d(s,{default:()=>t});const t={graphcard:"style_graphcard__Cgh8H",graph:"style_graph__rikGP","graph-placeholder":"style_graph-placeholder__ef29F",nglcard:"style_nglcard__lD0br",container:"style_container__lvt9H"}}}]);
//# sourceMappingURL=3259.a31208e7.chunk.js.map