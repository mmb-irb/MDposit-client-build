"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3259,7732,9117],{23621:(e,s,a)=>{a.r(s),a.d(s,{default:()=>j});var t=a(89379),n=a(65043),l=a(89257),r=a(85865),o=a(57631),c=a(10939),i=a(14696),d=a(10419),u=a(17545),p=a(58338),h=a(29449),f=a(95747),m=a(27732),g=a(82746),x=a(48838),y=a(75291),b=a(70579);const A={triggerOnce:!0,rootMargin:"100px"},S=["grey","yellow","red"],v={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},j=()=>{const[e,s]=(0,l.Wx)(A),{accessionAndMdNumber:a,metadata:j,topology:k,populations:C}=(0,n.useContext)(h.f),_=(0,d.A)(),R=(0,n.useRef)(null),M=(0,n.useRef)(null),{loading:N,payload:T,error:I}=(0,p.A)("".concat(f.nP,"/").concat(a,"/analyses/sasa/")),[w,D]=(0,n.useState)([]),{components:E,representations:L,framesNumber:P,xAxisStep:F,xAxisLabel:W,isEnsemble:H,xTooltip:B,xWeights:Y,data:G}=(0,n.useMemo)(()=>{if(!k||!j||!T||C&&C.loading)return{};const e=k.residueCount;if(e!==T.saspf.length)throw new Error("Number of residues in the analysis (".concat(T.saspf.length,") does not match number of residues in the topology (").concat(e,")"));const s={saspf:[],means:[],stdvs:[]};for(let a=0;a<e;a++){"ion"===k.getResidueByIndex(a).classification?(s.saspf[a]=null,s.means[a]=null,s.stdvs[a]=null):(s.saspf[a]=T.saspf[a],s.means[a]=T.means[a],s.stdvs[a]=T.stdvs[a])}let n;for(let a=0;a<e;a++)if(s.saspf[a]){if(void 0!==n){n=null;break}n=a}null!==n&&D([{color:"black",index:n}]);const l=s.means,r=Math.max(...l),c=Math.min(...l),i=(0,o.m4Y)().range(S).domain([c,(c+r)/2,r]),d=g.hD.addScheme(function(e){this.atomColor=e=>{const s=e.residueIndex;if("ion"===k.getResidueByIndex(s).classification)return 16777215;const a=l[s];if(null===a)return 16777215;const t=(0,o.yWT)(i(a)).formatHex();return parseInt(t.substring(1),16)}}),u=T.step,p="".concat(f.nP,"/").concat(a,"/files/trajectory"),h=[{trajectoryURLs:["".concat(p,"?frames=1:").concat(j.mdFrames,":").concat(u)]}],m=[];_.forEach(e=>{const s=(0,t.A)({},e);s.color="custom",s.customScheme=d,s.type="spacefill",m.push(s)});const x=s.saspf.find(e=>null!==e).length,y=j.timeLength,b="ensemble"===j.TYPE;let A,v,R,M;if(b||!y?(A=u,v="Frames",R=e=>"frame "+e):(A=y/(x-1),v="Time (ns)",R=e=>+e.toFixed(2)+" ns"),C&&C.payload){M=[];for(let e=0;e<C.payload.length;e+=A)M.push(C.payload[e])}return{components:h,representations:m,framesNumber:x,xAxisStep:A,xAxisLabel:v,isEnsemble:b,xTooltip:R,xWeights:M,data:s}},[T,k,j,a,_,C,D]),{selectedData:O,selectedResidueIndices:U}=(0,n.useMemo)(()=>{const e={},s=[];return w.forEach((a,t)=>{const n={data:G.saspf[a.index]};n.color=a.color,e[t]=n,s.push(a.index)}),{selectedData:e,selectedResidueIndices:s}},[G,w]),V=(0,n.useCallback)(e=>{R.current.togglePlaying(!1),R.current.currentFrame=e},[]),q=(0,n.useCallback)(e=>{if(!M.current)return;const s=Math.round(e*(P-1));M.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]},[P]),z=(0,n.useCallback)((e,s,a)=>{const t={color:a,index:s};D(e=>[...e,t])},[D]),J=(0,n.useCallback)((e,s)=>{D(e=>e.filter(e=>e.index!==s))},[D]),K=(0,n.useCallback)(()=>{D([])},[D]),Q=(0,n.useCallback)((e,s)=>{const a=G.means[s],t=G.stdvs[s],n=Math.round(100*a)/100,l=Math.round(100*t)/100;return"Mean SAS: ".concat(n,"\nStandard deviation: ").concat(l)},[G]);return N||C&&C.loading?(0,b.jsx)(u.A,{}):I?I.toString():C&&C.error?C.error.toString():T?C&&!C.payload?"Something bad happened with populations":k&&j?(0,b.jsxs)(n.Suspense,{fallback:(0,b.jsx)(u.A,{}),children:[k.residueCount>1&&(0,b.jsx)(c.A,{children:(0,b.jsx)(x.A,{residueValues:G.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:z,onDeselect:J,onClean:K,onTooltip:Q})}),(0,b.jsx)(c.A,{className:m.default.graphcard,children:w.length>0?(0,b.jsx)(y.default,{yData:O,step:F,xAxisLabel:W,yAxisLabel:"Relative SAS (\xc5\xb2)",type:H?"dots":"line",xWeights:Y,xTooltip:B,onSelect:V,className:m.default.graph,ref:M}):(0,b.jsx)("div",{className:m.default["graph-placeholder"],children:(0,b.jsx)(r.A,{variant:"h6",children:"No residue selected"})})}),(0,b.jsx)(c.A,{className:m.default.nglcard,ref:e,children:s?(0,b.jsx)(i.default,{className:m.default.container,startingComponents:E,startingRepresentations:L,selectedResidueIndices:U,onProgress:q,ref:R,framesSelect:!1,highlightTypes:v}):(0,b.jsx)("div",{style:{height:"50vh"}})})]}):(0,b.jsx)(u.A,{}):"Something bad happened"}},27732:(e,s,a)=>{a.r(s),a.d(s,{default:()=>t});const t={graphcard:"style_graphcard__Cgh8H",graph:"style_graph__rikGP","graph-placeholder":"style_graph-placeholder__ef29F",nglcard:"style_nglcard__lD0br",container:"style_container__lvt9H"}}}]);
//# sourceMappingURL=3259.f5916f36.chunk.js.map