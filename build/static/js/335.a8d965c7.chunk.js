(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[335],{13232:(e,t,r)=>{"use strict";r.d(t,{L:()=>n});const n=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=e.getBoundingClientRect(),s=t.getBoundingClientRect();let a=r.x;if(Math.abs(o.left-a)>Math.abs(a-o.right)){a-=n+(s.right-s.left)}else a+=n;a-=o.left;let i=r.y;if(Math.abs(o.top-i)>Math.abs(i-o.bottom)){i-=n+(s.bottom-s.top)}else i+=n;return i-=o.top,{x:a,y:i}}},14696:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>bt});var n=r(65043),o=r(64600),s=r.n(o),a=r(54109),i=r.n(a),l=r(12110),c=r(17392),u=r(68903),d=r(44208),m=r(99070),f=r(26494),p=r(10611),h=r(92127),g=r(44642),y=r(12639),j=r(71806),x=r(84882),b=r(28076),v=r(10039),w=r(73460),E=r(67784),A=r(2260),_=r(43845),R=r(61533);const S="style_popover-slider__Rg-SB",C="style_info__itwxP";var L=r(70579);const k=[{label:"Cartoon",value:"cartoon"},{label:"Licorice",value:"licorice"},{label:"Ball and stick",value:"ball+stick"},{label:"Surface",value:"surface"},{label:"Spacefill",value:"spacefill"},{label:"Tube",value:"tube"},{label:"Trace",value:"trace"},{label:"Backbone",value:"backbone"},{label:"Nucleic bases",value:"base"}],F=e=>{for(const t of k)if(t.value===e)return!0;return!1},N=[{label:"By chain id",value:"chainid"},{label:"By residue",value:"resname"},{label:"By element",value:"element"},{label:"B factor",value:"bfactor"},{label:"Electrostatic",value:"electrostatic"},{label:"Secondary structure",value:"sstruc"},{label:"Uniform",value:"uniform"}],T=["red","yellow","blue","green","orange","purple","white","grey","black"],P=(0,n.memo)(e=>{let{components:t,representations:r,setRepresentations:n}=e;return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(j.A,{"aria-label":"simple table",size:"small",padding:"checkbox",stickyHeader:!0,children:[(0,L.jsx)(x.A,{children:(0,L.jsxs)(b.A,{children:[(0,L.jsx)(v.A,{children:"Name"}),(0,L.jsx)(v.A,{align:"right",children:"Show"}),(0,L.jsxs)(v.A,{style:{whiteSpace:"nowrap"},align:"right",children:["Selection ",(0,L.jsx)(R.A,{tooltip:(0,L.jsxs)(L.Fragment,{children:["Using"," ",(0,L.jsx)("a",{href:"https://nglviewer.org/ngl/api/manual/selection-language.html",target:"_blank",rel:"noopener noreferrer",children:"NGL selection language"}),"."]}),className:C})]}),(0,L.jsx)(v.A,{align:"right",children:"Drawing method"}),(0,L.jsx)(v.A,{align:"right",children:"Coloring method"}),(0,L.jsx)(v.A,{align:"right",children:"Opacity"})]})}),(0,L.jsx)(w.A,{children:r&&r.map((e,t)=>(0,L.jsxs)(b.A,{children:[(0,L.jsx)(v.A,{component:"th",scope:"row",children:e.name}),(0,L.jsx)(v.A,{align:"right",children:(0,L.jsx)(c.A,{title:"Show/Hide representation",onClick:()=>n(e=>(e[t].show=!e[t].show,[...e])),color:"primary",children:(0,L.jsx)(h.g,{icon:e.show?y.pS3:y.k6j})})}),(0,L.jsx)(v.A,{align:"right",children:(0,L.jsx)(E.A,{defaultValue:e.selection,variant:"outlined",onKeyPress:e=>{"Enter"===e.key&&n(r=>e.target&&e.target.value?(r[t].selection=e.target.value,[...r]):r)},disabled:!e.custom,size:"small",margin:"dense"})}),(0,L.jsx)(v.A,{align:"right",children:(0,L.jsxs)(A.A,{native:!0,value:e.type,onChange:e=>{let{target:{value:r}}=e;n(e=>(e[t].type=r,[...e]))},children:[!F(e.type)&&(0,L.jsx)("option",{value:e.type,children:e.type}),k.map((e,t)=>(0,L.jsx)("option",{value:e.value,children:e.label},t))]})}),(0,L.jsx)(v.A,{align:"right",children:(0,L.jsxs)(A.A,{native:!0,value:e.color,onChange:e=>{let{target:{value:r}}=e;n(e=>(e[t].color=r,[...e]))},children:["distorsion"===e.customScheme?(0,L.jsx)("option",{value:e.color,children:"Distorsion"}):e.customScheme?(0,L.jsx)("option",{value:"custom",children:"Custom"}):null,N.map((e,t)=>(0,L.jsx)("option",{value:e.value,children:e.label},t)),T.map((e,t)=>{return(0,L.jsx)("option",{value:e,children:(r=e,r[0].toUpperCase()+r.slice(1))},t);var r})]})}),(0,L.jsx)(v.A,{align:"right",children:(0,L.jsx)(m.Ay,{value:100*e.opacity,onChange:(e,r)=>{n(e=>(e[t].opacity=r/100,[...e]))},className:S})})]},e.reference||t))}),(0,L.jsx)(w.A,{children:(0,L.jsx)(b.A,{children:(0,L.jsx)(v.A,{align:"center",colSpan:6,children:(0,L.jsx)(_.A,{icon:(0,L.jsx)(h.g,{icon:y.OQW}),label:"Add representation",variant:"outlined",onClick:()=>n(e=>[...e,{name:"Custom",show:!0,selection:"None",type:"licorice",color:"chainid",opacity:1,component:t[0]&&t[0].name,custom:!0}])})})},"addCustom")})]})})});var M=r(39766);const z="mdposit-",B=(e,t)=>{const r=localStorage.getItem(z+e);return null===r?t:JSON.parse(r)},I=async(e,t)=>(await(0,M._)(1e3),((e,t)=>{localStorage.setItem(z+e,JSON.stringify(t))})(e,t));var $=r(95747),D=r(89257),O=r(50691),U=r(52153),G=r(35682),q=r(39517),H=r(43573),W=r(26939),V=r(65001),K=r(29325),X=r(78219),J=r(23541),Q=r(54776);const Y=V.xE.builderFactory("custom-namespace")({name:"trajectory-from-custom-data",display:"Trajectory",from:K.O.Root,to:K.O.Molecule.Coordinates,params:{data:J.t.Value(new Uint8Array,{isHidden:!0}),natoms:J.t.Value(0,{isHidden:!0})}})({apply(e){let{params:t}=e;return X.YZ.create("Parse atom coordinates",async e=>await async function(e,t){if(0===t)throw new Error("Number of atoms is 0");const r=12*t;if(e.byteLength%r!==0)throw new Error("Trajectory data ends abruptly");const n=e.byteLength/r,o=new Float32Array(e),s=[];let a=0;for(let l=0;l<n;l++){const e=new Float32Array(t),r=new Float32Array(t),n=new Float32Array(t);for(let s=0;s<t;s++)e[s]=o[a],r[s]=o[a+1],n[s]=o[a+2],a+=3;s.push({x:e,y:r,z:n,elementCount:t,time:(0,Q.gX)(l,"step"),xyzOrdering:{isIdentity:!0}})}const i=Q.E$.create(s,(0,Q.gX)(1,"step"),(0,Q.gX)(0,"step"));return new K.O.Molecule.Coordinates(i,{label:"label"})}(t.data,t.natoms))}});var Z=r(29449);const ee="style_container__d6R8E",te="style_light-theme__l3EaT",re="style_loading-trajectory__ciokb",ne="style_loading-structure__ce+kY",oe="style_tooltip__KXFgY",se=(0,U.w)();se.layout={initial:{isExpanded:!1,controlsDisplay:"reactive",showControls:!1}},se.components={controls:{top:"none",bottom:"none",left:"none",remoteState:"none"}};const ae={atoms:"spacefill",residues:"ball+stick",chains:"ball+stick",selections:"ball+stick"},ie=(0,n.memo)((0,n.forwardRef)((e,t)=>{let{className:r,playing:o,spinning:a,smooth:i,onProgress:l,bounce:c=!1,selectedAtoms:u,selectedResidueIndices:d,selectedChains:m,selectedCustom:f,selectedDistances:p,selectedAngles:h,selectedRepresentation:g,snapRepresentations:y,noTrajectory:j,initialFocus:x,darkBackground:b,perspective:v,speed:w,drawingMethods:E,coloringMethods:A,opacities:_,components:R,showRepresentations:S,nglSelections:C,topologies:k,trajectories:F,anyLoadingTopology:N,anyLoadingTrajectory:T,highlightTypes:P=ae}=e;const z=(0,n.useMemo)(()=>R,[R]),{metadata:B,topology:I}=(0,n.useContext)(Z.f),[$,U]=(0,n.useState)(x);(0,n.useEffect)(()=>{U(x)},[x]);const V=(0,n.useRef)(null),K=(0,n.useRef)(null),X=(0,n.useRef)(null),J=(0,n.useRef)(null),[Q,ie]=(0,D.Wx)(),[le,ce]=(0,n.useState)(null),[ue,de]=(0,n.useState)(null);(0,n.useEffect)(()=>((async()=>{const e=await(0,O.y)(V.current,se);de(e)})(),()=>{ue&&(ue.dispose(),ue=null)}),[]);const[me,fe]=(0,n.useState)(null);(0,n.useEffect)(()=>{N||ue&&k.forEach(async e=>{const t=await ue.builders.data.rawData({data:e.file},{state:{isGhost:!0}}),r=await ue.builders.structure.parseTrajectory(t,"pdb"),n=await ue.builders.structure.createModel(r);fe(n.ref)})},[ue,N,k]),(0,n.useEffect)(()=>{if(!ue)return;if(j)return;(async()=>{if(!k||!F||0===F.length)return;if(!me)return;const e=F[0];let t,r=0;if(t=e.atoms,t!==e.atoms)throw new Error("Atoms number in the different trajectories do not match");r+=e.frames;const n=e.payload,o=12*t,s=Math.floor(n.byteLength/o)*o,a=n.slice(0,s);if(0===a.byteLength)return;const i=a.byteLength/o;if(!(i===r))return;const l=await ue.build().toRoot().apply(Y,{data:a,natoms:e.atoms}).commit(),c=ue.managers.structure.hierarchy.current.trajectories,u=await ue.build().toRoot().apply(G.TrajectoryFromModelAndCoordinates,{modelRef:me,coordinatesRef:l.ref},{dependsOn:[me,l.ref]}).commit(),d=await ue.builders.structure.createModel(u),m=await ue.builders.structure.createStructure(d),f=ue.build().to(m),p=(0,H.pQ)(ue,void 0,{type:"cartoon",typeParams:{quality:"lower",ignoreHydrogens:"all",ignoreHydrogensVariant:"all",ignoreLight:!0}});f.apply(W.f.Representation.StructureRepresentation3D,p),await f.commit(),c.length})()},[ue,me,k,F,z,j]),(0,n.useEffect)(()=>{ue&&(j||(o&&ie?ue.managers.animation.play(q.d,{duration:{name:"sequential",params:{maxFps:10}},mode:{name:"loop",params:{direction:"forward"}}}):ue.managers.animation.stop()))},[ue,o,ie,j,c]);const pe=(0,n.useCallback)(async()=>{if(!X.current)return;const e=K.current.querySelector("canvas");e&&(e.style.height="",e.style.cursor="default"),await(0,M.yy)(0),X.current.handleResize()},[]);(0,n.useEffect)(()=>(window.addEventListener("resize",pe),()=>{window.removeEventListener("resize",pe)}),[pe]),(0,n.useImperativeHandle)(t,()=>({autoResize:pe,displayFocus(){const e=`[${X.current.viewerControls.getOrientation().elements.toString()}]`;console.log(e)},centerFocus(){U({comp:0,sele:"all"})},get currentFrame(){if(!ue||!F.length)return-1;try{return X.current.compList[0].trajList[0].trajectory.currentFrame}catch(e){return-1}},set currentFrame(e){if(ue&&F.length)try{const t=this.totalFrames;let r=e;r<0&&(r=0),r>=t&&(r=t-1),X.current.compList[0].trajList[0].trajectory.setFrame(r)}catch(t){}},get totalFrames(){if(!ue||!F.length)return 1;try{return X.current.compList[0].trajList[0].trajectory.frames.length}catch(e){return 1}},get totalExpectedFrames(){try{return X.current.compList[0].trajList[0].expectedFrames}catch(e){return 1}}}),[ue,F,pe]);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{ref:e=>{Q(e),V.current=e},className:s()(r,ee,{[ne]:N,[re]:!j&&T,[te]:!b}),"data-loading":void 0}),(0,L.jsx)("div",{ref:J,className:oe,children:le})]})})),le=ie;var ce=r(45180),ue=r(82746);const de=(e,t,r)=>{const n=new Float32Array(e);try{const e=[];for(let o=0;o<r;o++){const r=new Float32Array(3*t);r.set(n.subarray(o*t*3,(o+1)*t*3)),e.push(r)}return e}catch(o){return null}},me=(e,t,r,n,o)=>{const s=new Float32Array(r),a=s.length/3/o;if(a!==n)throw console.log("Number of coordinates: "+s.length),console.log("Number of frames: "+o),console.log("Expected number of atoms: "+a),console.log("Actual number of atoms: "+n),new Error("Trajectory atom number is wrong");try{const r=[];for(let a=0;a<o;a++){const o=new Float32Array(3*e);let i=0;for(let r=0;r<e;r++)-1!==t.indexOf(r)&&(o[3*r]=s[a*n*3+3*i],o[3*r+1]=s[a*n*3+3*i+1],o[3*r+2]=s[a*n*3+3*i+2],i++);r.push(o)}return r}catch(i){return null}},fe=(e,t,r,n)=>{const o=new Float32Array(t);if(o.length/3/n!==r)throw new Error("Trajectory atom number is wrong");let s="",a=0,i=0;for(let c=0;c<e.atomCount&&!(0>=r);c++)"C"!==e.getAtomProxy(c).atomname&&"CA"!==e.getAtomProxy(c).atomname&&"N"!==e.getAtomProxy(c).atomname||(a+=1),"H"!==e.getAtomProxy(c).element&&(i+=1);r===a?s="backbone":r===i?s="heavy":console.error(`Number of atoms does not match any defined atoms selection\n      Number of atoms in trajectory: ${r}\n      Expected backbone atoms: ${a}\n      Expected heavy atoms: ${i}`);try{const t=[];for(let a=0;a<n;a++){const n=new Float32Array(3*e.atomCount);let i=0;if("backbone"===s)for(let t=0;t<e.atomCount&&!(i>=r);t++)"C"!==e.getAtomProxy(t).atomname&&"CA"!==e.getAtomProxy(t).atomname&&"N"!==e.getAtomProxy(t).atomname||(n[3*t]=o[a*r*3+3*i],n[3*t+1]=o[a*r*3+3*i+1],n[3*t+2]=o[a*r*3+3*i+2],i++);if("heavy"===s)for(let t=0;t<e.atomCount&&!(i>=r);t++)"H"!==e.getAtomProxy(t).element&&(n[3*t]=o[a*r*3+3*i],n[3*t+1]=o[a*r*3+3*i+1],n[3*t+2]=o[a*r*3+3*i+2],i++);t.push(n)}return t}catch(l){return null}};var pe=r(13232),he=r(71261);const ge="style_container__7Ceta",ye="style_light-theme__H4DPh",je="style_loading-trajectory__2DP4d",xe="style_loading-structure__E1dyl",be="style_tooltip__eJTpx";var ve=r(93010);const we=750,Ee="polymer and not hydrogen ",Ae=e=>1e3+-9.5*(e-0),_e={atoms:"spacefill",residues:"ball+stick",chains:"ball+stick",selections:"ball+stick"},Re=(0,n.memo)((0,n.forwardRef)((e,t)=>{let{className:r,playing:o,spinning:a,smooth:i,onProgress:l,bounce:c=!1,selectedAtoms:u,selectedResidueIndices:d,selectedChains:m,selectedCustom:f,selectedDistances:p,selectedAngles:h,selectedRepresentation:g,snapRepresentations:y,noTrajectory:j,initialFocus:x,darkBackground:b,perspective:v,speed:w,xSelection:E,rotateX:A,xAxisStep:_,components:R,representations:S,topologies:C,trajectories:k,anyLoadingTopology:F,anyLoadingTrajectory:N,highlightTypes:T=_e}=e;const{metadata:P,topology:z}=(0,n.useContext)(Z.f),B=(0,n.useMemo)(()=>{if(!P)return;const e=P.ORIENTATION;if(!e)return;const t=[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]];return(new ue.kn).set(...t)},[P]),[I,$]=(0,n.useState)(null),[O,U]=(0,n.useState)(null),[G,q]=(0,n.useState)(x);(0,n.useEffect)(()=>{q(x)},[x]);const H=(0,n.useRef)(null),W=(0,n.useRef)(null),V=(0,n.useRef)(null),K=(0,n.useRef)(!0),[X,J]=(0,D.Wx)(),[Q,Y]=(0,n.useState)(null),[ee,te]=(0,n.useState)([]),re=(0,n.useRef)(new Set);(0,n.useEffect)(()=>{C.forEach(e=>{if(!e.file)return;if(e.url in re.current)return;re.current.add(e.url);const t=new Blob([e.file],{type:"text/plain"});(0,ue.un)(t,{defaultRepresentation:!1,ext:"pdb"}).then(t=>{const r={...e};r.file=t,te(e=>[...e,r])}).catch(e=>{console.error(e)})}),te(e=>[...e])},[C]);const[ne,oe]=(0,n.useState)(0),se=(0,n.useCallback)(e=>{oe(t=>t+e)},[oe]);(0,n.useEffect)(()=>{const e=new ue.BI(H.current);return(0,M.Gt)().then(()=>{e&&e.handleResize()}),e.tasks.signals.countChanged.add(se),W.current=e,()=>{W.current.dispose(),W.current=null}},[]);const ae=(0,n.useMemo)(()=>z?I?k.length||j?ne>0?"Rendering...":void 0:"No trajectory available":"Waiting for the main component":"Waiting for the main topology",[I,k,j,ne]);(0,n.useEffect)(()=>{const e=Date.now();let t=1e3;return K.current&&(t=0,K.current=!1),(async()=>{for(;;){if(await(0,M.Gt)(),!W.current)return;let r=Date.now()-e;if(r>t)break;b&&(r=t-r);const n=`#${Math.round(255*r/t).toString("16").padStart(2,"0").repeat(3)}`;W.current.viewer.setBackground(n)}await(0,M.Gt)(),W.current&&W.current.viewer.setBackground(b?"black":"white")})(),()=>t=0},[b]),(0,n.useEffect)(()=>{W.current&&W.current.viewer&&W.current.viewer.setCamera&&W.current.viewer.setCamera(v?"perspective":"orthographic")},[v]),(0,n.useEffect)(()=>{if(!l||j||!O)return;const e=O.expectedFrames,t=t=>{const r=(0,ce.A)(t/(e-1),0,1);l(r)};return O.signals.frameChanged.add(t),()=>{O.signals.frameChanged.remove(t)}},[O,j,l]);const ie=(0,n.useCallback)(async()=>{if(!W.current)return;const e=H.current.querySelector("canvas");e&&(e.style.height="",e.style.cursor="default"),await(0,M.yy)(0),W.current.handleResize()},[]);(0,n.useEffect)(()=>(window.addEventListener("resize",ie),()=>{window.removeEventListener("resize",ie)}),[ie]),(0,n.useEffect)(()=>{R&&S&&z&&R.forEach((e,t)=>{let r=W.current.compList.find(t=>t.myName==e.name);if(!r){const t=e.topologyURL||null,n=ee.find(e=>e.url===t);if(!n)return;if(n.error)throw new Error(`Topology from '${t}' returned error ${n.error}`);if(!n.file)throw new Error(`Topology data from '${t}' is missing`);n.file.atomStore.occupancy=new Array(n.file.atomStore.occupancy.length).fill(1);const o=z.atomBonds;if(o){const e=n.file.bondStore;e.length=0,e.count=0,e.atomIndex1=new Int32Array,e.atomIndex2=new Int32Array,e.bondOrder=new Int32Array,o.forEach((t,r)=>{const o=n.file.getAtomProxy(r);t.forEach(t=>{const r=n.file.getAtomProxy(t);e.addBond(o,r,1)})})}const s=(0,ve.A)(n.file);if(r=W.current.addComponentFromObject(s),r.myName=e.name,!r)return;r.onlyTopology=e.onlyTopology,$(r)}const n=S.filter(t=>t.component===e.name),o=[];n.forEach((e,n)=>{const s=n+"-"+e.name;o.push(s);const a=e.show,i=e.selection,l=e.type,c=e.color,u=a?e.opacity:0,d=e.customScheme,m=e.name===g?ue.hD.addSelectionScheme([["yellow","all"]],"custom label"):d&&"custom"===c?d:(e=>{var t=(new Option).style;return t.color=e,t.color===e})(c)?ue.hD.addSelectionScheme([[c,"all"]],"custom label"):c,f={sele:i,name:s,opacity:u,colorScheme:m,colorDomain:"surface"===l?[-200,200]:void 0,surfaceType:"surface"===l?"av":void 0,side:"front",depthWrite:!("surface"===l&&u<1),...e.other},p=r.reprList.find(e=>e.name===s);if(p){const e=p.repr.type,t=p.repr.selection.string;e!==l||t!==i||"trace"===e?(r.removeRepresentation(p),r.addRepresentation(l,f)):p.setParameters(f)}else r.addRepresentation(l,f);if(e.label){const t=e.label+"-"+s,o=r.annotationList.find(e=>e.name===t);if(a)if(o)o.element.label=e.label;else{var h=document.createElement("div");h.innerText=e.label,h.style.color="#76FF03",h.style.backgroundColor="#607D8B",h.style.padding="8px";const o=r.reprList[n].repr.structureView.center;r.addAnnotation(o,h).name=t}else o&&r.removeAnnotation(o)}e.name===g&&q({comp:t,sele:e.selection})});[...r.reprList].forEach(e=>{const t=e.name;if("*"!==t.charAt(0)){for(const e of o)if(t===e)return;r.removeRepresentation(e)}}),q(e=>e||{comp:0,sele:"all"})})},[R,S,ee,g,$,z]),(0,n.useEffect)(()=>{if(!z)return;if(!I||!u)return;const e="*highlightedAtoms",t=I.reprList.find(t=>t.name===e);t&&I.removeRepresentation(t);const r="*highlightedAtomResidues",n=I.reprList.find(e=>e.name===r);n&&I.removeRepresentation(n);const o=Array.from(u);if(!o.length)return;const s=`@${o.map(e=>e).join(",")}`;I.addRepresentation(T.atoms,{sele:s,opacity:.5,scale:1.5,name:e});const a=Array.from(new Set(o.map(e=>"@"+z.getAtomByIndex(e).residue.atomIndices.join(",")))).join(" or ");I.addRepresentation(T.residues,{sele:a,name:r}),q({comp:0,sele:a})},[I,z,u,b,T]),(0,n.useEffect)(()=>{if(!z||!I||!d)return;const e="*highlightedResidues",t=I.reprList.find(t=>t.name===e);if(t&&I.removeRepresentation(t),0===d.length)return;const r=d.map(e=>z.getResidueByIndex(e).nglSelection),n=Array.from(new Set(r)).join(" or ");I.addRepresentation(T.residues,{sele:n,name:e}),q({comp:0,sele:n})},[I,d,z,T]),(0,n.useEffect)(()=>{if(!I||!m)return;const e="*highlightedChains",t=I.reprList.find(t=>t.name===e);t&&I.removeRepresentation(t);const r=m.map(e=>":"+e);if(!r.length)return;const n=Array.from(new Set(r)).join(" or ");I.addRepresentation(T.chains,{sele:n,name:e}),q({comp:0,sele:n})},[I,m,T]),(0,n.useEffect)(()=>{if(!I||!y)return;const e=I.reprList;return y.forEach(e=>{I.addRepresentation(e.type,{sele:e.selection,name:e.name,color:e.color,opacity:e.opacity})}),()=>{y.forEach(t=>{const r=e.find(e=>e.name===t.name);r&&I.removeRepresentation(r)})}},[I,y]),(0,n.useEffect)(()=>{if(!I||!f)return;const e="*highlightedCustom",t=I.reprList.find(t=>t.name===e);if(t&&I.removeRepresentation(t),!f.length)return;const r=Array.from(new Set(f)).join(" or ");I.addRepresentation(T.selections,{sele:r,name:e}),q({comp:0,sele:r})},[I,f,T]),(0,n.useEffect)(()=>{if(!I||!p)return;const e="*distance",t=I.reprList.find(t=>t.name===e);t&&I.removeRepresentation(t),I.addRepresentation("distance",{atomPair:p,color:"skyblue",labelUnit:"angstrom",name:e,labelColor:b?16777215:1})},[I,p,b]),(0,n.useEffect)(()=>{if(!I||!E)return;const e="*density",t=W.current.compList.find(t=>t.name===e);t?W.current.removeComponent(t):W.current.viewer.rotationGroup.rotateY(-1.6);var r=new ue.yp("shape",{radialSegments:10});const n=I.object.center,o=I.object.boundingBox;r.addBox([n.x,n.y,E*_-_/2],[0,0,0],o.max.x-o.min.x,[0,o.max.y-o.min.y,0],[0,0,.01]),r.addBox([n.x,n.y,E*_+_/2],[0,0,0],o.max.x-o.min.x,[0,o.max.y-o.min.y,0],[0,0,-.01]);W.current.addComponentFromObject(r,{name:e}).addRepresentation("buffer",{opacity:.1,roughness:1})},[I,E]),(0,n.useEffect)(()=>{I&&A&&W.current.viewer.rotationGroup.rotateX(-1.57)},[I,A]),(0,n.useEffect)(()=>{if(!I||!h)return;const e="*angles",t=I.reprList.find(t=>t.name===e);t&&I.removeRepresentation(t),I.addRepresentation("angle",{atomTriple:h,name:e,labelColor:b?16777215:1})},[I,h,b]),(0,n.useEffect)(()=>{0!==ee.length&&0!==k.length&&R&&R.forEach((e,t)=>{const r=e.topologyURL||null,n=ee.find(e=>e.url===r);if(!n)return;const s=W.current.compList.find(t=>t.myName==e.name);if(!s)return;if(e.onlyTopology)return;const a=[];let i,l="",c="",u=0;for(const o of e.framedURLs){const e=k.find(e=>e.url===o);if(!e)return;if(i||(i=e.atoms),i!==e.atoms)throw new Error("Atoms number in the different trajectories do not match");u+=e.frames;const t=e.payload,r=12*i,n=Math.floor(t.byteLength/r)*r,s=t.slice(0,n);a.push(s),l+=o,c+="/"+e.progress}const d=s.combinedURL===l;if(d||s.trajList.forEach(s.removeTrajectory.bind(s)),d&&s.combinedProgress===c)return;let m;if(s.combinedURL=l,s.combinedProgress=c,0===a.length)return;if(m=1===a.length?a[0]:a.reduce((e,t)=>(0,he.nK)(e,t)),0===m.byteLength)return;const f=12*i,p=m.byteLength/f,h=p-1,g=p===u,y=e.atomIndices;if(y&&y.length!==i)throw new Error("Unexpected number of trajectory atoms");const x=s.trajList;if(x.length>0){if(x.length>1)throw new Error("Multiple trajectories in one component");const e=x[0],r=e.trajectory;if(((e,t,r,n,o,s)=>{if(!(e&&t&&r))return;const a=e.frames.length;if(a>=o)return;const i=a*n*12,l=r.slice(i),c=o-a;let u;if(u=n===t.atomCount?de(l,n,c):s?me(t.atomCount,s,l,n,c):fe(t,l,n,c),!u)throw new Error("Topology and trajectory data may not match");e.frames=e.frames.concat(u)})(r,n.file,m,i,p,y),r._frameCount=p,0===t){e.expectedFrames=u;const t=r.player,n=Ae(w);if(t.setParameters({end:h,interpolateStep:100/u,mode:g?"loop":"once",timeout:n}),!j&&o&&!t.isRunning){r._currentFrame<h&&t.play()}}}else{const e=((e,t,r,n,o)=>{if(!e||!t)return;let s;if(s=r===e.atomCount?de(t,r,n):o?me(e.atomCount,o,t,r,n):fe(e,t,r,n),!s)throw new Error("Topology and trajectory data may not match");const a=new ue.Hc("Dynamically generated trajectory","");return a.coordinates=s,a})(n.file,m,i,p,y);if(!e)return;const r=s.addTrajectory(e),o=r.trajectory;if(0===t){r.expectedFrames=u;const e=Ae(w);o.player.setParameters({interpolateStep:100/u,mode:g?"loop":"once",timeout:e}),U(r)}o.setFrame(0)}})},[ee,k,R,j,U,o,w]),(0,n.useEffect)(()=>{if(!O)return;const e=O.trajectory,t=()=>{const t=e._currentFrame;e.setFrame(t)};return e.player.signals.haltedRunning.add(t),()=>{e.player.signals.haltedRunning.remove(t)}},[O]),(0,n.useEffect)(()=>{if(!O)return;const{player:e}=O.trajectory;return e.setParameters({interpolateStep:100/O.trajectory.frameCount,direction:c?"bounce":"forward"}),j?e.pause():e[o&&J?"play":"pause"](),()=>e.pause()},[O,o,J,j,c]),(0,n.useEffect)(()=>{if(!I)return;const e=I.trajList[0];if(!e)return;const t=Ae(w);e.trajectory.player.setParameters({timeout:t})},[I,w]),(0,n.useEffect)(()=>{W.current&&W.current.spinAnimation&&a===W.current.spinAnimation.paused&&W.current.toggleSpin()},[a]),(0,n.useEffect)(()=>{O&&(O.trajectory.player.parameters.interpolateType=i?"linear":"")},[O,i]),(0,n.useEffect)(()=>{if(I&&k.length)return ie(),ie.cancel},[I,k,ie]),(0,n.useEffect)(()=>{if(!I||!z)return;const e=e=>{let{detail:t}=e;if(!t||"click"!==t.eventtype&&"reset"!==t.eventtype)return;let r="";for(const s of document.querySelectorAll("protvista-manager")){const e=s.attributeValues.get("highlight"),t=s.attributes.chain.value;if(!e)continue;const[n,o]=e.split(":"),a=z.getResidueByParameters(t,+n),i=z.getResidueByParameters(t,+o);if(a.chainName!==i.chainName)throw new Error("Range from multiple chains is not supported");r+=` or :${a.chainName} and ${a.number}-${i.number}`}r=r.substr(4);const n=I&&I.reprList.find(e=>"structure"===e.name);if(n&&I.removeRepresentation(n),!r)return I.addRepresentation("cartoon",{sele:Ee,name:"structure",opacity:1}),void(B&&W.current.animationControls.orient(B,we));const o=ue.hD.addSelectionScheme([["yellow",r],["white","*"]],"custom label");I.addRepresentation("cartoon",{sele:Ee,name:"structure",opacity:1,color:o}),I.autoView(r,we)};return window.addEventListener("change",e),()=>window.removeEventListener("change",e)},[I,z,B]),(0,n.useEffect)(()=>{if(!z)return;const e=V.current;H.current.appendChild(e),W.current.mouseControls.remove("hoverPick");const t=e=>{const t=z.getResidueByIndex(e.residueIndex),r=t.chain.metadataChainName,n=t.referenceId;return(0,L.jsxs)(L.Fragment,{children:[`Atom ${e.index} (${e.atomname})\n                Chain ${t.chainName} ${r?"("+r+")":""}\n                Residue ${t.number} (${e.resname})`,(()=>{if(n)return"noref"===n?(0,L.jsx)("div",{style:{color:"orange"},children:"No referable"}):"notfound"===n?(0,L.jsx)("div",{style:{color:"salmon"},children:"Reference not found"}):null===t.referenceData?(0,L.jsx)("div",{style:{color:"red"},children:`Missing data for ${n}`}):(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{style:{color:"lightGreen"},children:t.referenceName}),"protein"===t.referenceType&&(0,L.jsx)("div",{children:`- Residue ${t.referenceNumber}`})]})})()]})};let r;const n=()=>{clearTimeout(r),e.style.display="none"};return W.current.signals.hovered.add(function(o){o?(n(),r=setTimeout(()=>{let r;const n=o.bond,s=o.atom;if(n){const e=n.atom1,o=n.atom2;r=(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{children:`Bond ${e.index} - ${o.index}`}),(0,L.jsx)("hr",{style:{color:"lightGrey"}}),t(e),(0,L.jsx)("hr",{style:{color:"lightGrey"}}),t(o)]})}else s&&(r=t(s));Y(r),e.style.display="block";const{x:a,y:i}=(0,pe.L)(H.current,e,o.mouse.position,3);e.style.top=i+"px",e.style.left=a+"px"},400)):n()}),H.current.addEventListener("mouseleave",n,!1),()=>{e.remove(),H.current.removeEventListener("mouseleave",n)}},[z,Y]);const le=(0,n.useRef)(!0);(0,n.useEffect)(()=>{if(!G)return;const e=G.comp?W.current.compList.find(e=>e.myName===G.comp):I;if(!e)return;let t=we;le.current&&(t=0,B&&W.current.animationControls.orient(B,0),le.current=!1),e.autoView(G.sele,t)},[I,G,B]),(0,n.useImperativeHandle)(t,()=>({autoResize:ie,displayFocus(){const e=`[${W.current.viewerControls.getOrientation().elements.toString()}]`;console.log(e)},centerFocus(){q({comp:0,sele:"all"}),B&&W.current.animationControls.orient(B,we)},get currentFrame(){if(!I||!k.length)return-1;try{return I.trajList[0].trajectory.currentFrame}catch(e){return-1}},set currentFrame(e){if(I&&k.length)try{const t=this.totalFrames;let r=e;r<0&&(r=0),r>=t&&(r=t-1),I.trajList[0].trajectory.setFrame(r)}catch(t){}},get totalFrames(){if(!I||!k.length)return 1;try{return I.trajList[0].trajectory.frames.length}catch(e){return 1}},get totalExpectedFrames(){try{return I.trajList[0].expectedFrames}catch(e){return 1}}}),[I,k,ie]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)("div",{ref:e=>{e&&(X(e),H.current=e)},className:s()(r,ge,{[xe]:!I,[je]:!j&&N,[ye]:!b}),"data-loading":ae,children:(0,L.jsx)("div",{ref:V,className:be,children:Q})})})}));Re.displayName="NGLViewer";const Se=Re;var Ce=r(92954),Le=r(42594),ke=r.n(Le),Fe=r(22363),Ne=r.n(Fe),Te=r(74080);const Pe=/\?frames=(?<start>\d+):(?<end>\d+)(:(?<step>\d+))?/,Me=(e,t,r)=>{const{accessionAndMdNumber:o,fileDescriptors:s,structureData:a}=(0,n.useContext)(Z.f),[i,l]=(0,n.useState)([]),[c,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&l(t=>{const r=[];return e.forEach(e=>{const n=e.topologyURL||null,o=e.atomSelection||null,s=e.atomIndices||null;[...t,...r].find(e=>e.url===n)||(null===n?r.push({url:null,loading:!1,error:null}):(r.push({url:n,selection:o,atomindices:s,loading:!0,requested:!1,error:null}),u(!0)))}),[...t,...r]})},[e,l]);const[d,m]=(0,n.useState)([]),f=(0,n.useRef)([]);(0,n.useEffect)(()=>{i.forEach(e=>{if(e.file)return;if(e.error)return;if(e.requested)return;const t=e.url;if(null===t)m(e=>[...e,{url:null,file:a}]);else{e.requested=!0;const r=JSON.stringify({selection:e.selection,atomindices:e.atomindices}),n="https"===t.substring(0,5)?ke():Ne(),o=(0,Te.parse)(t),s=o.path.endsWith("/structure");o.method=s?"POST":"GET",o.headers={"Content-Type":"application/json","Content-Length":r.length};const a=n.request(o,r=>{let n="";r.on("data",e=>{n+=e}).on("end",()=>{m(e=>[...e,{url:t,file:n}]),e.loading=!1;const r=i.some(e=>e.loading);u(r)})});"POST"===o.method&&a.write(r),a.end(),f.current.push(a)}})},[i,a]);const[p,h]=(0,n.useState)([]),[g,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!e)return;const{loading:r,payload:n,error:a}=s;if(!r){if(a)throw a;if(!n)throw new Error("Something bad happened with file descriptors");h(r=>{const s=[],a=`${$.nP}/${o}/files/trajectory`;return e.forEach((e,o)=>{if(e.onlyTopology)return;const i=0===o,l=e.frame;let c=e.trajectoryURLs||[a];e.frameCount=0,c.forEach((o,a)=>{const c=(e=>{const t=Pe.exec(e);if(!t)return null;const r=+t.groups.start,n=Math.max(+t.groups.end,r),o=+(t.groups.step||1);return{start:r,end:n,step:o,frames:Math.floor((n-r)/o)+1}})(o);let u=o.split("/").slice(-1)[0];c&&(u=u.split("?frames=")[0]),"trajectory"===u&&(u="trajectory.bin");const d=n.find(e=>e.filename===u);if(!d)throw new Error(`Trajectory "${u}" is missing`);const m=d.metadata,f=m.frames;let p=t;if(t>f&&(p=f),Number.isFinite(l)?p=1:c&&(p=c.frames),!i&&p>1)throw new Error("Only the main component is allowed to load multiple frames");let h,g=o;if(c){const e=Math.min(f,c.end);h=Math.ceil(e/c.step)}else{const{range:e,frames:t}=((e,t,r)=>{if(r)return{range:(r+1).toString(),frames:1};if(!e)throw new Error("Missing number of frames in the trajectory");if(!t)throw new Error("Missing number of requested frames");const n=Math.floor(e/t);return{range:`1:${e}:${n}`,frames:Math.ceil(e/n)}})(f,p,l);h=t,e&&(g=o+`?frames=${e}`)}e.framedURLs||(e.framedURLs=[]),e.framedURLs[a]=g,e.frameCount+=p;r.find(e=>e.url===g)||(s.push({url:g,frames:h,atoms:m.atoms,loading:!0,requested:!1}),y(!0))})}),s.length>0?[...r,...s]:r})}},[o,e,s,t]);const[j,x]=(0,n.useState)([]);return(0,n.useEffect)(()=>{p.forEach(e=>{if(e&&e.requested)return;e.requested=!0,e.loading=!0,e.progress=0;const t=JSON.stringify({}),r="https"===e.url.substring(0,5)?ke():Ne(),n=(0,Te.parse)(e.url),o=n.pathname.split("/"),s="trajectory"===o[o.length-1];n.method=s?"POST":"GET",n.headers={"Content-Type":"application/json","Content-Length":t.length};const a=r.request(n,t=>{const r=t.headers["content-length"];x(t=>[...t,{url:e.url,frames:e.frames,atoms:e.atoms,payload:new ArrayBuffer(0),progress:0}]);let n=0;t.on("data",t=>{n+=t.byteLength,e.progress=n/r,x(r=>{const n=r.find(t=>t.url===e.url);return n.payload=(0,he.nK)(n.payload,t),n.progress=e.progress,[...r]})}).on("end",()=>{e.loading=!1;const t=p.some(e=>e.loading);y(t)})});"POST"===n.method&&a.write(t),a.end(),f.current.push(a)})},[p]),(0,n.useEffect)(()=>{const e=f.current;return()=>{e.forEach(e=>{e.abort()})}},[]),(0,n.useEffect)(()=>{if(!e)return;const t=e[0]&&e[0].framedURLs;if(!t)return;const n=[];if(t.forEach(e=>{const t=j.find(t=>t.url===e);t&&n.push(t)}),0===n.length)return;const o=n.map(e=>e.frames).reduce((e,t)=>e+t,0),s=n.map(e=>e.progress*e.frames).reduce((e,t)=>e+t,0)/o;r(s)},[e,j,r]),{topologies:d,trajectories:j,anyLoadingTopology:c,anyLoadingTrajectory:g}},ze=Symbol("low"),Be=Symbol("medium"),Ie=Symbol("high"),$e=()=>{if(!navigator||!navigator.connection)return Be;const{effectiveType:e,saveData:t}=navigator.connection;if(!0===t)return ze;if(!e)return Be;switch(e){case"slow-2g":case"2g":return ze;case"3g":return Be;default:return Ie}};var De=r(17604);const Oe="style_background-toggle__aAj32",Ue="style_dark__e5mDQ",Ge="style_adapter__+rjEA",qe="style_ngl-with-settings__k93CW",He="style_ngl-without-settings__qTooi",We="style_settings-left__Wvi5a",Ve="style_settings-controls__kLLNo",Ke="style_ngl-alone__5TmnB",Xe="style_stacked-icons__OoF+a",Je="style_extra-top-margin__vaEmm",Qe="style_settings-right__NDIcU",Ye="style_hidden__D+3lX",Ze="style_fullscreen-toggle__f4Bk2",et="style_is-fullscreen__RtQvN",tt="style_settings__87jIw",rt="style_fullscreen-target__VO3Yh",nt="style_progress__LNzos",ot="style_controls__0ugFi",st="style_flip-container__dGHQ+",at="style_flip-card-container__wgyMe",it="style_flipped__DhDpU",lt="style_flip-card__g+agx",ct="style_front__g9FOf",ut="style_back__UfiiZ",dt="style_progressContainer__kQ85K",mt="style_timeInfo__wEsXY",ft=!(0,De.A)()&&window.innerWidth>750,pt=(()=>{switch($e()){case Ie:return 50;case Be:return 25;default:return 10}})(),ht=[{value:1,label:"1"},{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"}],gt={name:"Unnamed component",topologyURL:"auto",trajectoryURLs:"auto",atomSelection:null,atomIndices:null,frame:null,onlyTopology:!1},yt={name:"Unnamed representation",selection:"all",show:!0,type:"cartoon",color:"chainid",opacity:1,component:"auto"},jt=(e,t)=>{let r=!1;for(const[n,o]of Object.entries(t))void 0===e[n]&&(e[n]=o,r=!0);return r},xt=(0,n.forwardRef)((e,t)=>{let{startingComponents:r,startingRepresentations:o,componentsState:a,representationsState:j,className:x,startsPlaying:b=ft,close:v,nail:w,requestedFrame:E,framesSelect:A=!0,preventTrajectory:_=!1,onProgress:R,...S}=e;if(r&&a)throw new Error("startingComponents and componentsState are not compatilbe inputs. Choose one.");if(o&&j)throw new Error("startingRepresentations and representationsState are not compatilbe inputs. Choose one.");const[C,k]=(0,n.useState)(Se),{metadata:F,accessionAndMdNumber:N,topology:T}=(0,n.useContext)(Z.f),[M,z]=(0,n.useState)({frame:0,time:0}),D=(0,n.useMemo)(()=>{const e=F.mdFrames,t=[...ht];for(let r=t.length-1;r>=0&&t[r].value>e;r--)t.pop();return t.length===ht.length||t[t.length-1].value!==e&&t.push({value:e,label:e.toString()}),t},[F.mdFrames]),O=(0,n.useMemo)(()=>r?r.map(e=>(0,he.JH)(e)):null,[r]),[U,G]=a||(0,n.useState)(O),q=(0,n.useCallback)(e=>{if(!N)return!1;const t={...gt};return t.topologyURL=`${$.nP}/${N}/files/structure`,t.trajectoryURLs=[`${$.nP}/${N}/files/trajectory`],jt(e,t)},[N]);(0,n.useEffect)(()=>{if(!q)return;if(!U){const e=[{name:"Main"}];return e.forEach(e=>{q(e)}),G(e)}const e=U.map(e=>e.name),t=new Set(e);if(e.length!==t.size)throw new Error(`We have multiple components with the same name: ${e.join(", ")}`);U.map(e=>q(e,gt)).some(e=>!0===e)&&G([...U])},[U,q]),(0,n.useEffect)(()=>{U&&void 0!==E&&U[0].frame!==E&&(U[0].frame=E,G([...U]))},[U,E]);const H=(0,n.useMemo)(()=>o?o.map(e=>(0,he.JH)(e)):null,[o]),[W,V]=j||(0,n.useState)(H),K=T&&T.defaultRepresentations,X=(0,n.useCallback)(e=>{if(!U)return!1;const t={...yt};return t.component=U[0].name,jt(e,t)},[U]);(0,n.useEffect)(()=>{if(!K||0===K.length)return;if(!W){if(j)return;const e=[...K];return e.forEach(e=>X(e)),V(e)}W.map(e=>X(e)).some(e=>!0===e)&&V([...W])},[W,K,X]);const J=(0,n.useRef)(null),Q=(0,n.useRef)(null),[Y,ee]=(0,Ce.A)(!1),[te,re]=(0,Ce.A)(b),[ne,oe]=(0,Ce.A)(!1),[se,ae]=(0,n.useState)(!0),[ie,ce]=(0,Ce.A)((0,n.useMemo)(()=>B("dark-background",!1),[])),[ue,de]=(0,Ce.A)((0,n.useMemo)(()=>B("perspective",!1),[])),[me,fe]=(0,n.useState)(0),[pe,ge]=(0,n.useState)(0),[ye,je]=(0,n.useState)(i().isFullscreen),[xe,be]=(0,n.useState)(Math.min(pt,F.mdFrames)),[ve,we]=(0,n.useState)((0,n.useMemo)(()=>B("speed",50),[])),[Ee,Ae]=(0,n.useState)(!1),_e=(0,n.useCallback)(e=>{if(R&&R(e),fe(e),Q.current){const t=Q.current.currentFrame,r=F.FRAMESTEP?(F.timeLength*e).toFixed(2):0;z({frame:t,time:r})}},[fe,R,F.FRAMESTEP]);(0,n.useEffect)(()=>{const e=window.history.pushState,t=window.history.replaceState;return window.history.pushState=function(){e.apply(this,arguments),te&&re(!1)},window.history.replaceState=function(){t.apply(this,arguments),te&&re(!1)},()=>{window.history.pushState=e,window.history.replaceState=t}},[te,re]);const Re=(0,n.useCallback)(e=>{ge(e)},[ge]),Le=(0,n.useCallback)(e=>{let{buttons:t,clientX:r,currentTarget:n,type:o}=e;if(!Q.current)return;if("mousemove"===o&&1!==t)return;const{x:s,width:a}=n.getBoundingClientRect();re(!1),Q.current.currentFrame=Math.floor((r-s)/a*Q.current.totalExpectedFrames)},[re]),ke=(0,n.useCallback)(e=>{Q.current&&(re(!1),Q.current.currentFrame+=e)},[re]),Fe=(0,n.useCallback)(()=>ke(-1),[ke]),Ne=(0,n.useCallback)(()=>ke(1),[ke]),Te=(0,n.useCallback)(()=>je(i().isFullscreen),[]);(0,n.useEffect)(()=>(i().on("change",Te),()=>i().off("change",Te)),[Te]);const Pe=(0,n.useCallback)(()=>{J.current&&i().toggle(J.current)},[]);(0,n.useEffect)(()=>{const e=e=>{"Escape"===e.key&&(Ae(!1),Q.current.autoResize())," "===e.key&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&(e.preventDefault(),re(e=>!e))};return document.addEventListener("keydown",e,!1),()=>document.removeEventListener("keydown",e,!1)},[]);const ze=(0,n.useMemo)(()=>{if(!T||!T.pbcResidues)return;if(!U)return;if(!1===T.pbcResidues.size>0)return!1;if(U.every(e=>e.atomIndices)){if(!1===U.reduce((e,t)=>e.concat(t.atomIndices),[]).some(e=>{const t=T.getAtomByIndex(e);return T.pbcResidues.has(t.residueIndex)}))return!1}return ae(!1),!0},[T,U]);(0,n.useImperativeHandle)(t,()=>({autoResize:Q.current.autoResize,centerFocus:Q.current.centerFocus,get currentFrame(){return Q.current.currentFrame},set currentFrame(e){Q.current.currentFrame=e},togglePlaying:re,setFinalComponents:G,setFinalRepresentations:V}),[re,G,V]);const Be=U&&U[0],Ie=_||Be&&(Be.onlyTopology||Number.isFinite(Be.frame)),{topologies:$e,trajectories:De,anyLoadingTopology:xt,anyLoadingTrajectory:bt}=Me(U,xe,Re);return(0,L.jsx)(l.A,{className:s()(rt,{[et]:ye}),ref:J,children:(0,L.jsxs)("div",{className:s()(Ge,x),children:[(0,L.jsxs)(l.A,{className:Ee?qe:He,style:{border:"none",boxShadow:"none"},id:"preventDragSize",children:[(0,L.jsxs)(l.A,{className:Ee?s()(We,x):s()(Ke,x),style:{border:"none",boxShadow:"none"},children:[(0,L.jsx)(C,{playing:te,spinning:ne,smooth:se,onProgress:_e,ref:Q,noTrajectory:Ie,darkBackground:ie,perspective:ue,speed:ve,components:U,representations:W,topologies:$e,trajectories:De,anyLoadingTopology:xt,anyLoadingTrajectory:bt,...S}),Ee&&(0,L.jsxs)("div",{className:Ve,children:[(0,L.jsxs)("div",{className:Xe,children:[(0,L.jsx)(c.A,{title:"Toggle spin",onClick:oe,size:"large",children:(0,L.jsx)(h.g,{icon:y.OtC})}),(0,L.jsx)(c.A,{title:"Center focus",onClick:e=>{if(!Q.current)return;e.shiftKey||e.ctrlKey||e.metaKey?Q.current.displayFocus():Q.current.centerFocus()},size:"large",children:(0,L.jsx)(h.g,{icon:g.RV})}),Ie||(0,L.jsx)("div",{className:Xe,title:ze&&"Smooth interpolation is not allowed since there are residues under Periodic Boundary Conditions. The smoothing may result in misleading artifacts for those atoms jumping across boundaries.",children:(0,L.jsx)(c.A,{title:"Toggle smooth interpolation "+(se?"off":"on"),onClick:()=>ae(e=>!e),disabled:ze,size:"large",children:(0,L.jsx)(h.g,{icon:se?g.yv:y.n2W})})}),(0,L.jsx)(c.A,{title:"Invert background color",onClick:()=>{ce(),I("dark-background",!ie)},size:"large",children:(0,L.jsx)("div",{className:s()(Oe,{[Ue]:ie}),children:(0,L.jsx)(h.g,{icon:y.Rpi})})}),(0,L.jsx)(c.A,{title:`Switch to ${ue?"ortographic":"perspective"} view`,onClick:()=>{de(),I("perspective",!ue)},size:"large",children:(0,L.jsx)(h.g,{icon:ue?g.Nf:y.br3})}),(0,L.jsx)(c.A,{title:"Switch viwer to "+(C===Se?"MolStar":"NGL"),onClick:()=>{k(e=>{if(e===Se)return le;if(e===le)return Se;throw new Error("Unrecognized current viewer")})},size:"large",children:(0,L.jsx)(h.g,{icon:C===Se?y.RPy:y.QOt})})]}),Ie||(0,L.jsxs)("div",{children:["Speed:",(0,L.jsxs)(u.Ay,{container:!0,spacing:2,className:Je,children:[(0,L.jsx)(u.Ay,{item:!0,children:(0,L.jsx)(d.A,{children:(0,L.jsx)(h.g,{icon:y.zsV})})}),(0,L.jsx)(u.Ay,{item:!0,xs:!0,children:(0,L.jsx)(m.Ay,{title:"Change player speed",value:ve,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{we(t),I("speed",t)}})}),(0,L.jsx)(u.Ay,{item:!0,children:(0,L.jsx)(d.A,{children:(0,L.jsx)(h.g,{icon:y.Cz6})})})]})]}),Ie||(0,L.jsxs)("div",{children:["Frames:",A?(0,L.jsx)(m.Ay,{title:"Select frame number",value:xe,onChange:(e,t)=>be(t),"aria-labelledby":"discrete-slider-restrict",step:null,valueLabelDisplay:"auto",marks:D,max:D[D.length-1].value}):" "+Q.current.totalExpectedFrames]})]})]}),Ee&&(0,L.jsx)("div",{className:Qe,children:(0,L.jsx)(P,{components:U,representations:W,setRepresentations:V})})]}),(0,L.jsxs)(f.A,{style:{padding:0},children:[Ie?(0,L.jsx)("div",{}):(0,L.jsxs)("div",{className:dt,children:[(0,L.jsx)("div",{className:s()(nt,{[Ue]:ie}),onClick:Le,onMouseMove:Le,children:(0,L.jsx)(p.A,{variant:"buffer",color:"primary",value:100*me,valueBuffer:100*pe,style:{height:"1ch"},className:"prevent-drag"})}),F.FRAMESTEP&&(0,L.jsxs)("div",{className:s()(mt,{[Ue]:ie}),children:["Time: ",M.time," / ",(0,he.wC)(F.timeLength)," ns"]})]}),(0,L.jsxs)("div",{className:ot,children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(c.A,{title:"Close viewer",className:s()({[Ye]:!v}),disabled:!v,onClick:v,size:"large",children:(0,L.jsx)(h.g,{icon:y.GRI})}),(0,L.jsx)(c.A,{title:Y?"Nailed viewer":"Nail viewer",className:s()({[Ye]:!w}),disabled:!w||Y,onClick:()=>{w(),ee()},size:"large",children:(0,L.jsx)("div",{className:st,children:(0,L.jsxs)("div",{className:s()(at,{[it]:Y}),children:[(0,L.jsx)(h.g,{className:s()(lt,ct),icon:y.KKb}),(0,L.jsx)(h.g,{className:s()(lt,ut),icon:y.DW4})]})})})]}),(0,L.jsx)("div",{children:Ie||(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(c.A,{title:"Previous frame",onClick:Fe,size:"large",children:(0,L.jsx)(h.g,{icon:y.L4I})}),(0,L.jsx)(c.A,{title:te?"Pause":"Play",onClick:re,size:"large",children:(0,L.jsx)("div",{className:st,children:(0,L.jsxs)("div",{className:s()(at,{[it]:te}),children:[(0,L.jsx)(h.g,{className:s()(lt,ct),icon:y.ijD}),(0,L.jsx)(h.g,{className:s()(lt,ut),icon:y.G1Y})]})})}),(0,L.jsx)(c.A,{title:"Next frame",onClick:Ne,size:"large",children:(0,L.jsx)(h.g,{icon:y.BxI})})]})}),(0,L.jsxs)("div",{children:[(0,L.jsx)(c.A,{title:(ye?"Exit":"Go")+" fullscreen",onClick:Pe,className:s()(Ze,{[Ye]:!i().isEnabled,[et]:ye,[tt]:Ee}),disabled:!i().isEnabled,size:"large",children:(0,L.jsx)(h.g,{icon:ye?y.gr3:y.oZK})}),(0,L.jsx)(c.A,{title:"Settings",onClick:()=>{Ae(e=>!e),Q.current.autoResize()},size:"large",children:(0,L.jsx)(h.g,{icon:y.dB})})]})]})]})]})})});xt.displayName="ViewerWithControls";const bt=xt},15340:()=>{},42634:()=>{},79838:()=>{}}]);
//# sourceMappingURL=335.a8d965c7.chunk.js.map