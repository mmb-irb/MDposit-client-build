"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[2527,3753],{507:(e,n,t)=>{t.d(n,{A:()=>y});var a=t(65043),r=t(2260),s=t(32143),i=t(57972),l=t(83558),o=t(14256),c=t(67784),d=t(17392),u=t(92127),m=t(12639),f=t(17545);const h="style_horizontal__2DIWx",p="style_horizontal-margined__e9fQR";var g=t(70579);const x=[{label:"All residues",value:"residue_indices"},{label:"Interface residues",value:"interface_indices"}],y=e=>{let{interactions:n,selectedInteraction:t,setSelectedInteraction:y,selectedResidues:b,setSelectedResidues:_,selectedOrder:A,handleToggleOrder:$,firstOrderLabel:S,firstOrderTooltip:v,secondOrderLabel:w,secondOrderTooltip:j,toggleOrderTooltip:N,interfaceOnly:C=!1}=e;const I=n[t];return(0,g.jsxs)(a.Suspense,{fallback:(0,g.jsx)(f.A,{}),children:[(0,g.jsx)(r.A,{value:t,onChange:e=>{y(e.target.value)},className:p,children:n.map(((e,n)=>(0,g.jsx)(s.A,{value:n,disabled:e.failed,children:e.label||e.name},n)))}),b&&(0,g.jsx)(i.A,{value:b,onChange:e=>{_(e.target.value)},className:h,children:x.map(((e,n)=>(0,g.jsx)(l.A,{value:e.value,control:(0,g.jsx)(o.A,{color:"primary"}),label:e.label,disabled:"All residues"===e.label&&C},n)))}),void 0!==A&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.A,{label:S,title:v,value:A?I.agent_1:I.agent_2}),(0,g.jsx)(d.A,{title:N,onClick:()=>{$()},size:"large",children:(0,g.jsx)(u.g,{icon:m._qq})}),(0,g.jsx)(c.A,{label:w,title:j,value:A?I.agent_2:I.agent_1})]})]})}},10419:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(65043),r=t(29449),s=t(71261);const i=()=>{const{topology:e}=(0,a.useContext)(r.f);return(0,a.useMemo)((()=>{if(!e)return[];const n=[];return e.iterchains().forEach((t=>{const a=t.metadataChainName,r=a?`${a} (Chain ${t.name})`:`Chain ${t.name}`,i=t.residues,l=t=>{const a=i.filter((e=>e.classification===t));if(0===a.length)return;const l=a.filter((e=>e.isCg));if(l.length>0){const a=l.map((e=>e.index)),{rangedSelection:s}=e.residueIndices2Ngl(a);n.push({name:`${r} - ${t} polymer (coarse grain)`,selection:s,type:"spacefill",color:"chainid"})}const o=a.filter((e=>!e.isCg)).map((e=>e.index)),c=[...(0,s.Y$)(o)],d=c.filter((e=>e.length<=3));if(d.length>0){const a=d.reduce(((e,n)=>e.concat(n)),[]),{rangedSelection:s}=e.residueIndices2Ngl(a);n.push({name:`${r} - ${t} polymer (short)`,selection:s,type:"licorice",color:"chainid"})}const u=c.filter((e=>e.length>3));if(u.length>0){const a=u.reduce(((e,n)=>e.concat(n)),[]),{rangedSelection:s}=e.residueIndices2Ngl(a);n.push({name:`${r} - ${t} polymer`,selection:s,type:"cartoon",color:"chainid"});new Set(["dna","rna","nucleic"]).has(t)&&n.push({name:`${r} - ${t} bases`,selection:s,type:"base",color:"resname"})}};l("protein"),l("dna"),l("rna"),l("nucleic");const o=i.filter((e=>"ligand"===e.classification));if(o.length>0){const t=new Set(o.map((e=>e.referenceId)));for(const a of t){const t=o.filter((e=>e.referenceId===a)).map((e=>e.index)),{rangedSelection:s}=e.residueIndices2Ngl(t);n.push({name:`${r} - ligand ${a}`,selection:s,type:"ball+stick",color:"element"})}}const c=new Set(["fatty","steroid"]),d=i.filter((e=>c.has(e.classification)));if(d.length>0){const t=d.map((e=>e.index)),{rangedSelection:a}=e.residueIndices2Ngl(t);n.push({name:`${r} - lipids`,selection:a,type:"licorice",color:"grey",opacity:.5})}const u=i.filter((e=>"ion"===e.classification));if(u.length>0){const t=u.map((e=>e.index)),{rangedSelection:a}=e.residueIndices2Ngl(t);n.push({name:`${r} - ions`,selection:a,type:"spacefill",color:"element"})}const m=new Set(["solvent","unknown"]),f=i.filter((e=>m.has(e.classification)));if(f.length>0){const t=f.map((e=>e.index)),{rangedSelection:a}=e.residueIndices2Ngl(t);n.push({name:`${r} - other`,selection:a,type:"licorice",color:"purple",opacity:.3})}})),n}),[e])}},13826:(e,n,t)=>{t.r(n),t.d(n,{default:()=>A});var a=t(65043),r=t(26494),s=t(85865),i=t(43845),l=t(58338),o=t(10939),c=t(17545),d=t(34088),u=t(10419),m=t(29449),f=t(95747),h=t(52527),p=t(507),g=t(24310),x=t(70579);const y=["First frame","Second frame"],b=["First frame interface","Second frame interface"],_={base:["red","blue"],interface:[["orange","yellow"],["purple","green"]]},A=()=>{const{accessionAndMdNumber:e,metadata:n,interactions:t,topology:A}=(0,a.useContext)(m.f),$=(0,a.useRef)(null),S=(0,u.A)(),[v,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(0),C=`${f.nP}/${e}/analyses/rmsd-pairwise/`,{loading:I,payload:R,error:O}=(0,l.A)(C),z=(0,a.useMemo)((()=>{if(!t)return[{name:"Overall"}];t.forEach((e=>{e.label=e.name+" (interface residues)"}));return[{name:"Overall"},...t]}),[t]),{rmsds:E,AxesValues:k}=(0,a.useMemo)((()=>{if(!R)return{};const e=z[j],t=R.data.find((n=>n.name===e.name));if(!t)throw new Error(`Dataset for interaction "${e.name}" not found`);const a=t.rmsds,r=a.length,s=Math.floor(n.mdFrames/(r-1));return{rmsds:a,AxesValues:Array(r).fill(void 0).map(((e,n)=>n*s))}}),[R,n,z,j]),[M,F]=(0,a.useState)(null);(0,a.useMemo)((()=>{if(!v)return F(null);F((e=>null===e?v.map(((e,n)=>({name:"Frame "+(0===n?"A":"B"),frame:e}))):(v.forEach(((n,t)=>{const a=e[t];a.name="Frame "+(0===t?"A":"B"),a.frame=n})),[...e])))}),[v]);const[T,V]=(0,a.useState)(null);return(0,a.useMemo)((()=>{if(!M)return V(null);const e=z[j],n=[{name:e.agent_1,interface:e.interface_indices_1},{name:e.agent_2,interface:e.interface_indices_2}];V((e=>{const t=[],a=j>0,r=!(!e||!e.find((e=>e.reference&&e.reference.includes(b[0]))));return null===e?M.forEach(((e,n)=>{S.forEach((r=>{const s={...r};s.name=`${e.name} - ${r.name}`,s.color=_.base[n],s.component=e.name,s.reference=`${y[n]} - ${r.name}`,a&&(s.name+=" reference",s.opacity=.1),t.push(s)}))})):M.forEach(((n,s)=>{S.forEach((i=>{const l=`${y[s]} - ${i.name}`,o=e.find((e=>e.reference===l));if(!o)throw new Error(`No previous representation with reference ${l}`);const c=o.name.split(" - ")[0];o.name=o.name.replace(c,n.name),o.component=n.name,a&&!r&&(o.name+=" reference",o.opacity=.1),!a&&r&&(o.name=o.name.replace(" reference",""),o.opacity=1),t.push(o)}))})),a&&(!1===r?M.forEach(((e,a)=>{n.forEach(((n,r)=>{const s=n.interface&&A.residueIndices2Ngl(n.interface);t.push({name:`${e.name} - ${n.name} interface`,color:_.interface[a][r],selection:s.rangedSelection,type:"licorice",component:e.name,reference:`${b[a]} - ${n.name}`})}))})):M.forEach(((a,r)=>{n.forEach((n=>{const s=n.interface&&A.residueIndices2Ngl(n.interface),i=`${b[r]} - ${n.name}`,l=e.find((e=>e.reference===i));l.name=`${a.name} - ${n.name} interface`,l.selection=s.rangedSelection,l.component=a.name,t.push(l)}))}))),e&&e.filter((e=>e.custom)).forEach((e=>{e.component=M[0].name,t.push(e)})),t}))}),[M,A,z,j,S]),I?(0,x.jsx)(c.A,{}):O?O.toString():R?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.A,{children:(0,x.jsxs)(r.A,{className:h.default.horizontal,children:[(0,x.jsx)(s.A,{variant:"h6",children:"Residues selection:"}),(0,x.jsx)(p.A,{interactions:z,selectedInteraction:j,setSelectedInteraction:N}),v&&(0,x.jsxs)("div",{children:[M&&M.map(((e,n)=>(0,x.jsx)(i.A,{label:"Frame "+e.frame,style:{margin:"0.2em",backgroundColor:0===n?"red":"blue"}},n))),j>0&&M&&M.map(((e,n)=>{const t=z[j];return[t.agent_1,t.agent_2].map(((t,a)=>(0,x.jsx)(i.A,{label:"Frame "+e.frame+" - "+t,style:{margin:"0.2em",backgroundColor:0===a?0===n?"orange":"purple":0===n?"yellow":"green"}},a)))}))]})]})}),(0,x.jsx)(o.A,{className:h.default.margined,id:"heatmap",children:(0,x.jsx)(r.A,{children:(0,x.jsx)(g.A,{inputData:{data:E,xLabels:k,yLabels:k},onTooltip:e=>{let{value:n,xAxisValue:t,yAxisValue:a}=e;return`${t} - ${a}\n${Math.round(100*n)/100} \xc5`},onClick:e=>{let{xAxisValue:n,yAxisValue:t}=e;return w([n,t])},legendTitle:"RMSD (\xc5)",maxColor:"red",minColor:"blue",xTitle:"Frames",yTitle:"Frames"})})}),(0,x.jsx)(d.A,{newViewer:M?{componentsState:[M,F],representationsState:[T,V],selRef:v,viewerRef:$}:null,onNail:e=>w((n=>e.selRef===n?null:n)),onClose:e=>w((n=>e.selRef===n?null:n))})]}):"Something bad happened"}},34088:(e,n,t)=>{t.d(n,{A:()=>m});var a=t(65043),r=t(43126),s=t(10939);const i="style_rnd__Txifm",l="style_floating-card__HHpby";var o=t(70579);const c=(0,a.lazy)((()=>Promise.all([t.e(7784),t.e(8095),t.e(3845),t.e(9070),t.e(247),t.e(7955),t.e(8677),t.e(3471),t.e(335),t.e(9117)]).then(t.bind(t,14696))));let d=0;const u=e=>{const n=e.viewerRef||(0,a.useRef)(null),[t,u]=(0,a.useState)((()=>{const{innerWidth:e,innerHeight:n,scrollY:t}=window,a=document.querySelector("main").offsetTop,r=Math.max(Math.min(e/4,n/4),150),s=1.5*r;return{width:2*r,height:s,x:0,y:n-a-s-20+t}}));return(0,o.jsx)(r.p,{position:{x:t.x,y:t.y},size:{width:t.width,height:t.height},style:{zIndex:(d+=1,d)},className:i,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{u({...t})},onResizeStart:()=>{u({...t})},onDragStop:(e,n)=>{0===e.layerX&&0===e.layerY||t.x===n.x&&t.y===n.y||u({...t,x:n.x,y:n.y})},onResize:()=>n.current&&n.current.autoResize(),onResizeStop:(e,n,t,a,r)=>{u({width:t.style.width,height:t.style.height,...r})},children:(0,o.jsx)(s.A,{className:l,elevation:4,children:(0,o.jsx)(a.Suspense,{fallback:null,children:(0,o.jsx)(c,{className:l,ref:n,startsPlaying:!1,...e})})})})},m=e=>{let{newViewer:n,nailing:t=!0,onNail:r,onClose:s}=e;const[i,l]=(0,a.useState)([]),c=[...i],d=(0,a.useRef)([]);if(n){const e=()=>{let e=0;for(;e<999;){if(-1===d.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};n.id=e(),n.close=()=>{t&&l((e=>{const t=[...e],a=e.indexOf(n);return-1!==a&&t.splice(a,1),t})),s&&s(n),d.current.push(n.id)},t&&(n.nail=()=>{l((e=>[...e,n])),r&&r(n),d.current.push(n.id)}),c.push(n)}return c.map((e=>(0,o.jsx)(u,{...e},e.id)))}},52527:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});const a={widest:"style_widest__hZ7sO",margined:"style_margined__GphyO","margined-bottom":"style_margined-bottom__KpiYO",horizontal:"style_horizontal__1xLer"}}}]);
//# sourceMappingURL=3753.f851916f.chunk.js.map