"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[4778,8939,9117],{207:(e,t,r)=>{r.d(t,{A:()=>y});var n=r(58168),o=r(98587),a=r(65043),s=r(58387),c=r(98610),l=r(21573),i=r(98206),u=r(34535),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var f=r(70579);const h=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),g={variant:"footer"},x="tfoot",y=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:a,component:u=x}=r,d=(0,o.A)(r,h),p=(0,n.A)({},r,{component:u}),y=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(p);return(0,f.jsx)(l.A.Provider,{value:g,children:(0,f.jsx)(A,(0,n.A)({as:u,className:(0,s.A)(y.root,a),ref:t,role:u===x?null:"rowgroup",ownerState:p},d))})})},10939:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(89379),o=r(80045),a=r(65043),s=r(12110),c=r(17604);const l="style_container__M9GCG";var i=r(70579);const u=["overrideComponent"],d={opacity:[0,1]};(0,c.A)()||(d.transform=["translateY(50px)","translateY(0)"]);const p={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},m=(0,a.forwardRef)((e,t)=>{let{overrideComponent:r}=e,c=(0,o.A)(e,u);const m=(0,a.useRef)(null);(0,a.useLayoutEffect)(()=>{const e=m.current&&m.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex(t=>e===t),r=e.animate(d,(0,n.A)((0,n.A)({},p),{},{delay:150*t}));return()=>r.cancel()},[]);const f=r?"section":s.A;return(0,i.jsx)("div",{ref:m,className:l,children:(0,i.jsx)(f,(0,n.A)((0,n.A)({component:"section"},c),{},{ref:t}))})})},12110:(e,t,r)=>{r.d(t,{A:()=>g});var n=r(58168),o=r(98587),a=r(65043),s=r(58387),c=r(98610),l=r(34535),i=r(98206),u=r(63336),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var f=r(70579);const h=["className","raised"],A=(0,l.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),g=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:a,raised:l=!1}=r,u=(0,o.A)(r,h),d=(0,n.A)({},r,{raised:l}),p=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(d);return(0,f.jsx)(A,(0,n.A)({className:(0,s.A)(p.root,a),elevation:l?8:void 0,ref:t,ownerState:d},u))})},35847:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(65043),o=r(29449);const a=()=>{const{topology:e}=(0,n.useContext)(o.f);return(0,n.useMemo)(()=>{if(!e)return;if(!e.proteinReferences.some(e=>!!e.epitopes))return;const t=e.proteinReferences.map(t=>{const r=t.uniprot,n=t.epitopes;if(!n)return[];const o=Object.values(n).map(e=>e.residues),a=[].concat.apply([],o),s=Array.from(new Set(a)),c=e.getReferenceResidueIndices(r,s);return c||[]}),r=[].concat.apply([],Object.values(t)),{rangedSelection:n,small:o}=e.residueIndices2Ngl(r);return[{name:"Epitopes",selection:n||"none",type:o?"licorice":"cartoon",color:"purple"}]},[e])}},51962:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(98587),o=r(58168),a=r(65043),s=r(58387),c=r(98610),l=r(60061),i=r(33064),u=r(59662),d=r(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),f=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var h=r(6803),A=r(98206),g=r(34535),x=r(61475),y=r(92532),v=r(72372);function b(e){return(0,v.Ay)("MuiCheckbox",e)}const j=(0,y.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),M=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],k=(0,g.Ay)(i.A,{shouldForwardProp:e=>(0,x.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t["size".concat((0,h.A)(r.size))],"default"!==r.color&&t["color".concat((0,h.A)(r.color))]]}})(e=>{let{theme:t,ownerState:r}=e;return(0,o.A)({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?"rgba(".concat("default"===r.color?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.X4)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{["&.".concat(j.checked,", &.").concat(j.indeterminate)]:{color:(t.vars||t).palette[r.color].main},["&.".concat(j.disabled)]:{color:(t.vars||t).palette.action.disabled}})}),C=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),w=(0,d.jsx)(f,{}),_=a.forwardRef(function(e,t){var r,l;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=C,color:p="primary",icon:m=S,indeterminate:f=!1,indeterminateIcon:g=w,inputProps:x,size:y="medium",className:v}=i,j=(0,n.A)(i,M),_=f?g:m,R=f?g:u,N=(0,o.A)({},i,{color:p,indeterminate:f,size:y}),z=(e=>{const{classes:t,indeterminate:r,color:n,size:a}=e,s={root:["root",r&&"indeterminate","color".concat((0,h.A)(n)),"size".concat((0,h.A)(a))]},l=(0,c.A)(s,b,t);return(0,o.A)({},t,l)})(N);return(0,d.jsx)(k,(0,o.A)({type:"checkbox",inputProps:(0,o.A)({"data-indeterminate":f},x),icon:a.cloneElement(_,{fontSize:null!=(r=_.props.fontSize)?r:y}),checkedIcon:a.cloneElement(R,{fontSize:null!=(l=R.props.fontSize)?l:y}),ownerState:N,ref:t,className:(0,s.A)(z.root,v)},j,{classes:z}))})},67526:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(65043),o=r(89257),a=r(71806),s=r(84882),c=r(28076),l=r(10039),i=r(83558),u=r(51962),d=r(73460),p=r(207),m=r(67803),f=r(85865),h=r(10939),A=r(14696),g=r(10419),x=r(88939),y=r(29449),v=r(17545),b=r(58338),j=r(97318),M=r(95747),k=r(35847),C=r(70579);const S=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],w=[10,25,50,100],_=(0,n.lazy)(()=>Promise.all([r.e(7631),r.e(3969),r.e(5291),r.e(5077)]).then(r.bind(r,75291))),R={triggerOnce:!0,rootMargin:"100px"},N=e=>Math.round(10*e)/10,z=()=>{const[e,t]=(0,o.Wx)(R),{accessionAndMdNumber:r,metadata:z,proteinReferences:P,topology:E}=(0,n.useContext)(y.f),O=(0,n.useMemo)(()=>{if(!P)return[];const e=[];return P.forEach(t=>{const r=t.epitopes;if(!r)return;const n=Object.entries(r).map(e=>{let[r,n]=e;return[t.uniprot,r,n.residues,n.mas]});e.push(...n)}),e},[P]),I=(0,n.useRef)(null),F=(0,n.useRef)(null),T=(0,n.useRef)(null),L=(0,n.useRef)(null),[H,B]=(0,j.A)(),[V,D]=(0,n.useState)(!1),[q,G]=(0,n.useState)(null),[U,Y]=(0,n.useState)([]),[J,K]=(0,n.useState)(0),[Q,W]=(0,n.useState)(10),{loading:X,payload:Z,error:$}=(0,b.A)("".concat(M.nP,"/").concat(r,"/analyses/sasa/")),{data:ee,epitopesData:te,frameStep:re,frameCount:ne,xTooltip:oe}=(0,n.useMemo)(()=>{if(!Z||!z||!E||0===O.length)return{};const e=Z.saspf,t=e[0].length,r=Z.step||Math.floor(z.mdFrames/(t-1)),n=[];O.forEach(r=>{let[o,a,s,c]=r;const l=E.getReferenceResidueIndices(o,s);if(0===l.length)return{};const i=E.byChains(l),u=Object.keys(i),d={};Object.entries(i).forEach(t=>{let[r,n]=t;const o=n.map(t=>{const r={saspf:e[t]};return r.atoms=E.getResidueByIndex(t).atomCount,r});d[r]=o});const p={},m=[];Object.entries(d).forEach(e=>{let[r,n]=e;const o=n.length/s.length,a=o%1===0,l=c*o,i=[],u=[];for(let s=0;s<t;s++){const e=n.map(e=>e.saspf[s]*e.atoms).reduce((e,t)=>e+t,0);i.push(e);const t=e/l*100;u.push(t)}const d=(e=>{const t=e.reduce((e,t)=>e+t,0),r=e.length;return N(t/r)})(i),f=N(d/l*100),h="".concat(r,":").concat(d," \xc5\xb2 (").concat(f,"%)").concat(a?"":"*");m.push(h),p[r]=u});const{rangedSelection:f,small:h}=E.residueIndices2Ngl(l);n.push({name:a,data:p,selection:f,small:h,chains:u,summary:m.join("\n")})}),Y(new Array(n.length).fill(null));return{data:e,epitopesData:n,frameStep:r,frameCount:t,xTooltip:e=>"frame "+e}},[Z,z,E,O]),ae=(0,g.A)(),se=(0,k.A)(),ce=(0,n.useMemo)(()=>{if(!r)return;const e="".concat(M.nP,"/").concat(r,"/files/trajectory");return[{trajectoryURLs:["".concat(e,"?frames=1:").concat(z.mdFrames,":").concat(re)]}]},[r,z,re]),[le,ie]=(0,n.useState)(null);(0,n.useMemo)(()=>{ae&&0!==ae.length&&se&&0!==se.length&&te&&ie(e=>{if(null===e){const e=[];return ae.forEach(t=>{t.opacity=.3,t.color="black",e.push(t)}),U.forEach((t,r)=>{if(null===t)return;const n=te[r],o={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:t};e.push(o)}),V&&e.push(...se),e}const t=[];t.push(...ae),U.forEach((r,n)=>{if(null===r)return;const o=te[n],a=e.find(e=>e.name===o.name);if(a)return t.push(a);const s={name:o.name,selection:o.selection,type:o.small?"licorice":"cartoon",color:r};t.push(s)}),V&&t.push(...se);const r=e.filter(e=>e.custom);return t.push(...r),t})},[te,ae,se,U,V]);const ue=(0,n.useMemo)(()=>{if(!te)return;if(null===q)return;const e=te[q];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]},[te,q]),de=(0,n.useMemo)(()=>{if(!ee||!z||!te)return;const e={};return te.forEach((t,r)=>{let{name:n,data:o}=t;if(!U[r])return;const a=U[r];Object.entries(o).forEach((t,r)=>{let[o,s]=t;const c=S[r];e[n+"-"+o]={data:s,color:a,dash:c}})}),e},[ee,z,te,U]),pe=(0,n.useCallback)(e=>{T.current.togglePlaying(!1),T.current.currentFrame=e},[]),me=(0,n.useCallback)(e=>{const t=Math.round(e*(ne-1));L.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]},[ne]);if(X)return(0,C.jsx)(v.A,{});if($)return $.toString();if(!Z)return"Something bad happened";if(!E||!P)return(0,C.jsx)(v.A,{});if(0===O.length)return"Missing epitopes data";const fe=J*Q,he=(J+1)*Q;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(h.A,{className:x.default.tablecard,children:(0,C.jsx)("div",{className:x.default.paper,ref:F,children:(0,C.jsxs)(a.A,{stickyHeader:!0,size:"small",children:[(0,C.jsx)(s.A,{children:(0,C.jsxs)(c.A,{children:[(0,C.jsx)(l.A,{children:(0,C.jsx)(i.A,{onChange:()=>D(e=>!e),control:(0,C.jsx)(u.A,{checked:V}),label:"Epitopes"})},0),(0,C.jsx)(l.A,{children:"Average SAS and exposure"},1)]})}),(0,C.jsx)(d.A,{children:te.slice(fe,he).map((e,t)=>{let{name:r,summary:n}=e;const o=J*Q+t;return(0,C.jsx)(c.A,{role:"checkbox",className:o===q?x.default.selectedrow:x.default.row,onMouseEnter:()=>G(o),onMouseLeave:()=>G(e=>e===o?null:e),children:[(0,C.jsx)(i.A,{"data-key":r,onMouseOver:()=>{I.current=o},onMouseOut:()=>{I.current=null},onChange:()=>Y(e=>(e[o]?(B(e[o]),e[o]=null):e[o]=H(),[...e])),control:(0,C.jsx)(u.A,{checked:!!U[o],style:{color:U[o]?U[o]:"black"},inputProps:{"data-key":r}}),label:(0,C.jsx)("a",{href:"https://www.rcsb.org/structure/"+r,target:"_blank",rel:"noreferrer noopener",children:r})},r),n].map(e=>(0,C.jsx)(l.A,{children:e},e))},r)})}),(0,C.jsx)(p.A,{children:(0,C.jsx)(c.A,{children:(0,C.jsx)(m.A,{rowsPerPageOptions:w,colSpan:4,count:te.length,rowsPerPage:Q,page:J,onPageChange:(e,t)=>{K(t),F.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;W(t),K(0)}})})})]})})}),(0,C.jsx)(h.A,{className:x.default.nglcard,ref:e,children:t?(0,C.jsx)(A.default,{className:x.default.container,startingComponents:ce,representationsState:[le,ie],snapRepresentations:ue,onProgress:me,ref:T}):(0,C.jsx)("div",{style:{height:"50vh"}})}),(0,C.jsxs)(h.A,{className:x.default.graph,children:[U.every(e=>null===e)&&(0,C.jsx)("div",{className:x.default["graph-placeholder"],children:(0,C.jsx)(f.A,{variant:"h6",children:"No epitope selected"})}),(0,C.jsx)(_,{yData:de,step:re,xTooltip:oe,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:pe,displayLegend:!0,className:x.default.graph,ref:L})]})]})}},88939:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n={paper:"style_paper__INgwI",tablecard:"style_tablecard__04qFr",nglcard:"style_nglcard__L-RSO",margined:"style_margined__SQ+iA",container:"style_container__UgV8T",selectedrow:"style_selectedrow__vdp-o",row:"style_row__6TSz1",graph:"style_graph__IyyKm","graph-placeholder":"style_graph-placeholder__ZJ5fh"}},97318:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(65043);const o=["red","green","blue","orange","purple"],a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const r=(0,n.useRef)([]);return(0,n.useMemo)(()=>[()=>{for(const t of e){if(-1===r.current.indexOf(t))return r.current.push(t),t}return t},e=>{if(e===t)return;const n=r.current.indexOf(e);if(-1===n)throw new Error("Color ".concat(e," is not used"));r.current.splice(n,1)},()=>{r.current=[]}],[e,t])}}}]);
//# sourceMappingURL=4778.05a3b7ff.chunk.js.map