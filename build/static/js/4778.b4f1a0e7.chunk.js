"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[4778,8939,9117],{207:(e,t,r)=>{r.d(t,{A:()=>y});var n=r(58168),o=r(98587),a=r(65043),s=r(58387),l=r(98610),c=r(21573),i=r(98206),u=r(34535),d=r(92532),p=r(72372);function h(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var m=r(70579);const f=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),x={variant:"footer"},g="tfoot",y=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:a,component:u=g}=r,d=(0,o.A)(r,f),p=(0,n.A)({},r,{component:u}),y=(e=>{const{classes:t}=e;return(0,l.A)({root:["root"]},h,t)})(p);return(0,m.jsx)(c.A.Provider,{value:x,children:(0,m.jsx)(A,(0,n.A)({as:u,className:(0,s.A)(y.root,a),ref:t,role:u===g?null:"rowgroup",ownerState:p},d))})})},10939:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(65043),o=r(12110),a=r(17604);const s="style_container__M9GCG";var l=r(70579);const c={opacity:[0,1]};(0,a.A)()||(c.transform=["translateY(50px)","translateY(0)"]);const i={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},u=(0,n.forwardRef)((e,t)=>{let{overrideComponent:r,...a}=e;const u=(0,n.useRef)(null);(0,n.useLayoutEffect)(()=>{const e=u.current&&u.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex(t=>e===t),r=e.animate(c,{...i,delay:150*t});return()=>r.cancel()},[]);const d=r?"section":o.A;return(0,l.jsx)("div",{ref:u,className:s,children:(0,l.jsx)(d,{component:"section",...a,ref:t})})})},12110:(e,t,r)=>{r.d(t,{A:()=>x});var n=r(58168),o=r(98587),a=r(65043),s=r(58387),l=r(98610),c=r(34535),i=r(98206),u=r(63336),d=r(92532),p=r(72372);function h(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var m=r(70579);const f=["className","raised"],A=(0,c.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),x=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:a,raised:c=!1}=r,u=(0,o.A)(r,f),d=(0,n.A)({},r,{raised:c}),p=(e=>{const{classes:t}=e;return(0,l.A)({root:["root"]},h,t)})(d);return(0,m.jsx)(A,(0,n.A)({className:(0,s.A)(p.root,a),elevation:c?8:void 0,ref:t,ownerState:d},u))})},51962:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(98587),o=r(58168),a=r(65043),s=r(58387),l=r(98610),c=r(60061),i=r(33064),u=r(59662),d=r(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),h=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var f=r(6803),A=r(98206),x=r(34535),g=r(61475),y=r(92532),v=r(72372);function b(e){return(0,v.Ay)("MuiCheckbox",e)}const j=(0,y.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),k=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],M=(0,x.Ay)(i.A,{shouldForwardProp:e=>(0,g.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t[`size${(0,f.A)(r.size)}`],"default"!==r.color&&t[`color${(0,f.A)(r.color)}`]]}})(e=>{let{theme:t,ownerState:r}=e;return(0,o.A)({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${"default"===r.color?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,c.X4)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{[`&.${j.checked}, &.${j.indeterminate}`]:{color:(t.vars||t).palette[r.color].main},[`&.${j.disabled}`]:{color:(t.vars||t).palette.action.disabled}})}),C=(0,d.jsx)(h,{}),S=(0,d.jsx)(p,{}),w=(0,d.jsx)(m,{}),_=a.forwardRef(function(e,t){var r,c;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=C,color:p="primary",icon:h=S,indeterminate:m=!1,indeterminateIcon:x=w,inputProps:g,size:y="medium",className:v}=i,j=(0,n.A)(i,k),_=m?x:h,R=m?x:u,z=(0,o.A)({},i,{color:p,indeterminate:m,size:y}),N=(e=>{const{classes:t,indeterminate:r,color:n,size:a}=e,s={root:["root",r&&"indeterminate",`color${(0,f.A)(n)}`,`size${(0,f.A)(a)}`]},c=(0,l.A)(s,b,t);return(0,o.A)({},t,c)})(z);return(0,d.jsx)(M,(0,o.A)({type:"checkbox",inputProps:(0,o.A)({"data-indeterminate":m},g),icon:a.cloneElement(_,{fontSize:null!=(r=_.props.fontSize)?r:y}),checkedIcon:a.cloneElement(R,{fontSize:null!=(c=R.props.fontSize)?c:y}),ownerState:z,ref:t,className:(0,s.A)(N.root,v)},j,{classes:N}))})},67526:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var n=r(65043),o=r(89257),a=r(71806),s=r(84882),l=r(28076),c=r(10039),i=r(83558),u=r(51962),d=r(73460),p=r(207),h=r(67803),m=r(85865),f=r(10939),A=r(14696),x=r(88939),g=r(29449),y=r(17545),v=r(58338),b=r(97318),j=r(95747),k=r(70579);const M=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],C=[10,25,50,100],S=(0,n.lazy)(()=>Promise.all([r.e(3969),r.e(5291),r.e(5077)]).then(r.bind(r,75291))),w={triggerOnce:!0,rootMargin:"100px"},_=e=>Math.round(10*e)/10,R=()=>{const[e,t]=(0,o.Wx)(w),{accessionAndMdNumber:r,metadata:R,proteinReferences:z,topology:N}=(0,n.useContext)(g.f),P=(0,n.useMemo)(()=>{if(!z)return[];const e=[];return z.forEach(t=>{const r=t.epitopes;if(!r)return;const n=Object.entries(r).map(e=>{let[r,n]=e;return[t.uniprot,r,n.residues,n.mas]});e.push(...n)}),e},[z]),$=(0,n.useRef)(null),E=(0,n.useRef)(null),O=(0,n.useRef)(null),I=(0,n.useRef)(null),[F,T]=(0,b.A)(),[L,H]=(0,n.useState)(!1),[B,V]=(0,n.useState)(null),[D,q]=(0,n.useState)([]),[G,U]=(0,n.useState)(0),[Y,J]=(0,n.useState)(10),{loading:K,payload:Q,error:W}=(0,v.A)(`${j.nP}/${r}/analyses/sasa/`),{data:X,epitopesData:Z,frameStep:ee,frameCount:te,xTooltip:re}=(0,n.useMemo)(()=>{if(!Q||!R||!N||0===P.length)return{};const e=Q.saspf,t=e[0].length,r=Q.step||Math.floor(R.mdFrames/(t-1)),n=[];P.forEach(r=>{let[o,a,s,l]=r;const c=N.getReferenceResidueIndices(o,s);if(0===c.length)return{};const i=N.byChains(c),u=Object.keys(i),d={};Object.entries(i).forEach(t=>{let[r,n]=t;const o=n.map(t=>{const r={saspf:e[t]};return r.atoms=N.getResidueByIndex(t).atomCount,r});d[r]=o});const p={},h=[];Object.entries(d).forEach(e=>{let[r,n]=e;const o=n.length/s.length,a=o%1===0,c=l*o,i=[],u=[];for(let s=0;s<t;s++){const e=n.map(e=>e.saspf[s]*e.atoms).reduce((e,t)=>e+t,0);i.push(e);const t=e/c*100;u.push(t)}const d=(e=>{const t=e.reduce((e,t)=>e+t,0),r=e.length;return _(t/r)})(i),m=`${r}:${d} \xc5\xb2 (${_(d/c*100)}%)${a?"":"*"}`;h.push(m),p[r]=u});const{rangedSelection:m,small:f}=N.residueIndices2Ngl(c);n.push({name:a,data:p,selection:m,small:f,chains:u,summary:h.join("\n")})}),q(new Array(n.length).fill(null));return{data:e,epitopesData:n,frameStep:r,frameCount:t,xTooltip:e=>"frame "+e}},[Q,R,N,P]),ne=N&&N.defaultRepresentations,oe=N&&N.epitopesRepresentations,ae=(0,n.useMemo)(()=>{if(!r)return;return[{trajectoryURLs:[`${`${j.nP}/${r}/files/trajectory`}?frames=1:${R.mdFrames}:${ee}`]}]},[r,R,ee]),[se,le]=(0,n.useState)(null);(0,n.useMemo)(()=>{ne&&0!==ne.length&&oe&&0!==oe.length&&Z&&le(e=>{if(null===e){const e=[];return ne.forEach(t=>{t.opacity=.3,t.color="black",e.push(t)}),D.forEach((t,r)=>{if(null===t)return;const n=Z[r],o={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:t};e.push(o)}),L&&e.push(...oe),e}const t=[];t.push(...ne),D.forEach((r,n)=>{if(null===r)return;const o=Z[n],a=e.find(e=>e.name===o.name);if(a)return t.push(a);const s={name:o.name,selection:o.selection,type:o.small?"licorice":"cartoon",color:r};t.push(s)}),L&&t.push(...oe);const r=e.filter(e=>e.custom);return t.push(...r),t})},[Z,ne,oe,D,L]);const ce=(0,n.useMemo)(()=>{if(!Z)return;if(null===B)return;const e=Z[B];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]},[Z,B]),ie=(0,n.useMemo)(()=>{if(!X||!R||!Z)return;const e={};return Z.forEach((t,r)=>{let{name:n,data:o}=t;if(!D[r])return;const a=D[r];Object.entries(o).forEach((t,r)=>{let[o,s]=t;const l=M[r];e[n+"-"+o]={data:s,color:a,dash:l}})}),e},[X,R,Z,D]),ue=(0,n.useCallback)(e=>{O.current.togglePlaying(!1),O.current.currentFrame=e},[]),de=(0,n.useCallback)(e=>{const t=Math.round(e*(te-1));I.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]},[te]);if(K)return(0,k.jsx)(y.A,{});if(W)return W.toString();if(!Q)return"Something bad happened";if(!N||!z)return(0,k.jsx)(y.A,{});if(0===P.length)return"Missing epitopes data";const pe=G*Y,he=(G+1)*Y;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f.A,{className:x.default.tablecard,children:(0,k.jsx)("div",{className:x.default.paper,ref:E,children:(0,k.jsxs)(a.A,{stickyHeader:!0,size:"small",children:[(0,k.jsx)(s.A,{children:(0,k.jsxs)(l.A,{children:[(0,k.jsx)(c.A,{children:(0,k.jsx)(i.A,{onChange:()=>H(e=>!e),control:(0,k.jsx)(u.A,{checked:L}),label:"Epitopes"})},0),(0,k.jsx)(c.A,{children:"Average SAS and exposure"},1)]})}),(0,k.jsx)(d.A,{children:Z.slice(pe,he).map((e,t)=>{let{name:r,summary:n}=e;const o=G*Y+t;return(0,k.jsx)(l.A,{role:"checkbox",className:o===B?x.default.selectedrow:x.default.row,onMouseEnter:()=>V(o),onMouseLeave:()=>V(e=>e===o?null:e),children:[(0,k.jsx)(i.A,{"data-key":r,onMouseOver:()=>{$.current=o},onMouseOut:()=>{$.current=null},onChange:()=>q(e=>(e[o]?(T(e[o]),e[o]=null):e[o]=F(),[...e])),control:(0,k.jsx)(u.A,{checked:!!D[o],style:{color:D[o]?D[o]:"black"},inputProps:{"data-key":r}}),label:(0,k.jsx)("a",{href:"https://www.rcsb.org/structure/"+r,target:"_blank",rel:"noreferrer noopener",children:r})},r),n].map(e=>(0,k.jsx)(c.A,{children:e},e))},r)})}),(0,k.jsx)(p.A,{children:(0,k.jsx)(l.A,{children:(0,k.jsx)(h.A,{rowsPerPageOptions:C,colSpan:4,count:Z.length,rowsPerPage:Y,page:G,onPageChange:(e,t)=>{U(t),E.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;J(t),U(0)}})})})]})})}),(0,k.jsx)(f.A,{className:x.default.nglcard,ref:e,children:t?(0,k.jsx)(A.default,{className:x.default.container,startingComponents:ae,representationsState:[se,le],snapRepresentations:ce,onProgress:de,ref:O}):(0,k.jsx)("div",{style:{height:"50vh"}})}),(0,k.jsxs)(f.A,{className:x.default.graph,children:[D.every(e=>null===e)&&(0,k.jsx)("div",{className:x.default["graph-placeholder"],children:(0,k.jsx)(m.A,{variant:"h6",children:"No epitope selected"})}),(0,k.jsx)(S,{yData:ie,step:ee,xTooltip:re,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:ue,displayLegend:!0,className:x.default.graph,ref:I})]})]})}},88939:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n={paper:"style_paper__INgwI",tablecard:"style_tablecard__04qFr",nglcard:"style_nglcard__L-RSO",margined:"style_margined__SQ+iA",container:"style_container__UgV8T",selectedrow:"style_selectedrow__vdp-o",row:"style_row__6TSz1",graph:"style_graph__IyyKm","graph-placeholder":"style_graph-placeholder__ZJ5fh"}},97318:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(65043);const o=["red","green","blue","orange","purple"],a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const r=(0,n.useRef)([]);return(0,n.useMemo)(()=>[()=>{for(const t of e){if(-1===r.current.indexOf(t))return r.current.push(t),t}return t},e=>{if(e===t)return;const n=r.current.indexOf(e);if(-1===n)throw new Error(`Color ${e} is not used`);r.current.splice(n,1)},()=>{r.current=[]}],[e,t])}}}]);
//# sourceMappingURL=4778.b4f1a0e7.chunk.js.map