"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[4778,8939,9117],{207:(e,t,r)=>{r.d(t,{A:()=>y});var o=r(58168),n=r(98587),a=r(65043),s=r(58387),c=r(98610),l=r(21573),i=r(98206),u=r(34535),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var h=r(70579);const f=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),x={variant:"footer"},g="tfoot",y=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:a,component:u=g}=r,d=(0,n.A)(r,f),p=(0,o.A)({},r,{component:u}),y=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(p);return(0,h.jsx)(l.A.Provider,{value:x,children:(0,h.jsx)(A,(0,o.A)({as:u,className:(0,s.A)(y.root,a),ref:t,role:u===g?null:"rowgroup",ownerState:p},d))})})},10939:(e,t,r)=>{r.d(t,{A:()=>m});var o=r(89379),n=r(80045),a=r(65043),s=r(12110),c=r(17604);const l="style_container__M9GCG";var i=r(70579);const u=["overrideComponent"],d={opacity:[0,1]};(0,c.A)()||(d.transform=["translateY(50px)","translateY(0)"]);const p={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},m=(0,a.forwardRef)((e,t)=>{let{overrideComponent:r}=e,c=(0,n.A)(e,u);const m=(0,a.useRef)(null);(0,a.useLayoutEffect)(()=>{const e=m.current&&m.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex(t=>e===t),r=e.animate(d,(0,o.A)((0,o.A)({},p),{},{delay:150*t}));return()=>r.cancel()},[]);const h=r?"section":s.A;return(0,i.jsx)("div",{ref:m,className:l,children:(0,i.jsx)(h,(0,o.A)((0,o.A)({component:"section"},c),{},{ref:t}))})})},12110:(e,t,r)=>{r.d(t,{A:()=>x});var o=r(58168),n=r(98587),a=r(65043),s=r(58387),c=r(98610),l=r(34535),i=r(98206),u=r(63336),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var h=r(70579);const f=["className","raised"],A=(0,l.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),x=a.forwardRef(function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:a,raised:l=!1}=r,u=(0,n.A)(r,f),d=(0,o.A)({},r,{raised:l}),p=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(d);return(0,h.jsx)(A,(0,o.A)({className:(0,s.A)(p.root,a),elevation:l?8:void 0,ref:t,ownerState:d},u))})},51962:(e,t,r)=>{r.d(t,{A:()=>_});var o=r(98587),n=r(58168),a=r(65043),s=r(58387),c=r(98610),l=r(60061),i=r(33064),u=r(59662),d=r(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),h=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var f=r(6803),A=r(98206),x=r(34535),g=r(61475),y=r(92532),v=r(72372);function b(e){return(0,v.Ay)("MuiCheckbox",e)}const j=(0,y.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),k=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],M=(0,x.Ay)(i.A,{shouldForwardProp:e=>(0,g.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t["size".concat((0,f.A)(r.size))],"default"!==r.color&&t["color".concat((0,f.A)(r.color))]]}})(e=>{let{theme:t,ownerState:r}=e;return(0,n.A)({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?"rgba(".concat("default"===r.color?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.X4)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{["&.".concat(j.checked,", &.").concat(j.indeterminate)]:{color:(t.vars||t).palette[r.color].main},["&.".concat(j.disabled)]:{color:(t.vars||t).palette.action.disabled}})}),C=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),w=(0,d.jsx)(h,{}),_=a.forwardRef(function(e,t){var r,l;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=C,color:p="primary",icon:m=S,indeterminate:h=!1,indeterminateIcon:x=w,inputProps:g,size:y="medium",className:v}=i,j=(0,o.A)(i,k),_=h?x:m,R=h?x:u,z=(0,n.A)({},i,{color:p,indeterminate:h,size:y}),N=(e=>{const{classes:t,indeterminate:r,color:o,size:a}=e,s={root:["root",r&&"indeterminate","color".concat((0,f.A)(o)),"size".concat((0,f.A)(a))]},l=(0,c.A)(s,b,t);return(0,n.A)({},t,l)})(z);return(0,d.jsx)(M,(0,n.A)({type:"checkbox",inputProps:(0,n.A)({"data-indeterminate":h},g),icon:a.cloneElement(_,{fontSize:null!=(r=_.props.fontSize)?r:y}),checkedIcon:a.cloneElement(R,{fontSize:null!=(l=R.props.fontSize)?l:y}),ownerState:z,ref:t,className:(0,s.A)(N.root,v)},j,{classes:N}))})},67526:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var o=r(65043),n=r(89257),a=r(71806),s=r(84882),c=r(28076),l=r(10039),i=r(83558),u=r(51962),d=r(73460),p=r(207),m=r(67803),h=r(85865),f=r(10939),A=r(45944),x=r(88939),g=r(29449),y=r(17545),v=r(58338),b=r(97318),j=r(95747),k=r(70579);const M=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],C=[10,25,50,100],S=(0,o.lazy)(()=>Promise.all([r.e(3969),r.e(5291),r.e(5077)]).then(r.bind(r,75291))),w={triggerOnce:!0,rootMargin:"100px"},_=e=>Math.round(10*e)/10,R=()=>{const[e,t]=(0,n.Wx)(w),{accessionAndMdNumber:r,metadata:R,proteinReferences:z,topology:N}=(0,o.useContext)(g.f),P=(0,o.useMemo)(()=>{if(!z)return[];const e=[];return z.forEach(t=>{const r=t.epitopes;if(!r)return;const o=Object.entries(r).map(e=>{let[r,o]=e;return[t.uniprot,r,o.residues,o.mas]});e.push(...o)}),e},[z]),E=(0,o.useRef)(null),O=(0,o.useRef)(null),I=(0,o.useRef)(null),F=(0,o.useRef)(null),[T,L]=(0,b.A)(),[H,B]=(0,o.useState)(!1),[V,D]=(0,o.useState)(null),[q,G]=(0,o.useState)([]),[U,Y]=(0,o.useState)(0),[J,K]=(0,o.useState)(10),{loading:Q,payload:W,error:X}=(0,v.A)("".concat(j.nP,"/").concat(r,"/analyses/sasa/")),{data:Z,epitopesData:$,frameStep:ee,frameCount:te,xTooltip:re}=(0,o.useMemo)(()=>{if(!W||!R||!N||0===P.length)return{};const e=W.saspf,t=e[0].length,r=W.step||Math.floor(R.mdFrames/(t-1)),o=[];P.forEach(r=>{let[n,a,s,c]=r;const l=N.getReferenceResidueIndices(n,s);if(0===l.length)return{};const i=N.byChains(l),u=Object.keys(i),d={};Object.entries(i).forEach(t=>{let[r,o]=t;const n=o.map(t=>{const r={saspf:e[t]};return r.atoms=N.getResidueByIndex(t).atomCount,r});d[r]=n});const p={},m=[];Object.entries(d).forEach(e=>{let[r,o]=e;const n=o.length/s.length,a=n%1===0,l=c*n,i=[],u=[];for(let s=0;s<t;s++){const e=o.map(e=>e.saspf[s]*e.atoms).reduce((e,t)=>e+t,0);i.push(e);const t=e/l*100;u.push(t)}const d=(e=>{const t=e.reduce((e,t)=>e+t,0),r=e.length;return _(t/r)})(i),h=_(d/l*100),f="".concat(r,":").concat(d," \xc5\xb2 (").concat(h,"%)").concat(a?"":"*");m.push(f),p[r]=u});const{rangedSelection:h,small:f}=N.residueIndices2Ngl(l);o.push({name:a,data:p,selection:h,small:f,chains:u,summary:m.join("\n")})}),G(new Array(o.length).fill(null));return{data:e,epitopesData:o,frameStep:r,frameCount:t,xTooltip:e=>"frame "+e}},[W,R,N,P]),oe=N&&N.defaultRepresentations,ne=N&&N.epitopesRepresentations,ae=(0,o.useMemo)(()=>[{trajectoryURLs:["/trajectory?frames=1:".concat(R.mdFrames,":").concat(ee)]}],[R,ee]),[se,ce]=(0,o.useState)(null);(0,o.useMemo)(()=>{oe&&0!==oe.length&&ne&&0!==ne.length&&$&&ce(e=>{if(null===e){const e=[];return oe.forEach(t=>{t.opacity=.3,t.color="black",e.push(t)}),q.forEach((t,r)=>{if(null===t)return;const o=$[r],n={name:o.name,selection:o.selection,type:o.small?"licorice":"cartoon",color:t};e.push(n)}),H&&e.push(...ne),e}const t=[];t.push(...oe),q.forEach((r,o)=>{if(null===r)return;const n=$[o],a=e.find(e=>e.name===n.name);if(a)return t.push(a);const s={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:r};t.push(s)}),H&&t.push(...ne);const r=e.filter(e=>e.custom);return t.push(...r),t})},[$,oe,ne,q,H]);const le=(0,o.useMemo)(()=>{if(!$)return;if(null===V)return;const e=$[V];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]},[$,V]),ie=(0,o.useMemo)(()=>{if(!Z||!R||!$)return;const e={};return $.forEach((t,r)=>{let{name:o,data:n}=t;if(!q[r])return;const a=q[r];Object.entries(n).forEach((t,r)=>{let[n,s]=t;const c=M[r];e[o+"-"+n]={data:s,color:a,dash:c}})}),e},[Z,R,$,q]),ue=(0,o.useCallback)(e=>{I.current.togglePlaying(!1),I.current.currentFrame=e},[]),de=(0,o.useCallback)(e=>{const t=Math.round(e*(te-1));F.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]},[te]);if(Q)return(0,k.jsx)(y.A,{});if(X)return X.toString();if(!W)return"Something bad happened";if(!N||!z)return(0,k.jsx)(y.A,{});if(0===P.length)return"Missing epitopes data";const pe=U*J,me=(U+1)*J;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f.A,{className:x.default.tablecard,children:(0,k.jsx)("div",{className:x.default.paper,ref:O,children:(0,k.jsxs)(a.A,{stickyHeader:!0,size:"small",children:[(0,k.jsx)(s.A,{children:(0,k.jsxs)(c.A,{children:[(0,k.jsx)(l.A,{children:(0,k.jsx)(i.A,{onChange:()=>B(e=>!e),control:(0,k.jsx)(u.A,{checked:H}),label:"Epitopes"})},0),(0,k.jsx)(l.A,{children:"Average SAS and exposure"},1)]})}),(0,k.jsx)(d.A,{children:$.slice(pe,me).map((e,t)=>{let{name:r,summary:o}=e;const n=U*J+t;return(0,k.jsx)(c.A,{role:"checkbox",className:n===V?x.default.selectedrow:x.default.row,onMouseEnter:()=>D(n),onMouseLeave:()=>D(e=>e===n?null:e),children:[(0,k.jsx)(i.A,{"data-key":r,onMouseOver:()=>{E.current=n},onMouseOut:()=>{E.current=null},onChange:()=>G(e=>(e[n]?(L(e[n]),e[n]=null):e[n]=T(),[...e])),control:(0,k.jsx)(u.A,{checked:!!q[n],style:{color:q[n]?q[n]:"black"},inputProps:{"data-key":r}}),label:(0,k.jsx)("a",{href:"https://www.rcsb.org/structure/"+r,target:"_blank",rel:"noreferrer noopener",children:r})},r),o].map(e=>(0,k.jsx)(l.A,{children:e},e))},r)})}),(0,k.jsx)(p.A,{children:(0,k.jsx)(c.A,{children:(0,k.jsx)(m.A,{rowsPerPageOptions:C,colSpan:4,count:$.length,rowsPerPage:J,page:U,onPageChange:(e,t)=>{Y(t),O.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;K(t),Y(0)}})})})]})})}),(0,k.jsx)(f.A,{className:x.default.nglcard,ref:e,children:t?(0,k.jsx)(A.default,{className:x.default.container,startingComponents:ae,representationsState:[se,ce],snapRepresentations:le,onProgress:de,ref:I}):(0,k.jsx)("div",{style:{height:"50vh"}})}),(0,k.jsxs)(f.A,{className:x.default.graph,children:[q.every(e=>null===e)&&(0,k.jsx)("div",{className:x.default["graph-placeholder"],children:(0,k.jsx)(h.A,{variant:"h6",children:"No epitope selected"})}),(0,k.jsx)(S,{yData:ie,step:ee,xTooltip:re,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:ue,displayLegend:!0,className:x.default.graph,ref:F})]})]})}},88939:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});const o={paper:"style_paper__INgwI",tablecard:"style_tablecard__04qFr",nglcard:"style_nglcard__L-RSO",margined:"style_margined__SQ+iA",container:"style_container__UgV8T",selectedrow:"style_selectedrow__vdp-o",row:"style_row__6TSz1",graph:"style_graph__IyyKm","graph-placeholder":"style_graph-placeholder__ZJ5fh"}},97318:(e,t,r)=>{r.d(t,{A:()=>a});var o=r(65043);const n=["red","green","blue","orange","purple"],a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const r=(0,o.useRef)([]);return(0,o.useMemo)(()=>[()=>{for(const t of e){if(-1===r.current.indexOf(t))return r.current.push(t),t}return t},e=>{if(e===t)return;const o=r.current.indexOf(e);if(-1===o)throw new Error("Color ".concat(e," is not used"));r.current.splice(o,1)},()=>{r.current=[]}],[e,t])}}}]);
//# sourceMappingURL=4778.b9b814e8.chunk.js.map