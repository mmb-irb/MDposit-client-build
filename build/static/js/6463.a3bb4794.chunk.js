"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[6463],{10939:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(89379),r=n(80045),o=n(65043),s=n(12110),l=n(17604);const i="style_container__M9GCG";var c=n(70579);const d=["overrideComponent"],u={opacity:[0,1]};(0,l.A)()||(u.transform=["translateY(50px)","translateY(0)"]);const h={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},p=(0,o.forwardRef)((e,t)=>{let{overrideComponent:n}=e,l=(0,r.A)(e,d);const p=(0,o.useRef)(null);(0,o.useLayoutEffect)(()=>{const e=p.current&&p.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex(t=>e===t),n=e.animate(u,(0,a.A)((0,a.A)({},h),{},{delay:150*t}));return()=>n.cancel()},[]);const m=n?"section":s.A;return(0,c.jsx)("div",{ref:p,className:i,children:(0,c.jsx)(m,(0,a.A)((0,a.A)({component:"section"},l),{},{ref:t}))})})},12110:(e,t,n)=>{n.d(t,{A:()=>x});var a=n(58168),r=n(98587),o=n(65043),s=n(58387),l=n(98610),i=n(34535),c=n(98206),d=n(63336),u=n(92532),h=n(72372);function p(e){return(0,h.Ay)("MuiCard",e)}(0,u.A)("MuiCard",["root"]);var m=n(70579);const f=["className","raised"],g=(0,i.Ay)(d.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),x=o.forwardRef(function(e,t){const n=(0,c.b)({props:e,name:"MuiCard"}),{className:o,raised:i=!1}=n,d=(0,r.A)(n,f),u=(0,a.A)({},n,{raised:i}),h=(e=>{const{classes:t}=e;return(0,l.A)({root:["root"]},p,t)})(u);return(0,m.jsx)(g,(0,a.A)({className:(0,s.A)(h.root,o),elevation:i?8:void 0,ref:t,ownerState:u},d))})},32633:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});const a={card:"style_card__pEq-k",tabs:"style_tabs__HhB5H",nglcard:"style_nglcard__3eXUT",container:"style_container__eab4U",legend_container:"style_legend_container__swfrT",legend:"style_legend__SS-DS"}},60676:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(65043),r=n(26494);const o="style_horizontal__KW-k9",s="style_vertical__YKrT2",l="style_heatmap-horizontal__HjdIF",i="style_heatmap-vertical__utgJY";var c=n(85941),d=n(70579);const u=e=>{let{title:t="",maxValue:n=1,minValue:u=0,colorPlan:h,splits:p=19,vertical:m=!1,flip:f=!1,className:g}=e;const{legendData:x,legendLabels:y}=(0,a.useMemo)(()=>{const e=[];if(u===n)e.push(u);else for(let r=u;r<=n;r+=(n-u)/p)e.push(r);let t=e.map(e=>Math.round(e));if(t.length>1)for(let n=1;new Set(t).size<t.length;n++)t=e.map(e=>Math.round(e*10**n)/10**n);const a=m?e.map(e=>[e]):[e];return f&&(a.reverse(),t.reverse()),{legendData:a,legendLabels:t}},[n,u,p,m]);return(0,d.jsxs)(r.A,{className:g||(m?s:o),children:[t,(0,d.jsx)(c.A,{data:x,xAxisValues:m?[""]:y,yAxisValues:m?y:[""],colorPlan:h,flippedXAxisValues:!1,className:m?i:l})]})}},77691:(e,t,n)=>{n.d(t,{jY:()=>r,q_:()=>a});const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bold 10px sans-serif";const n=(a.canvas||(a.canvas=document.createElement("canvas"))).getContext("2d");n.font=t;return n.measureText(e).width},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bold 10px sans-serif";const n=document.createElement("div"),a=document.createTextNode(e);return n.appendChild(a),Object.assign(n.style,{font:t,position:"absolute",visibility:"hidden",height:"auto",width:"auto","white-space":"nowrap"}),document.body.appendChild(n),{width:n.clientWidth,height:n.clientHeight}}},85941:(e,t,n)=>{n.d(t,{A:()=>d});var a=n(65043),r=n(77691),o=n(57631),s=n(13232),l=n(70579);const i="normal 10px sans-serif",c="normal 14px sans-serif",d=(0,a.memo)(e=>{let{data:t,xAxisValues:n=[],yAxisValues:d=[],xAxisLabel:u,yAxisLabel:h,verticalPadding:p=0,colorPlan:m=["red","white","blue"],colorScale:f,onTooltip:g,onClick:x,flippedXAxisValues:y=!0,margin:v={top:10,right:10,bottom:10,left:10},className:A,NaNColor:b="#ffffff",minValue:w,maxValue:_,addBorder:N=!0}=e;if(!t)throw new Error("Data is missing. Data is mandatory for the heatmap representation");if(n.length!==new Set(n).size)throw console.log(n),new Error("Duplicated values in the X axis. See console logs");if(d.length!==new Set(d).size)throw console.log(d),new Error("Duplicated values in the Y axis. See console logs");0===n.length&&(n=Array.from(Array(t[0].length).keys())),0===d.length&&(d=Array.from(Array(t[0].length).keys()));const j=[].concat(...t),M=j.filter(e=>!isNaN(e)),C=null!==_&&void 0!==_?_:Math.max(...M),S=null!==w&&void 0!==w?w:Math.min(...M),E=[].concat(...Array(t.length).fill(n)),k=[];for(const a of d)k.push(...Array(n.length).fill(a));const R=[];for(const a in j)R.push({v:j[a],x:E[a],y:k[a]});const L=(0,a.useRef)(null),V=(0,a.useRef)(null),[,Y]=(0,a.useState)(null),I=(0,r.jY)("|",i).height,W=(0,r.jY)("|",c).height+9,D=Math.max(...n.map(e=>(0,r.q_)(e,i)))+9,H=Math.max(...d.map(e=>(0,r.q_)(e,i))),z=u?W:0,q=h?W+9:0,T=y?D+z:I+z,X=1===d.length?Math.max(H,(0,r.q_)(h,c)):H+q,O={top:v.top,right:v.right,bottom:T+v.bottom,left:X+v.left};return(0,a.useEffect)(()=>{V.current&&V.current.forEach(e=>e.remove());const e=L.current,{clientWidth:a,clientHeight:r}=e.parentElement,l=a-O.left-O.right,i=r-O.top-O.bottom,c=l/(1.05*(y?I:D)),A=i/(1.05*I),w=Math.ceil(n.length/c),_=Math.ceil(d.length/A),j=document.createElement("CANVAS");(0,o.Ltv)(e).node().appendChild(j);const M=(0,o.Ltv)(j).attr("id","canvas").attr("width",l).attr("height",i).style("position","absolute").style("top",O.top+"px").style("left",O.left+"px").style("cursor",x?"pointer":void 0),E=M.node().getContext("2d"),k=(0,o.Ltv)(e).append("svg").attr("id","svg").attr("viewBox",[0,0,a,r]),R=(0,o.WH)().range([O.left,l+O.left]).domain(n).paddingInner(0),W=k.append("g").attr("transform","translate(0,"+(i+O.top)+")").call((0,o.l78)(R).tickFormat((e,t)=>t%w===0?e:"")).selectAll("text");y&&W.style("text-anchor","end").attr("dx","-9px").attr("dy","-9px").attr("transform","rotate(-90)"),k.append("text").attr("class","x label").attr("text-anchor","middle").attr("x",O.left+l/2).attr("y",O.top+i+T).text(u);const H=(0,o.WH)().domain(d).range([O.top,i+O.top]).padding(p);k.append("g").attr("transform","translate("+O.left+", 0)").call((0,o.V4s)(H).tickFormat((e,t)=>t%_===0?e:"")),1===d.length?k.append("text").attr("class","y label").attr("text-anchor","start").attr("x",0).attr("y",v.top+i).text(h):k.append("text").attr("class","y label").attr("text-anchor","middle").attr("x",-(O.top+i/2)).attr("y",v.left+q-9-9).attr("transform","rotate(-90)").text(h);const z=e=>{if(isNaN(e))return b;return(f||(0,o.m4Y)().range(m).domain([S,(S+C)/2,C]))(e)},X=R.bandwidth(),P=H.bandwidth();t.forEach((e,t)=>{const a=H(d[t])-O.top;e.forEach((e,t)=>{const r=R(n[t])-O.left;E.fillStyle=z(e),E.fillRect(r,a,X,P),N&&(E.strokeStyle=z(e),E.lineWidth=1,E.strokeRect(r,a,X,P))})});const B=e=>{const a=j.getBoundingClientRect(),r=e.clientX-a.left,o=e.clientY-a.top;let s=Math.floor(r/R.step()),l=Math.floor(o/H.step());const i=t[0].length-1;s<0&&(s=0),s>i&&(s=i);const c=t.length-1;l<0&&(l=0),l>c&&(l=c);const u=n[s],h=d[l];return{xIndex:s,yIndex:l,value:t[l][s],xAxisValue:u,yAxisValue:h}};let F;g&&(F=document.createElement("div"),Object.assign(F.style,{display:"none",position:"absolute",pointerEvents:"none",backgroundColor:"rgba( 0, 0, 0, 0.6 )",color:"lightgrey",padding:"8px",fontFamily:"sans-serif"}),e.appendChild(F),j.onmousemove=t=>{const n=B(t);F.innerText=g(n),F.style.display="inline-block";const{x:a,y:r}=(0,s.L)(e,F,{x:t.clientX,y:t.clientY},3);F.style.left=a+"px",F.style.top=r+"px"},j.onmouseleave=()=>{F.style.display="none"}),x&&(j.onmousedown=e=>{const t=B(e);x(t)}),V.current=F?[k,M,F]:[k,M];const G=()=>{Y({innerWidth:window.innerWidth,innerHeight:window.innerHeight})};return window.addEventListener("resize",G),()=>{window.removeEventListener("resize",G)}}),(0,l.jsx)("div",{className:A,style:A?void 0:{height:"600px",width:"600px"},children:(0,l.jsx)("div",{ref:L,id:"container",style:{position:"relative",width:"100%",height:"100%"}})})})},96463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(65043),r=n(89257),o=n(26494),s=n(8939),l=n(24056),i=n(85865),c=n(10939),d=n(14696),u=n(17545),h=(n(60676),n(58338)),p=n(29449),m=n(95747),f=n(32633),g=n(82746),x=n(70579);const y={triggerOnce:!0,rootMargin:"100px"},v=()=>{const{accessionAndMdNumber:e,topology:t,inchikeyReferences:n}=(0,a.useContext)(p.f),[v,A]=(0,r.Wx)(y),b=(0,a.useRef)(null),w=t&&t.defaultRepresentations,{loading:_,payload:N,error:j}=(0,h.A)("".concat(m.nP,"/").concat(e,"/analyses/lipid-inter/")),[M,C]=(0,a.useState)(null),[S,E]=(0,a.useState)(null),k=(0,a.useRef)({}),R=(0,a.useRef)({}),L=(0,a.useMemo)(()=>N&&N.data?Object.keys(N.data).filter(e=>"residue_indices"!==e):[],[N]);(0,a.useMemo)(()=>{L.length&&!M&&C(L[0]),R.current=L.reduce((e,t)=>(e[t]=Math.max(...N.data[t]),e),{}),R.current=Math.max(...Object.values(R.current))},[L,M]);const V=(0,a.useMemo)(()=>L.length&&n?L.reduce((e,t)=>{const a=n.find(e=>e.inchikey===t);let r,o,s;return a.lipidmaps.synonyms?(r=a.lipidmaps.name,o=a.lipidmaps.synonyms.split("; ").sort((e,t)=>e.length-t.length)[0],s=a.lipidmaps.sys_name):a.swisslipids.synonyms&&(r=o=a.swisslipids.synonyms.find(e=>"abbreviation"===e.type).name,s=a.swisslipids.entity_name),console.log("lipid",t,"name",r,"shortName",o,"longName",s),e[t]={name:r,shortName:o,longName:s},e},{}):{},[L,n]),Y=(0,a.useMemo)(()=>L.length&&t?L.reduce((e,n)=>{const a=t.getReferenceResidueIndices(n),r="( @".concat(t.residue2atomIndices(a).join(",")," )");return e[n]=r,e},{}):{},[L,t]),I=e=>N&&N.data&&e?g.hD.addScheme(function(t){this.atomColor=function(t){const n=N.data.residue_indices.indexOf(t.residueIndex);if(-1===n)return 16777215;const a=N.data[e][n],r=Math.sqrt(a/R.current);let o,s;return r<.5?(o=255-Math.floor(128*r*2),s=255-Math.floor(255*r*2)):(o=127-Math.floor(127*(r-.5)*2),s=0),255<<16|o<<8|s}},e):null;return(0,a.useEffect)(()=>{if(!w||0===w.length||!M)return;w.forEach(e=>{var t;e.name.toLowerCase().includes("protein")?(e.color="custom",e.type="spacefill",e.color=(t=M,k.current[t]||(k.current[t]=I(t)),k.current[t]),e.customScheme=M):e.name.toLowerCase().includes("lipid")&&(e.color="grey",e.opacity=.1)});const e={name:M,type:"licorice",color:"orange",opacity:.3,selection:Y[M]};E([...w,e])},[M,w]),_?(0,x.jsx)(u.A,{}):j?j.toString():N?(0,x.jsxs)(a.Suspense,{fallback:(0,x.jsx)(u.A,{}),children:[(0,x.jsx)(c.A,{className:f.default.card,children:(0,x.jsx)(o.A,{children:(0,x.jsx)(s.A,{value:M,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:(e,t)=>{C(t)},className:f.default.tabs,children:L.map(e=>V[e]&&(0,x.jsx)(l.A,{value:e,label:(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,x.jsx)("span",{title:"".concat(V[e].longName),children:V[e].name}),V[e].shortName!==V[e].name&&(0,x.jsx)(i.A,{variant:"caption",color:"text.secondary",title:"".concat(V[e].longName),children:V[e].shortName})]})},e))})})}),(0,x.jsx)(c.A,{className:f.default.nglcard,ref:v,children:A?(0,x.jsx)(d.default,{className:f.default.container,representationsState:[S,E],ref:b,rotateX:!0}):(0,x.jsx)("div",{style:{height:"50vh"}})})]}):"Something bad happened with Lipid Interactions analysis"}}}]);
//# sourceMappingURL=6463.a3bb4794.chunk.js.map