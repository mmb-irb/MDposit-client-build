{"version":3,"file":"static/js/942.244d99e0.chunk.js","mappings":"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","sources":["webpack://mdposit/./src/components/interaction-selector/style.module.css?5392","components/interaction-selector/index.js","webpack://mdposit/./src/components/viewer-spawner/style.module.css?df6e","components/viewer-spawner/index.js","pages/accession/dist-perres/index.js","webpack://mdposit/./src/pages/accession/dist-perres/style.module.css?77de"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"horizontal\":\"style_horizontal__2DIWx\",\"horizontal-margined\":\"style_horizontal-margined__e9fQR\"};","import React, { Suspense } from 'react';\n\nimport {\n  FormControlLabel,\n  Radio,\n  RadioGroup,\n  Select,\n  MenuItem,\n  TextField,\n  IconButton,\n} from '@mui/material';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faExchangeAlt } from '@fortawesome/free-solid-svg-icons';\n\nimport Loading from '../loading';\n\nimport style from './style.module.css';\n\nconst residueOptions = [\n  { label: 'All residues', value: 'residue_indices' },\n  { label: 'Interface residues', value: 'interface_indices' },\n];\n\n// Render a panel which allows to select the desired interaction\n// If the user selects a new interaction then the 'setSelectedInteraction' is set as its index\n// Interactions have the following structure:\n// { name: string, label: string, ... }\n// The 'label' field will replace the 'name' in the selector labels if exists\n// When 'selectedResidues' is passed, render also tools to select interaction residues\n// Residue options are 'all' or 'interface' residues\n// DANI: La guinda sería un 'custom' en las opciones de residuos\n// DANI: La idea sería desplegar dos residue selectors, uno para cada interaction agent\nconst InteractionSelector = ({\n  interactions,\n  selectedInteraction,\n  setSelectedInteraction,\n  selectedResidues,\n  setSelectedResidues,\n  selectedOrder,\n  handleToggleOrder,\n  firstOrderLabel, // The label to be represented over the first order rectangle\n  firstOrderTooltip, // The tooltip to be shown for the first order rectangle\n  secondOrderLabel, // The label to be represented over the second order rectangle\n  secondOrderTooltip, // The tooltip to be shown for the second order rectangle\n  toggleOrderTooltip, // The tooltip to be shown for the toggle order button\n  interfaceOnly = false, // Set if the 'All residues' button is enabled\n}) => {\n  const changeInteraction = event => {\n    setSelectedInteraction(event.target.value);\n  };\n\n  const changeResidues = event => {\n    setSelectedResidues(event.target.value);\n  };\n\n  const changeOrder = () => {\n    handleToggleOrder();\n  };\n\n  const currentInteraction = interactions[selectedInteraction];\n\n  // Render\n  return (\n    <Suspense fallback={<Loading />}>\n      <Select\n        value={selectedInteraction}\n        onChange={changeInteraction}\n        className={style['horizontal-margined']}\n      >\n        {interactions.map((interaction, i) => (\n          <MenuItem key={i} value={i} disabled={interaction.failed}>\n            {interaction.label || interaction.name}\n          </MenuItem>\n        ))}\n      </Select>\n      {selectedResidues && (\n        <RadioGroup\n          value={selectedResidues}\n          onChange={changeResidues}\n          className={style.horizontal}\n        >\n          {residueOptions.map((opt, i) => (\n            <FormControlLabel\n              key={i}\n              value={opt.value}\n              control={<Radio color=\"primary\" />}\n              label={opt.label}\n              disabled={opt.label === 'All residues' && interfaceOnly}\n            />\n          ))}\n        </RadioGroup>\n      )}\n      {selectedOrder !== undefined && (\n        <>\n          <TextField\n            //margin=\"dense\"\n            label={firstOrderLabel}\n            title={firstOrderTooltip}\n            value={\n              selectedOrder\n                ? currentInteraction.agent_1\n                : currentInteraction.agent_2\n            }\n          />\n          <IconButton\n            title={toggleOrderTooltip}\n            onClick={changeOrder}\n            size=\"large\"\n          >\n            <FontAwesomeIcon icon={faExchangeAlt} />\n          </IconButton>\n          <TextField\n            //margin=\"dense\"\n            label={secondOrderLabel}\n            title={secondOrderTooltip}\n            value={\n              selectedOrder\n                ? currentInteraction.agent_2\n                : currentInteraction.agent_1\n            }\n          />\n        </>\n      )}\n    </Suspense>\n  );\n};\n\nexport default InteractionSelector;\n","// extracted by mini-css-extract-plugin\nexport default {\"rnd\":\"style_rnd__Txifm\",\"floating-card\":\"style_floating-card__HHpby\"};","import React, { lazy, Suspense, useRef, useState } from 'react';\n\n// Rnd is the resizable and draggable system where the ngl viewer is placed\nimport { Rnd } from 'react-rnd';\n\nimport Card from '../animated-card';\n\nimport style from './style.module.css';\n\nconst ViewerWithControls = lazy(() =>\n  import(\n    /* webpackChunkName: 'viewer-with-controls' */ '../viewer-with-controls'\n  ),\n);\n\n// Minimal ngl window height\nconst MIN_NGL_DIMENSION = 150;\n\n// Counter to get always the maximum zIndex\n// This is useful to set a new or currently dragged/resized ngl window over the others\nlet maxZ = 0;\nconst nextZ = () => {\n  maxZ += 1;\n  return maxZ;\n};\n\n// This function spawns all the NGL viewers needed\n// i.e. one viewer with the requested 'props' and all previous viewers which have been nailed\nconst ViewerSpawner = ({ newViewer, nailing = true, onNail, onClose }) => {\n  // Store here all nailed NGL viewers\n  const [nailedViewers, setNailedViewers] = useState([]);\n\n  // Set the viewers as the nailed viewers and the new viewer\n  const viewers = [...nailedViewers];\n\n  // Keep listed all arrays which have been used (i.e. ngl viewers which have been nailed or closed)\n  const usedIds = useRef([]);\n\n  if (newViewer) {\n    // Find a new suitable Id that meet 2 conditions:\n    // - There is never 2 viewers with the same id, so we avoid errors\n    // - If we pick diferent frames in the graph without nailing anything, the current viewer has always the same id\n    // (This way the current viewer does not appear in the origin position every time)\n    const getNewId = () => {\n      let id = 0;\n      while (id < 999) {\n        if (usedIds.current.indexOf(id) === -1) return id;\n        id += 1;\n      }\n      console.error('Maximum number of viewers reached');\n    };\n\n    // Set a unique id for this props based in the last nailed viewer\n    newViewer.id = getNewId();\n    newViewer.close = () => {\n      if (nailing) {\n        setNailedViewers(nailed => {\n          const newNailed = [...nailed];\n          const index = nailed.indexOf(newViewer);\n          if (index !== -1) newNailed.splice(index, 1);\n          return newNailed;\n        });\n      }\n      if (onClose) onClose(newViewer);\n      usedIds.current.push(newViewer.id);\n    };\n    // If the nailer function is passed, add the logic for the viewer to be nailed further\n    if (nailing)\n      newViewer.nail = () => {\n        setNailedViewers(nailed => [...nailed, newViewer]);\n        if (onNail) onNail(newViewer);\n        usedIds.current.push(newViewer.id);\n      };\n    // Add the current viewer to the viewers list\n    viewers.push(newViewer);\n  }\n\n  // Render a viewer for each prop. Use the 'selected' parameter as unique id\n  return viewers.map(viewer => <NGLViewerInDND key={viewer.id} {...viewer} />);\n};\n\n// This component render a small NGL viewer\n// It is called when user clicks in a point in the projections component\n// Also it is called by the generic analysis page\nconst NGLViewerInDND = props => {\n  // Set a reference for the viewer\n  // If a reference is passed among the viewer arguments then use it instead\n  const viewerRef = props.viewerRef || useRef(null);\n\n  // Set the default position and size\n  const [place, setPlace] = useState(() => {\n    // Set an extra margin\n    const MARGIN = 20;\n    // Get the screen pixel sizes and vertical scroll position\n    const { innerWidth, innerHeight, scrollY } = window;\n    // The spawned elements are parented to the 'main' element, not to the 'body'\n    // We have to take this in count, since the header adds an extra offset in vertical position\n    const offsetHeight = document.querySelector('main').offsetTop;\n    // Set a reasonable dimension for the ngl window\n    const dimension = Math.max(\n      Math.min(innerWidth / 4, innerHeight / 4),\n      MIN_NGL_DIMENSION,\n    );\n    const reasonableHeight = 1.5 * dimension;\n    const reasonableWidth = 2 * dimension;\n    return {\n      // WARNING: If you set the width as 'auto' the window stays very wide when exiting fullscreen\n      width: reasonableWidth, // Let the Rnd logic set the width automatically\n      height: reasonableHeight, // Reasonable height\n      x: 0, // Left border\n      y: innerHeight - offsetHeight - reasonableHeight - MARGIN + scrollY, // Bottom border\n    };\n  });\n\n  return (\n    // Rnd is the draggable and resizable system where the ngl viewer is placed\n    <Rnd\n      position={{ x: place.x, y: place.y }}\n      size={{ width: place.width, height: place.height }}\n      // Update the zIndex to make this window the first visible\n      style={{ zIndex: nextZ() }}\n      className={style.rnd}\n      data-rnd\n      // Limits where the window can be dragged/resized to\n      // WARNING: bounds=\"main\" is problematic since the window may appear out of bounds\n      // WARNING: Then when it is moved for the first time it jumps inside the bonds, not elegant\n      bounds=\"window\"\n      // Prevent the mouse to drag/resize the window when it is over specific elements\n      cancel=\"canvas, [data-popover], #preventDragSize, .prevent-drag\"\n      // On drag/resize starts we do not change anything, but use the hook to re-render this component\n      // The Z Index is updated and the selected window becomes the first in the z axis automatically\n      // WARNING: Drag functions are also called when you just click (e.g. clicking buttons)\n      onDragStart={() => {\n        setPlace({ ...place });\n      }}\n      onResizeStart={() => {\n        setPlace({ ...place });\n      }}\n      onDragStop={(e, d) => {\n        // Use this to reject some bugged event calls: e.g. the frames number selector\n        if (e.layerX === 0 && e.layerY === 0) return;\n        // We re-render only if the new position does not equal the old position\n        if (place.x !== d.x || place.y !== d.y)\n          setPlace({\n            ...place,\n            x: d.x,\n            y: d.y,\n          });\n      }}\n      // Re-adapt the viewer and update the position/size when the window is resized\n      onResize={() => viewerRef.current && viewerRef.current.autoResize()}\n      onResizeStop={(e, direction, ref, delta, position) => {\n        setPlace({\n          width: ref.style.width,\n          height: ref.style.height,\n          ...position,\n        });\n        // if (!viewerRef.current) return;\n        // viewerRef.current.autoResize();\n        // viewerRef.current.autoResize.flush();\n      }}\n    >\n      <Card className={style['floating-card']} elevation={4}>\n        <Suspense fallback={null}>\n          <ViewerWithControls\n            className={style['floating-card']}\n            ref={viewerRef}\n            startsPlaying={false}\n            {...props}\n          />\n        </Suspense>\n      </Card>\n    </Rnd>\n  );\n};\n\nexport default ViewerSpawner;\n","import React, { useContext, useState, useMemo, useCallback } from 'react';\n\nimport { CardContent, Tabs, Tab, Typography } from '@mui/material';\n\nimport useAPI from '../../../hooks/use-api';\n\nimport Card from '../../../components/animated-card';\nimport Loading from '../../../components/loading';\nimport ViewerSpawner from '../../../components/viewer-spawner';\n\nimport { ProjectCtx } from '../../../contexts';\n\nimport { BASE_PATH_PROJECTS } from '../../../utils/constants';\n\n//import Selector from '../../../components/selector';\nimport InteractionSelector from '../../../components/interaction-selector';\nimport Heatmap from '../../../components/heatmap';\n\nimport style from './style.module.css';\n\n// Set the heatmap minimum and maximum colors\nconst heatmapMinimumColor = { r: 0, g: 0, b: 255 };\nconst heatmapMaximumColor = { r: 255, g: 0, b: 0 };\n\n// Distance per residue analysis\nconst DistPerres = () => {\n  // Get the current project data\n  const { accessionAndMdNumber, topology, interactions } = useContext(ProjectCtx);\n\n  // The interaction to be displayed\n  const [selectedInteraction, setSelectedInteraction] = useState(0);\n\n  // The interaction residues to be displayed\n  // May be all 'residue_indices' or only the 'interface_indices'\n  const [selectedResidues, setSelectedResidues] = useState('interface_indices');\n\n  // The selected heatmap residues\n  const [selected, setSelected] = useState(null);\n\n  // The graphic to be displayed ('mean' or 'stdv')\n  const [display, setDisplay] = useState('mean');\n\n  // Set the API url for the heatmap data\n  const url = `${BASE_PATH_PROJECTS}/${accessionAndMdNumber}/analyses/dist-perres/`;\n\n  const { loading, payload, error } = useAPI(url);\n\n  // Filter data by selected residues\n  const {\n    heatmapData,\n    residuesX,\n    residuesY,\n    xTitle,\n    yTitle,\n    isReduced,\n  } = useMemo(() => {\n    // Return if the payload is not ready\n    if (loading || error || !payload || !topology || !interactions) return {};\n\n    // Get the selected interaction\n    const interaction = interactions[selectedInteraction];\n\n    // Get the data whose name matches the interaction name\n    const data = payload.data.find(dataset => {\n      return dataset.name === interaction.name;\n    });\n\n    // Set the data to be displayed\n    const displayedData = display === 'mean' ? data.means : data.stdvs;\n\n    // Find out if the analysis contains data for all residues or just the interface residues\n    // It may happen in large interactions that only interface residues are saved in order to reduce data size\n    // WARNING: We must check both data dimensions\n    // WARNING: it may happen that one agent has the same number of total and interface residues\n    let isReduced;\n    const xDim = displayedData[0].length;\n    const yDim = displayedData.length;\n    if (\n      yDim === interaction['residue_indices_2'].length &&\n      xDim === interaction['residue_indices_1'].length\n    )\n      isReduced = false;\n    else if (\n      yDim === interaction['interface_indices_2'].length &&\n      xDim === interaction['interface_indices_1'].length\n    )\n      isReduced = true;\n    else\n      throw new Error(\n        `The numbers of values in data does not match any number of residues in the interaction (neither all or interface)`,\n      );\n\n    // Select the interaction residues whosa data is to be represented in the heatmap\n    const residuesX = interaction[selectedResidues + '_1'];\n    const residuesY = interaction[selectedResidues + '_2'];\n\n    // Set data to be represented in the heatmap\n    let filteredData = [];\n    // If we have a reduced dataset\n    if (isReduced) {\n      // If interface residues are requested then we return the whole dataset\n      if (selectedResidues === 'interface_indices') {\n        filteredData = displayedData;\n      }\n      // If all residues are requested then we must build a new matrix and fill the gaps with 'null' values\n      // WARNING: Although this has been programmed, the button tu do this should be disabled from the client\n      // WARNING: This code is functional but it should never be called or you may run out of memory\n      // WARNING: If you allow to represent a whole heatmap for a reduced analysis you may be trying to build a huge heatmap\n      else {\n        const interfaceResiduesX = interaction['interface_indices_1'];\n        const interfaceResiduesY = interaction['interface_indices_2'];\n        for (const y of residuesY) {\n          const yIndex = interfaceResiduesY.indexOf(y);\n          let newRow;\n          // If the index is not in the interface then the whole row is full of nulls\n          if (yIndex === -1) {\n            const XResiduesCount = residuesX.length;\n            newRow = new Array(XResiduesCount).fill(10);\n            filteredData.push(newRow);\n            continue;\n          }\n          // Otherwise, we must check each column value\n          newRow = [];\n          for (const x of residuesX) {\n            const xIndex = interfaceResiduesX.indexOf(x);\n            if (xIndex === -1) {\n              newRow.push(10);\n              continue;\n            }\n            newRow.push(displayedData[yIndex][xIndex]);\n          }\n          filteredData.push(newRow);\n        }\n      }\n    }\n    // If we have the full dataset\n    else {\n      // If all residues are requested then we return all data\n      if (selectedResidues === 'residue_indices') {\n        filteredData = displayedData;\n      }\n      // If interface residues are requested then we must filter interface resdiues only\n      else {\n        const allResiduesX = interaction['residue_indices_1'];\n        const allResiduesY = interaction['residue_indices_2'];\n        for (const y of residuesY) {\n          const yIndex = allResiduesY.indexOf(y);\n          const newRow = [];\n          for (const x of residuesX) {\n            const xIndex = allResiduesX.indexOf(x);\n            newRow.push(displayedData[yIndex][xIndex]);\n          }\n          filteredData.push(newRow);\n        }\n      }\n    }\n\n    // Convert the residues from topology numeration to standard numeration to use them as labels\n    const [xLabels, yLabels] = [residuesX, residuesY].map(residueIndices =>\n      residueIndices.map(residueIndex => topology.getResidueByIndex(residueIndex).standardLabel),\n    );\n\n    // Get the titles from the interaction data\n    const xTitle = interaction['agent_1'];\n    const yTitle = interaction['agent_2'];\n\n    // Get the object to be passed to the heatmap as input\n    const heatmapData = { data: filteredData, xLabels, yLabels };\n\n    return {\n      heatmapData,\n      residuesX,\n      residuesY,\n      xTitle,\n      yTitle,\n      isReduced,\n    };\n  }, [\n    loading,\n    error,\n    payload,\n    topology,\n    interactions,\n    selectedInteraction,\n    selectedResidues,\n    display,\n  ]);\n\n  // Transform the raw reside tag to source numeration\n  // Also retrieve the residue index, since it is used to ask for the distance representation\n  // http://nglviewer.org/ngl/api/class/src/representation/distance-representation.js~DistanceRepresentation.html\n  const parseResidue = useCallback(\n    residueIndex => {\n      // Set the numeration\n      const residue = topology.getResidueByIndex(residueIndex);\n      return {\n        forResidue: residueIndex,\n        // We must check the residue has an alpha carbon\n        // If not, there is no atom to use a distance reference, so return null\n        forDistance: residue.hasCAlpha\n          ? residue.number.toString() + ':' + residue.chainName + '.CA'\n          : null,\n      };\n    },\n    [topology],\n  );\n\n  // Memoize heatmap handler functions\n  const handleHeatmapTooltip = useCallback(\n    ({ value, xAxisValue, yAxisValue }) =>\n      xAxisValue +\n      ' - ' +\n      yAxisValue +\n      '\\n' +\n      Math.round(value * 100) / 100 +\n      ' Å',\n    [],\n  );\n  const handleHeatmapClick = useCallback(\n    ({ xIndex, yIndex }) => {\n      const px = parseResidue(residuesX[xIndex]);\n      const py = parseResidue(residuesY[yIndex]);\n      setSelected({\n        residues: [px.forResidue, py.forResidue],\n        // There is no values \"for distance\" when any residues has no alpha carbon\n        distance: px.forDistance &&\n          py.forDistance && [[px.forDistance, py.forDistance]],\n      });\n    },\n    [residuesX, residuesY, parseResidue],\n  );\n\n  // Render loading or error messages according with the API response\n  if (loading) return <Loading />;\n  else if (error) return error.toString();\n  else if (!payload) return 'Something bad happened';\n\n  if (!topology || !interactions) return <Loading />;\n\n  // Handles when the tabs are switched\n  const handleTabs = (event, newValue) => {\n    setDisplay(newValue);\n  };\n\n  // Render\n  return (\n    <>\n      <Card>\n        <CardContent className={style.horizontal}>\n          <Typography variant=\"h6\">Residues selection:</Typography>\n          <InteractionSelector\n            interactions={interactions}\n            selectedInteraction={selectedInteraction}\n            setSelectedInteraction={setSelectedInteraction}\n            selectedResidues={selectedResidues}\n            setSelectedResidues={setSelectedResidues}\n            interfaceOnly={isReduced}\n          />\n        </CardContent>\n      </Card>\n      <Card className={style.margined} id=\"heatmap\">\n        <CardContent>\n          <Tabs\n            value={display}\n            variant=\"fullWidth\"\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            onChange={handleTabs}\n            className={style['margined-bottom']}\n          >\n            <Tab\n              value={'mean'}\n              label=\"Residues distance averages\"\n              //className={style['disabled-tab']}\n            />\n            <Tab value={'stdv'} label=\"Residues distance standard deviations\" />\n          </Tabs>\n          <Heatmap\n            inputData={heatmapData}\n            onTooltip={handleHeatmapTooltip}\n            onClick={handleHeatmapClick}\n            legendTitle={\n              display === 'mean'\n                ? 'Distance average (Å)'\n                : 'Distance standard deviation (Å)'\n            }\n            // Invert colors here, since minimum values belong to closer residues\n            maxValueColor={heatmapMinimumColor}\n            minValueColor={heatmapMaximumColor}\n            totalHeight={heatmapData.yLabels.length === 1 ? 30 : undefined}\n            xTitle={xTitle}\n            yTitle={yTitle}\n          />\n        </CardContent>\n      </Card>\n      <ViewerSpawner\n        // Set the new viewer or null if there is not a proper \"selected\" value\n        newViewer={\n          selected\n            ? {\n                selectedResidueIndices: selected.residues,\n                // WARNING: Distance is not always available\n                // This only works when both residues have alpha carbon\n                // (i.e. both are protein residues)\n                selectedDistances: selected.distance,\n              }\n            : null\n        }\n        // If the nailed/closed viewer is the current viewer then reset the 'selected'\n        onNail={viewer =>\n          setSelected(previous => {\n            if (previous && previous.residues === viewer.selectedResidueIndices)\n              return null;\n            else return previous;\n          })\n        }\n        onClose={viewer =>\n          setSelected(previous => {\n            if (previous && previous.residues === viewer.selectedResidueIndices)\n              return null;\n            else return previous;\n          })\n        }\n      />\n    </>\n  );\n};\n\nexport default DistPerres;\n","// extracted by mini-css-extract-plugin\nexport default {\"margined\":\"style_margined__JbZJ6\",\"margined-bottom\":\"style_margined-bottom__WRBwE\",\"horizontal\":\"style_horizontal__NH+ZS\"};"],"names":["residueOptions","label","value","_ref","interactions","selectedInteraction","setSelectedInteraction","selectedResidues","setSelectedResidues","selectedOrder","handleToggleOrder","firstOrderLabel","firstOrderTooltip","secondOrderLabel","secondOrderTooltip","toggleOrderTooltip","interfaceOnly","currentInteraction","_jsxs","Suspense","fallback","_jsx","Loading","children","Select","onChange","event","target","className","style","map","interaction","i","MenuItem","disabled","failed","name","RadioGroup","opt","FormControlLabel","control","Radio","color","undefined","_Fragment","TextField","title","agent_1","agent_2","IconButton","onClick","changeOrder","size","FontAwesomeIcon","icon","faExchangeAlt","ViewerWithControls","lazy","maxZ","NGLViewerInDND","props","viewerRef","useRef","place","setPlace","useState","innerWidth","innerHeight","scrollY","window","offsetHeight","document","querySelector","offsetTop","dimension","Math","max","min","reasonableHeight","width","height","x","y","Rnd","position","zIndex","bounds","cancel","onDragStart","onResizeStart","onDragStop","e","d","layerX","layerY","onResize","current","autoResize","onResizeStop","direction","ref","delta","Card","elevation","startsPlaying","newViewer","nailing","onNail","onClose","nailedViewers","setNailedViewers","viewers","usedIds","getNewId","id","indexOf","console","error","close","nailed","newNailed","index","splice","push","nail","viewer","heatmapMinimumColor","r","g","b","heatmapMaximumColor","DistPerres","accessionAndMdNumber","topology","useContext","ProjectCtx","selected","setSelected","display","setDisplay","url","BASE_PATH_PROJECTS","loading","payload","useAPI","heatmapData","residuesX","residuesY","xTitle","yTitle","isReduced","useMemo","data","find","dataset","displayedData","means","stdvs","xDim","length","yDim","Error","filteredData","interfaceResiduesX","interfaceResiduesY","yIndex","newRow","xIndex","XResiduesCount","Array","fill","allResiduesX","allResiduesY","xLabels","yLabels","residueIndices","residueIndex","getResidueByIndex","standardLabel","parseResidue","useCallback","residue","forResidue","forDistance","hasCAlpha","number","toString","chainName","handleHeatmapTooltip","xAxisValue","yAxisValue","round","handleHeatmapClick","_ref2","px","py","residues","distance","CardContent","horizontal","Typography","variant","InteractionSelector","margined","Tabs","indicatorColor","textColor","handleTabs","newValue","Tab","Heatmap","inputData","onTooltip","legendTitle","maxValueColor","minValueColor","totalHeight","ViewerSpawner","selectedResidueIndices","selectedDistances","previous"],"sourceRoot":""}