"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[942,8870],{507:(e,t,n)=>{n.d(t,{A:()=>p});var s=n(65043),a=n(2260),i=n(32143),r=n(57972),l=n(83558),d=n(14256),o=n(67784),c=n(17392),u=n(92127),h=n(12639),f=n(17545);const m="style_horizontal__2DIWx",x="style_horizontal-margined__e9fQR";var g=n(70579);const _=[{label:"All residues",value:"residue_indices"},{label:"Interface residues",value:"interface_indices"}],p=e=>{let{interactions:t,selectedInteraction:n,setSelectedInteraction:p,selectedResidues:y,setSelectedResidues:b,selectedOrder:v,handleToggleOrder:A,firstOrderLabel:j,firstOrderTooltip:R,secondOrderLabel:S,secondOrderTooltip:w,toggleOrderTooltip:C,interfaceOnly:N=!1}=e;const T=t[n];return(0,g.jsxs)(s.Suspense,{fallback:(0,g.jsx)(f.A,{}),children:[(0,g.jsx)(a.A,{value:n,onChange:e=>{p(e.target.value)},className:x,children:t.map((e,t)=>(0,g.jsx)(i.A,{value:t,disabled:e.failed,children:e.label||e.name},t))}),y&&(0,g.jsx)(r.A,{value:y,onChange:e=>{b(e.target.value)},className:m,children:_.map((e,t)=>(0,g.jsx)(l.A,{value:e.value,control:(0,g.jsx)(d.A,{color:"primary"}),label:e.label,disabled:"All residues"===e.label&&N},t))}),void 0!==v&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.A,{label:j,title:R,value:v?T.agent_1:T.agent_2}),(0,g.jsx)(c.A,{title:C,onClick:()=>{A()},size:"large",children:(0,g.jsx)(u.g,{icon:h._qq})}),(0,g.jsx)(o.A,{label:S,title:w,value:v?T.agent_2:T.agent_1})]})]})}},34088:(e,t,n)=>{n.d(t,{A:()=>h});var s=n(65043),a=n(43126),i=n(10939);const r="style_rnd__Txifm",l="style_floating-card__HHpby";var d=n(70579);const o=(0,s.lazy)(()=>Promise.all([n.e(7784),n.e(8095),n.e(3845),n.e(9070),n.e(247),n.e(7955),n.e(8677),n.e(3471),n.e(335),n.e(9117)]).then(n.bind(n,14696)));let c=0;const u=e=>{const t=e.viewerRef||(0,s.useRef)(null),[n,u]=(0,s.useState)(()=>{const{innerWidth:e,innerHeight:t,scrollY:n}=window,s=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,t/4),150),i=1.5*a;return{width:2*a,height:i,x:0,y:t-s-i-20+n}});return(0,d.jsx)(a.p,{position:{x:n.x,y:n.y},size:{width:n.width,height:n.height},style:{zIndex:(c+=1,c)},className:r,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{u({...n})},onResizeStart:()=>{u({...n})},onDragStop:(e,t)=>{0===e.layerX&&0===e.layerY||n.x===t.x&&n.y===t.y||u({...n,x:t.x,y:t.y})},onResize:()=>t.current&&t.current.autoResize(),onResizeStop:(e,t,n,s,a)=>{u({width:n.style.width,height:n.style.height,...a})},children:(0,d.jsx)(i.A,{className:l,elevation:4,children:(0,d.jsx)(s.Suspense,{fallback:null,children:(0,d.jsx)(o,{className:l,ref:t,startsPlaying:!1,...e})})})})},h=e=>{let{newViewer:t,nailing:n=!0,onNail:a,onClose:i}=e;const[r,l]=(0,s.useState)([]),o=[...r],c=(0,s.useRef)([]);if(t){const e=()=>{let e=0;for(;e<999;){if(-1===c.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};t.id=e(),t.close=()=>{n&&l(e=>{const n=[...e],s=e.indexOf(t);return-1!==s&&n.splice(s,1),n}),i&&i(t),c.current.push(t.id)},n&&(t.nail=()=>{l(e=>[...e,t]),a&&a(t),c.current.push(t.id)}),o.push(t)}return o.map(e=>(0,d.jsx)(u,{...e},e.id))}},54519:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var s=n(65043),a=n(26494),i=n(85865),r=n(8939),l=n(24056),d=n(58338),o=n(66565),c=n(10939),u=n(17545),h=n(507),f=n(24310),m=n(34088),x=n(29449),g=n(95747),_=n(58870),p=n(70579);const y={r:0,g:0,b:255},b={r:255,g:0,b:0},v=()=>{const{accessionAndMdNumber:e,topology:t,interactions:n}=(0,s.useContext)(x.f),v=`${g.nP}/${e}/analyses`,A=`${v}/dist-perres`,{loading:j,payload:R,error:S}=(0,d.A)(A),[w,C]=(0,s.useState)(0),N=n&&n[w],{interactionName:T,analysisName:D}=(0,s.useMemo)(()=>{if(!N||!R)return{};if(void 0!==R.data)return{interactionName:N.name};const e=R.find(e=>e.name===N.name);return{interactionName:N.name,analysisName:e.analysis}},[N,R]),O=D?`${v}/${D}`:null,{loading:z,payload:I,error:k}=(0,d.A)(O),M=(0,o.A)(e=>{if(!R)return e;if(!(void 0!==R.data))return I||e;const t=R.data.find(e=>e.name===T);return t||{error:`Dataset for interaction "${T}" not found`}},[R,I,T]),[L,V]=(0,s.useState)("interface_indices"),[$,H]=(0,s.useState)("mean"),{heatmapData:q,residuesX:W,residuesY:Y,xTitle:B,yTitle:E,isReduced:J}=(0,s.useMemo)(()=>{if(!M||!t)return{};const e="mean"===$?M.means:M.stdvs;let n;const s=e[0].length,a=e.length;if(a===N.residue_indices_2.length&&s===N.residue_indices_1.length)n=!1;else{if(a!==N.interface_indices_2.length||s!==N.interface_indices_1.length)throw new Error("The numbers of values in data does not match any number of residues in the interaction (neither all or interface)");n=!0}const i=N[L+"_1"],r=N[L+"_2"];let l=[];if(n)if("interface_indices"===L)l=e;else{const t=N.interface_indices_1,n=N.interface_indices_2;for(const s of r){const a=n.indexOf(s);let r;if(-1===a){const e=i.length;r=new Array(e).fill(10),l.push(r);continue}r=[];for(const n of i){const s=t.indexOf(n);-1!==s?r.push(e[a][s]):r.push(10)}l.push(r)}}else if("residue_indices"===L)l=e;else{const t=N.residue_indices_1,n=N.residue_indices_2;for(const s of r){const a=n.indexOf(s),r=[];for(const n of i){const s=t.indexOf(n);r.push(e[a][s])}l.push(r)}}const[d,o]=[i,r].map(e=>e.map(e=>t.getResidueByIndex(e).standardLabel));return{heatmapData:{data:l,xLabels:d,yLabels:o},residuesX:i,residuesY:r,xTitle:N.agent_1,yTitle:N.agent_2,isReduced:n}},[M,t,L,$]),P=(0,s.useCallback)(e=>{const n=t.getResidueByIndex(e);return{forResidue:e,forDistance:n.hasCAlpha?n.number.toString()+":"+n.chainName+".CA":null}},[t]),[X,F]=(0,s.useState)(null),Z=(0,s.useCallback)(e=>{let{value:t,xAxisValue:n,yAxisValue:s}=e;return n+" - "+s+"\n"+Math.round(100*t)/100+" \xc5"},[]),Q=(0,s.useCallback)(e=>{let{xIndex:t,yIndex:n}=e;const s=P(W[t]),a=P(Y[n]);F({residues:[s.forResidue,a.forResidue],distance:s.forDistance&&a.forDistance&&[[s.forDistance,a.forDistance]]})},[W,Y,P]);if(S)return S.toString();if(k)return k.toString();if(M&&M.error)return M.error;if(!M)return j||z?(0,p.jsx)(u.A,{}):n?t?"Something bad happened with the analysis data":"There is no topology":"There are no interactions";return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.A,{children:(0,p.jsxs)(a.A,{className:_.default.horizontal,children:[(0,p.jsx)(i.A,{variant:"h6",children:"Residues selection:"}),(0,p.jsx)(h.A,{interactions:n,selectedInteraction:w,setSelectedInteraction:C,selectedResidues:L,setSelectedResidues:V,interfaceOnly:J})]})}),(0,p.jsx)("div",{className:j||z?_.default.disabled:_.default.enabled,children:(0,p.jsx)(c.A,{className:_.default.margined,id:"heatmap",children:(0,p.jsxs)(a.A,{children:[(0,p.jsxs)(r.A,{value:$,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:(e,t)=>{H(t)},className:_.default["margined-bottom"],children:[(0,p.jsx)(l.A,{value:"mean",label:"Residues distance averages"}),(0,p.jsx)(l.A,{value:"stdv",label:"Residues distance standard deviations"})]}),(0,p.jsx)(f.A,{inputData:q,onTooltip:Z,onClick:Q,legendTitle:"mean"===$?"Distance average (\xc5)":"Distance standard deviation (\xc5)",maxValueColor:y,minValueColor:b,totalHeight:1===q.yLabels.length?30:void 0,xTitle:B,yTitle:E})]})})}),(0,p.jsx)(m.A,{newViewer:X?{selectedResidueIndices:X.residues,selectedDistances:X.distance}:null,onNail:e=>F(t=>t&&t.residues===e.selectedResidueIndices?null:t),onClose:e=>F(t=>t&&t.residues===e.selectedResidueIndices?null:t)})]})}},58870:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});const s={margined:"style_margined__JbZJ6","margined-bottom":"style_margined-bottom__WRBwE",horizontal:"style_horizontal__NH+ZS",enabled:"style_enabled__4JqEL",disabled:"style_disabled__39iRt"}},66565:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(65043);const a=(e,t)=>{const n=(0,s.useRef)(),a=(0,s.useMemo)(()=>e(n.current),t);return n.current=a,a}}}]);
//# sourceMappingURL=942.a38ff42d.chunk.js.map