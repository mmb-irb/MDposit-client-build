"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[942,8870],{507:(e,t,n)=>{n.d(t,{A:()=>p});var s=n(65043),a=n(2260),i=n(32143),r=n(57972),l=n(83558),d=n(14256),o=n(67784),c=n(17392),u=n(92127),h=n(12639),f=n(17545);const m="style_horizontal__2DIWx",x="style_horizontal-margined__e9fQR";var g=n(70579);const _=[{label:"All residues",value:"residue_indices"},{label:"Interface residues",value:"interface_indices"}],p=e=>{let{interactions:t,selectedInteraction:n,setSelectedInteraction:p,selectedResidues:y,setSelectedResidues:b,selectedOrder:A,handleToggleOrder:v,firstOrderLabel:j,firstOrderTooltip:R,secondOrderLabel:S,secondOrderTooltip:w,toggleOrderTooltip:C,interfaceOnly:N=!1}=e;const T=t[n];return(0,g.jsxs)(s.Suspense,{fallback:(0,g.jsx)(f.A,{}),children:[(0,g.jsx)(a.A,{value:n,onChange:e=>{p(e.target.value)},className:x,children:t.map((e,t)=>(0,g.jsx)(i.A,{value:t,disabled:e.failed,children:e.label||e.name},t))}),y&&(0,g.jsx)(r.A,{value:y,onChange:e=>{b(e.target.value)},className:m,children:_.map((e,t)=>(0,g.jsx)(l.A,{value:e.value,control:(0,g.jsx)(d.A,{color:"primary"}),label:e.label,disabled:"All residues"===e.label&&N},t))}),void 0!==A&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o.A,{label:j,title:R,value:A?T.agent_1:T.agent_2}),(0,g.jsx)(c.A,{title:C,onClick:()=>{v()},size:"large",children:(0,g.jsx)(u.g,{icon:h._qq})}),(0,g.jsx)(o.A,{label:S,title:w,value:A?T.agent_2:T.agent_1})]})]})}},34088:(e,t,n)=>{n.d(t,{A:()=>f});var s=n(89379),a=n(65043),i=n(43126),r=n(10939);const l="style_rnd__Txifm",d="style_floating-card__HHpby";var o=n(70579);const c=(0,a.lazy)(()=>Promise.all([n.e(7784),n.e(8095),n.e(3845),n.e(9070),n.e(247),n.e(7955),n.e(8677),n.e(4061),n.e(335),n.e(9117)]).then(n.bind(n,14696)));let u=0;const h=e=>{const t=e.viewerRef||(0,a.useRef)(null),[n,h]=(0,a.useState)(()=>{const{innerWidth:e,innerHeight:t,scrollY:n}=window,s=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,t/4),150),i=1.5*a;return{width:2*a,height:i,x:0,y:t-s-i-20+n}});return(0,o.jsx)(i.p,{position:{x:n.x,y:n.y},size:{width:n.width,height:n.height},style:{zIndex:(u+=1,u)},className:l,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{h((0,s.A)({},n))},onResizeStart:()=>{h((0,s.A)({},n))},onDragStop:(e,t)=>{0===e.layerX&&0===e.layerY||n.x===t.x&&n.y===t.y||h((0,s.A)((0,s.A)({},n),{},{x:t.x,y:t.y}))},onResize:()=>t.current&&t.current.autoResize(),onResizeStop:(e,t,n,a,i)=>{h((0,s.A)({width:n.style.width,height:n.style.height},i))},children:(0,o.jsx)(r.A,{className:d,elevation:4,children:(0,o.jsx)(a.Suspense,{fallback:null,children:(0,o.jsx)(c,(0,s.A)({className:d,ref:t,startsPlaying:!1},e))})})})},f=e=>{let{newViewer:t,nailing:n=!0,onNail:i,onClose:r}=e;const[l,d]=(0,a.useState)([]),c=[...l],u=(0,a.useRef)([]);if(t){const e=()=>{let e=0;for(;e<999;){if(-1===u.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};t.id=e(),t.close=()=>{n&&d(e=>{const n=[...e],s=e.indexOf(t);return-1!==s&&n.splice(s,1),n}),r&&r(t),u.current.push(t.id)},n&&(t.nail=()=>{d(e=>[...e,t]),i&&i(t),u.current.push(t.id)}),c.push(t)}return c.map(e=>(0,o.jsx)(h,(0,s.A)({},e),e.id))}},54519:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var s=n(65043),a=n(26494),i=n(85865),r=n(8939),l=n(24056),d=n(58338),o=n(66565),c=n(10939),u=n(17545),h=n(507),f=n(24310),m=n(34088),x=n(29449),g=n(95747),_=n(58870),p=n(70579);const y={r:0,g:0,b:255},b={r:255,g:0,b:0},A=()=>{const{accessionAndMdNumber:e,topology:t,interactions:n}=(0,s.useContext)(x.f),A="".concat(g.nP,"/").concat(e,"/analyses"),v="".concat(A,"/dist-perres"),{loading:j,payload:R,error:S}=(0,d.A)(v),[w,C]=(0,s.useState)(0),N=n&&n[w],{interactionName:T,analysisName:D}=(0,s.useMemo)(()=>{if(!N||!R)return{};if(void 0!==R.data)return{interactionName:N.name};const e=R.find(e=>e.name===N.name);return{interactionName:N.name,analysisName:e.analysis}},[N,R]),O=D?"".concat(A,"/").concat(D):null,{loading:z,payload:I,error:k}=(0,d.A)(O),M=(0,o.A)(e=>{if(!R)return e;if(!(void 0!==R.data))return I||e;const t=R.data.find(e=>e.name===T);return t||{error:'Dataset for interaction "'.concat(T,'" not found')}},[R,I,T]),[L,V]=(0,s.useState)("interface_indices"),[H,q]=(0,s.useState)("mean"),{heatmapData:W,residuesX:Y,residuesY:B,xTitle:E,yTitle:J,isReduced:P}=(0,s.useMemo)(()=>{if(!M||!t)return{};const e="mean"===H?M.means:M.stdvs;let n;const s=e[0].length,a=e.length;if(a===N.residue_indices_2.length&&s===N.residue_indices_1.length)n=!1;else{if(a!==N.interface_indices_2.length||s!==N.interface_indices_1.length)throw new Error("The numbers of values in data does not match any number of residues in the interaction (neither all or interface)");n=!0}const i=N[L+"_1"],r=N[L+"_2"];let l=[];if(n)if("interface_indices"===L)l=e;else{const t=N.interface_indices_1,n=N.interface_indices_2;for(const s of r){const a=n.indexOf(s);let r;if(-1===a){const e=i.length;r=new Array(e).fill(10),l.push(r);continue}r=[];for(const n of i){const s=t.indexOf(n);-1!==s?r.push(e[a][s]):r.push(10)}l.push(r)}}else if("residue_indices"===L)l=e;else{const t=N.residue_indices_1,n=N.residue_indices_2;for(const s of r){const a=n.indexOf(s),r=[];for(const n of i){const s=t.indexOf(n);r.push(e[a][s])}l.push(r)}}const[d,o]=[i,r].map(e=>e.map(e=>t.getResidueByIndex(e).standardLabel));return{heatmapData:{data:l,xLabels:d,yLabels:o},residuesX:i,residuesY:r,xTitle:N.agent_1,yTitle:N.agent_2,isReduced:n}},[M,t,L,H]),X=(0,s.useCallback)(e=>{const n=t.getResidueByIndex(e);return{forResidue:e,forDistance:n.hasCAlpha?n.number.toString()+":"+n.chainName+".CA":null}},[t]),[F,Z]=(0,s.useState)(null),Q=(0,s.useCallback)(e=>{let{value:t,xAxisValue:n,yAxisValue:s}=e;return n+" - "+s+"\n"+Math.round(100*t)/100+" \xc5"},[]),G=(0,s.useCallback)(e=>{let{xIndex:t,yIndex:n}=e;const s=X(Y[t]),a=X(B[n]);Z({residues:[s.forResidue,a.forResidue],distance:s.forDistance&&a.forDistance&&[[s.forDistance,a.forDistance]]})},[Y,B,X]);if(S)return S.toString();if(k)return k.toString();if(M&&M.error)return M.error;if(!M)return j||z?(0,p.jsx)(u.A,{}):n?t?"Something bad happened with the analysis data":"There is no topology":"There are no interactions";return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.A,{children:(0,p.jsxs)(a.A,{className:_.default.horizontal,children:[(0,p.jsx)(i.A,{variant:"h6",children:"Residues selection:"}),(0,p.jsx)(h.A,{interactions:n,selectedInteraction:w,setSelectedInteraction:C,selectedResidues:L,setSelectedResidues:V,interfaceOnly:P})]})}),(0,p.jsx)("div",{className:j||z?_.default.disabled:_.default.enabled,children:(0,p.jsx)(c.A,{className:_.default.margined,id:"heatmap",children:(0,p.jsxs)(a.A,{children:[(0,p.jsxs)(r.A,{value:H,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:(e,t)=>{q(t)},className:_.default["margined-bottom"],children:[(0,p.jsx)(l.A,{value:"mean",label:"Residues distance averages"}),(0,p.jsx)(l.A,{value:"stdv",label:"Residues distance standard deviations"})]}),(0,p.jsx)(f.A,{inputData:W,onTooltip:Q,onClick:G,legendTitle:"mean"===H?"Distance average (\xc5)":"Distance standard deviation (\xc5)",maxValueColor:y,minValueColor:b,totalHeight:1===W.yLabels.length?30:void 0,xTitle:E,yTitle:J})]})})}),(0,p.jsx)(m.A,{newViewer:F?{selectedResidueIndices:F.residues,selectedDistances:F.distance}:null,onNail:e=>Z(t=>t&&t.residues===e.selectedResidueIndices?null:t),onClose:e=>Z(t=>t&&t.residues===e.selectedResidueIndices?null:t)})]})}},58870:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});const s={margined:"style_margined__JbZJ6","margined-bottom":"style_margined-bottom__WRBwE",horizontal:"style_horizontal__NH+ZS",enabled:"style_enabled__4JqEL",disabled:"style_disabled__39iRt"}},66565:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(65043);const a=(e,t)=>{const n=(0,s.useRef)(),a=(0,s.useMemo)(()=>e(n.current),t);return n.current=a,a}}}]);
//# sourceMappingURL=942.eb9b0d34.chunk.js.map