"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[510],{10939:(e,t,r)=>{r.d(t,{A:()=>d});var a=r(65043),l=r(12110),s=r(17604);const n="style_container__M9GCG";var o=r(70579);const i={opacity:[0,1]};(0,s.A)()||(i.transform=["translateY(50px)","translateY(0)"]);const c={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},d=(0,a.forwardRef)(((e,t)=>{let{overrideComponent:r,...s}=e;const d=(0,a.useRef)(null);(0,a.useLayoutEffect)((()=>{const e=d.current&&d.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),r=e.animate(i,{...c,delay:150*t});return()=>r.cancel()}),[]);const p=r?"section":l.A;return(0,o.jsx)("div",{ref:d,className:n,children:(0,o.jsx)(p,{component:"section",...s,ref:t})})}))},28316:(e,t,r)=>{r.r(t),r.d(t,{default:()=>J});var a=r(65043),l=r(73216),s=r(10939),n=r(53193),o=r(2260),i=r(32143),c=r(81673),d=r(90469),p=r(68577),u=r(51962),m=r(67784),h=r(17392),f=r(26494),x=r(11906),j=r(12639),g=r(92127);const y="style_tall__uLxlS",v="style_margined__hiFK4",b="style_spaced__jKimP",_="style_trash__JtAQQ",A="style_grey__f3+Yh",N="style_unpadded__QkJ-Y",k="style_outlined__b4B+l",C="style_right__ci4FV",$="style_search__JEl1-";var z=r(17604),O=r(95747),S=r(70579);const q=O._r.queryFields,T=Object.values(q).reduce(((e,t)=>e.concat(t)),[]),R={opacity:[0,1]};(0,z.A)()||(R.transform=["translateX(2.5%)","translateX(0)"]);const G=[{name:"AND",operator:"$and",noperator:"$not"},{name:"OR",operator:"$or",noperator:"$nor"}],I=(e,t)=>({[e]:t,$options:"i"}),M=(e,t)=>({[e]:+t}),w=(e,t)=>"true"===e,E={string:[{name:"contains",operator:"$regex",formatter:(e,t)=>{const r=t.replace(/[-[/\]{}()*+?.,\\^$|#\s]/g,"\\$&");return I(e,r)}},{name:"equals",operator:"$eq",formatter:(e,t)=>({[e]:t})},{name:"regular expression",operator:"$regex",formatter:I}],float:[{name:"greater than",operator:"$gt",formatter:M},{name:"lower than",operator:"$lt",formatter:M}],int:[{name:"equals",operator:"$eq",formatter:M},{name:"greater than",operator:"$gt",formatter:M},{name:"lower than",operator:"$lt",formatter:M}],boolean:[{name:"true",operator:"true",formatter:w},{name:"false",operator:"false",formatter:w}]},L={logic:"AND",is:!0,fields:[{field:"",is:!0,comparator:"",value:""},{field:"",is:!0,comparator:"",value:""}]},J=()=>{const e=(0,a.useRef)(L),[t,r]=(0,a.useState)(!1),z=(0,l.Zp)(),[,O]=(0,a.useState)(!0),R=()=>{O((e=>!e))};let I=!1;const M=e=>{let{object:t,label:r,options:a,handleChange:l,error:s,helpText:d}=e;return(0,S.jsxs)(n.A,{className:b,children:[(0,S.jsxs)(o.A,{id:"select",title:"Select the desired "+r,value:t[r],onChange:l,displayEmpty:!0,error:s,children:[(0,S.jsx)(i.A,{disabled:!0,value:"",children:(0,S.jsx)("em",{className:A,children:r})},"placeholder"),a.map((e=>(0,S.jsx)(i.A,{value:e,children:e},e)))]}),d&&(0,S.jsx)(c.A,{children:d})]})},w=e=>{let{object:t,label:r,options:a,handleChange:l}=e;return(0,S.jsx)(n.A,{className:b,children:(0,S.jsxs)(o.A,{id:"select",title:"Select the desired "+r,value:t[r],onChange:l,displayEmpty:!0,children:[(0,S.jsx)(i.A,{disabled:!0,value:"",children:(0,S.jsx)("em",{className:A,children:r})},"placeholder"),a.map((e=>{const[t,r]=Object.entries(e)[0];return[(0,S.jsx)(d.A,{color:"primary",children:t}),...r.map((e=>(0,S.jsx)(i.A,{value:e,children:e},e)))]}))]})})},J={string:{inputMode:"text"},int:{inputMode:"numeric",pattern:"[0-9+-]*",helpText:"integer numbers accepted only"},float:{inputMode:"numeric",pattern:"[0-9.,+-]*",helpText:"numbers accepted only"}},Q=e=>{let{object:r,parent:a,index:l}=e;const s=G.map((e=>e.name)),n=Object.entries(q).map((e=>{let[t,r]=e;return{[t]:r.map((e=>e.name))}})),o=[{"Logic operators":s},...n];if(void 0!==r.field){const e=T.find((e=>e.name===r.field)),n=e&&E[e.type].map((e=>e.name)),i=e&&"boolean"===e.type,c=e&&!r.comparator,d=c&&"please select a comparator",f=e&&!i&&!r.value,x=e&&!i&&J[e.type],y=e&&!i&&x.pattern&&r.value.match(x.pattern),b=y&&y[0]!==r.value,A=f?"please specify a value":b&&x.helpText;(c||f||b)&&(I=!0);const N=e=>{const t=e.target.value;r.value=t,R()};return(0,S.jsxs)("div",{className:v,children:[(0,S.jsx)(w,{object:r,label:"field",options:o,handleChange:e=>{const t=e.target.value;if(s.includes(t))return delete r.field,delete r.comparator,delete r.value,r.logic=t,r.is=!0,r.fields=[],void R();r.field=t;const a=T.find((e=>e.name===t));-1===(a&&E[a.type].map((e=>e.name))).indexOf(r.comparator)&&(r.comparator=""),R()}}),e&&!i&&(0,S.jsx)(p.A,{onChange:()=>{r.is=!r.is,R()},control:(0,S.jsx)(u.A,{checked:!r.is,icon:(0,S.jsx)(g.g,{icon:j.GRI,size:"xs",style:{visibility:"hidden"}}),checkedIcon:(0,S.jsx)(g.g,{icon:j.GRI,size:"xs"}),style:{color:"black"}}),label:"NOT",style:r.is?{color:"lightgrey"}:{color:"black"},className:k}),e&&(0,S.jsx)(M,{object:r,label:"comparator",options:n,handleChange:e=>{const t=e.target.value;r.comparator=t,R()},helpText:t&&d,error:t&&c}),e&&!i&&(0,S.jsx)(m.A,{title:"Type here the value for the specified field",defaultValue:r.value,onKeyPress:e=>{"Enter"===e.key&&N(e)},onBlur:N,placeholder:"e.g. "+e.example,inputProps:{inputMode:x.inputMode},helperText:t&&A,error:t&&(f||b)}),(0,S.jsx)(h.A,{variant:"contained",onClick:()=>{a.splice(l,1),R()},className:_,size:"large",children:(0,S.jsx)(g.g,{icon:j.yLS,size:"xs"})})]})}if(void 0!==r.fields)return(0,S.jsxs)("div",{className:v,children:[(0,S.jsx)(w,{object:r,label:"logic",options:o,handleChange:e=>{const t=e.target.value;if(-1===s.indexOf(t))return delete r.fields,delete r.logic,r.field=t,r.is=!0,r.comparator="",r.value="",void R();r.logic=t,R()}}),(0,S.jsx)(p.A,{onChange:()=>{r.is=!r.is,R()},control:(0,S.jsx)(u.A,{checked:!r.is,icon:(0,S.jsx)(g.g,{icon:j.GRI,size:"xs",style:{visibility:"hidden"}}),checkedIcon:(0,S.jsx)(g.g,{icon:j.GRI,size:"xs"}),style:{color:"black"}}),label:"NOT",style:r.is?{color:"lightgrey"}:{color:"black"},className:k}),(0,S.jsx)(h.A,{variant:"contained",onClick:()=>{r.fields.unshift({field:"",is:!0,comparator:"",value:""}),R()},className:N,size:"large",children:(0,S.jsx)(g.g,{icon:j.OQW})}),a&&(0,S.jsx)(h.A,{variant:"contained",onClick:()=>{a.splice(l,1),R()},className:N,size:"large",children:(0,S.jsx)(g.g,{icon:j.yLS,size:"xs"})}),r.fields.map(((e,t)=>(0,S.jsx)(Q,{object:e,parent:r.fields,index:t},t)))]})},Y=e=>{if(void 0!==e.field){const t=T.find((t=>t.name===e.field)),r=t.path,a=(t&&E[t.type]).find((t=>t.name===e.comparator)),l=a.operator,s=a.formatter;return e.is?{[r]:s(l,e.value)}:{[r]:{$not:s(l,e.value)}}}if(void 0!==e.logic){const t=e.logic,r=G.find((e=>e.name===t))[e.is?"operator":"noperator"],a=e.fields.filter((e=>e.field||e.logic));if(0===a.length)return;if(1===a.length){const t=a[0];return t.is=((e,t)=>{if(e){if(t)return!0;if(!t)return!1}else{if(t)return!1;if(!t)return!0}})(t.is,e.is),Y(t)}return{[r]:a.map((e=>Y(e)))}}};return(0,S.jsx)(s.A,{className:y,children:(0,S.jsxs)(f.A,{children:["Use the ",(0,S.jsx)("b",{children:"advanced search"})," query builder to create complex database queries.",(0,S.jsx)("br",{}),(0,S.jsx)("hr",{style:{color:"lightGrey"}}),(0,S.jsx)(Q,{object:e.current}),(0,S.jsx)("div",{className:C,children:(0,S.jsxs)(x.A,{variant:"contained",onClick:()=>{if(I)return void r(!0);const t=e.current,a=Y(t),l=JSON.stringify(a);l&&z("/browse?query="+l)},className:$,children:[(0,S.jsx)(g.g,{icon:j.MjD}),"\xa0",(0,S.jsx)("span",{children:"Search"})]})})]})})}}}]);
//# sourceMappingURL=advanced-search.19d9b8a1.chunk.js.map