"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3241],{25797:(e,s,n)=>{n.r(s),n.d(s,{default:()=>v});var t=n(65043),i=n(26494),a=n(85865),r=n(8939),d=n(24056),l=n(58338),c=n(10939),o=n(17545),u=n(34088),f=n(29449),h=n(95747),m=n(507),x=n(24310);const _="style_margined__JbZJ6",g="style_margined-bottom__WRBwE",p="style_horizontal__NH+ZS";var b=n(70579);const y={r:0,g:0,b:255},A={r:255,g:0,b:0},v=()=>{const{accessionAndMdNumber:e,topology:s,interactions:n}=(0,t.useContext)(f.f),[v,R]=(0,t.useState)(0),[C,j]=(0,t.useState)("interface_indices"),[D,S]=(0,t.useState)(null),[I,T]=(0,t.useState)("mean"),k="".concat(h.nP,"/").concat(e,"/analyses/dist-perres/"),{loading:w,payload:N,error:O}=(0,l.A)(k),{heatmapData:V,residuesX:L,residuesY:B,xTitle:M,yTitle:E,isReduced:H}=(0,t.useMemo)((()=>{if(w||O||!N||!s||!n)return{};const e=n[v],t=N.data.find((s=>s.name===e.name)),i="mean"===I?t.means:t.stdvs;let a;const r=i[0].length,d=i.length;if(d===e.residue_indices_2.length&&r===e.residue_indices_1.length)a=!1;else{if(d!==e.interface_indices_2.length||r!==e.interface_indices_1.length)throw new Error("The numbers of values in data does not match any number of residues in the interaction (neither all or interface)");a=!0}const l=e[C+"_1"],c=e[C+"_2"];let o=[];if(a)if("interface_indices"===C)o=i;else{const s=e.interface_indices_1,n=e.interface_indices_2;for(const e of c){const t=n.indexOf(e);let a;if(-1!==t){a=[];for(const e of l){const n=s.indexOf(e);-1!==n?a.push(i[t][n]):a.push(10)}o.push(a)}else{const e=l.length;a=new Array(e).fill(10),o.push(a)}}}else if("residue_indices"===C)o=i;else{const s=e.residue_indices_1,n=e.residue_indices_2;for(const e of c){const t=n.indexOf(e),a=[];for(const e of l){const n=s.indexOf(e);a.push(i[t][n])}o.push(a)}}const[u,f]=[l,c].map((e=>e.map((e=>s.getResidueByIndex(e).standardLabel))));return{heatmapData:{data:o,xLabels:u,yLabels:f},residuesX:l,residuesY:c,xTitle:e.agent_1,yTitle:e.agent_2,isReduced:a}}),[w,O,N,s,n,v,C,I]),J=(0,t.useCallback)((e=>{const n=s.getResidueByIndex(e);return{forResidue:e,forDistance:n.hasCAlpha?n.number.toString()+":"+n.chainName+".CA":null}}),[s]),W=(0,t.useCallback)((e=>{let{value:s,xAxisValue:n,yAxisValue:t}=e;return n+" - "+t+"\n"+Math.round(100*s)/100+" \xc5"}),[]),X=(0,t.useCallback)((e=>{let{xIndex:s,yIndex:n}=e;const t=J(L[s]),i=J(B[n]);S({residues:[t.forResidue,i.forResidue],distance:t.forDistance&&i.forDistance&&[[t.forDistance,i.forDistance]]})}),[L,B,J]);if(w)return(0,b.jsx)(o.A,{});if(O)return O.toString();if(!N)return"Something bad happened";if(!s||!n)return(0,b.jsx)(o.A,{});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.A,{children:(0,b.jsxs)(i.A,{className:p,children:[(0,b.jsx)(a.A,{variant:"h6",children:"Residues selection:"}),(0,b.jsx)(m.A,{interactions:n,selectedInteraction:v,setSelectedInteraction:R,selectedResidues:C,setSelectedResidues:j,interfaceOnly:H})]})}),(0,b.jsx)(c.A,{className:_,id:"heatmap",children:(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(r.A,{value:I,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:(e,s)=>{T(s)},className:g,children:[(0,b.jsx)(d.A,{value:"mean",label:"Residues distance averages"}),(0,b.jsx)(d.A,{value:"stdv",label:"Residues distance standard deviations"})]}),(0,b.jsx)(x.A,{inputData:V,onTooltip:W,onClick:X,legendTitle:"mean"===I?"Distance average (\xc5)":"Distance standard deviation (\xc5)",maxValueColor:y,minValueColor:A,totalHeight:1===V.yLabels.length?30:void 0,xTitle:M,yTitle:E})]})}),(0,b.jsx)(u.A,{newViewer:D?{selectedResidueIndices:D.residues,selectedDistances:D.distance}:null,onNail:e=>S((s=>s&&s.residues===e.selectedResidueIndices?null:s)),onClose:e=>S((s=>s&&s.residues===e.selectedResidueIndices?null:s))})]})}}}]);
//# sourceMappingURL=dist-perres.38d332d6.chunk.js.map