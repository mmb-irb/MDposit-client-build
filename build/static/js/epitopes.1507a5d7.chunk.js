"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[790,9117],{10939:(e,t,o)=>{o.d(t,{A:()=>u});var r=o(65043),n=o(12110),s=o(17604);const a="style_container__M9GCG";var c=o(70579);const l={opacity:[0,1]};(0,s.A)()||(l.transform=["translateY(50px)","translateY(0)"]);const i={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},u=(0,r.forwardRef)(((e,t)=>{let{overrideComponent:o,...s}=e;const u=(0,r.useRef)(null);(0,r.useLayoutEffect)((()=>{const e=u.current&&u.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),o=e.animate(l,{...i,delay:150*t});return()=>o.cancel()}),[]);const d=o?"section":n.A;return(0,c.jsx)("div",{ref:u,className:a,children:(0,c.jsx)(d,{component:"section",...s,ref:t})})}))},35847:(e,t,o)=>{o.d(t,{A:()=>s});var r=o(65043),n=o(29449);const s=()=>{const{topology:e}=(0,r.useContext)(n.f);return(0,r.useMemo)((()=>{if(!e)return;if(!e.proteinReferences.some((e=>!!e.epitopes)))return;const t=e.proteinReferences.map((t=>{const o=t.uniprot,r=t.epitopes;if(!r)return[];const n=Object.values(r).map((e=>e.residues)),s=[].concat.apply([],n),a=Array.from(new Set(s)),c=e.getReferenceResidueIndices(o,a);return c||[]})),o=[].concat.apply([],Object.values(t)),{rangedSelection:r,small:n}=e.residueIndices2Ngl(o);return[{name:"Epitopes",selection:r||"none",type:n?"licorice":"cartoon",color:"purple"}]}),[e])}},97318:(e,t,o)=>{o.d(t,{A:()=>s});var r=o(65043);const n=["red","green","blue","orange","purple"],s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const o=(0,r.useRef)([]);return(0,r.useMemo)((()=>[()=>{for(const t of e){if(-1===o.current.indexOf(t))return o.current.push(t),t}return t},e=>{if(e===t)return;const r=o.current.indexOf(e);if(-1===r)throw new Error("Color ".concat(e," is not used"));o.current.splice(r,1)},()=>{o.current=[]}]),[e,t])}},56642:(e,t,o)=>{o.r(t),o.d(t,{default:()=>L});var r=o(65043),n=o(89257),s=o(71806),a=o(84882),c=o(28076),l=o(10039),i=o(68577),u=o(51962),d=o(73460),p=o(207),m=o(67803),f=o(85865),h=o(10939),A=o(92428),x=o(10419);const v="style_paper__INgwI",g="style_tablecard__04qFr",y="style_nglcard__L-RSO",b="style_container__UgV8T",j="style_selectedrow__vdp-o",C="style_row__6TSz1",M="style_graph__IyyKm",k="style_graph-placeholder__ZJ5fh";var S=o(29449),R=o(17545),w=o(58338),_=o(97318),N=o(95747),z=o(35847),P=o(70579);const E=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],O=[10,25,50,100],I=(0,r.lazy)((()=>Promise.all([o.e(4040),o.e(2577),o.e(5291),o.e(5077)]).then(o.bind(o,75291)))),F={triggerOnce:!0,rootMargin:"100px"},T=e=>Math.round(10*e)/10,L=()=>{const[e,t]=(0,n.Wx)(F),{accessionAndMdNumber:o,metadata:L,proteinReferences:B,topology:H}=(0,r.useContext)(S.f),V=(0,r.useMemo)((()=>{if(!B)return[];const e=[];return B.forEach((t=>{const o=t.epitopes;if(!o)return;const r=Object.entries(o).map((e=>{let[o,r]=e;return[t.uniprot,o,r.residues,r.mas]}));e.push(...r)})),e}),[B]),D=(0,r.useRef)(null),q=(0,r.useRef)(null),G=(0,r.useRef)(null),U=(0,r.useRef)(null),[Y,J]=(0,_.A)(),[K,W]=(0,r.useState)(!1),[X,Z]=(0,r.useState)(null),[Q,$]=(0,r.useState)([]),[ee,te]=(0,r.useState)(0),[oe,re]=(0,r.useState)(10),{loading:ne,payload:se,error:ae}=(0,w.A)("".concat(N.nP,"/").concat(o,"/analyses/sasa/")),{data:ce,epitopesData:le,frameStep:ie,frameCount:ue,xTooltip:de}=(0,r.useMemo)((()=>{if(!se||!L||!H||0===V.length)return{};const e=se.saspf,t=e[0].length,o=se.step||Math.floor(L.mdFrames/(t-1)),r=[];V.forEach((o=>{let[n,s,a,c]=o;const l=H.getReferenceResidueIndices(n,a);if(0===l.length)return{};const i=H.byChains(l),u=Object.keys(i),d={};Object.entries(i).forEach((t=>{let[o,r]=t;const n=r.map((t=>{const o={saspf:e[t]};return o.atoms=H.getResidueByIndex(t).atomCount,o}));d[o]=n}));const p={},m=[];Object.entries(d).forEach((e=>{let[o,r]=e;const n=r.length/a.length,s=n%1===0,l=c*n,i=[],u=[];for(let a=0;a<t;a++){const e=r.map((e=>e.saspf[a]*e.atoms)).reduce(((e,t)=>e+t),0);i.push(e);const t=e/l*100;u.push(t)}const d=(e=>{const t=e.reduce(((e,t)=>e+t),0),o=e.length;return T(t/o)})(i),f=T(d/l*100),h="".concat(o,":").concat(d," \xc5\xb2 (").concat(f,"%)").concat(s?"":"*");m.push(h),p[o]=u}));const{rangedSelection:f,small:h}=H.residueIndices2Ngl(l);r.push({name:s,data:p,selection:f,small:h,chains:u,summary:m.join("\n")})})),$(new Array(r.length).fill(null));return{data:e,epitopesData:r,frameStep:o,frameCount:t,xTooltip:e=>"frame "+e}}),[se,L,H,V]),pe=(0,x.A)(),me=(0,z.A)(),fe=(0,r.useMemo)((()=>{if(!o)return;const e="".concat(N.nP,"/").concat(o,"/files/trajectory");return[{trajectoryURLs:["".concat(e,"?frames=1:").concat(L.mdFrames,":").concat(ie)]}]}),[o,L,ie]),[he,Ae]=(0,r.useState)(null);(0,r.useMemo)((()=>{pe&&0!==pe.length&&me&&0!==me.length&&le&&Ae((e=>{if(null===e){const e=[];return pe.forEach((t=>{t.opacity=.3,t.color="black",e.push(t)})),Q.forEach(((t,o)=>{if(null===t)return;const r=le[o],n={name:r.name,selection:r.selection,type:r.small?"licorice":"cartoon",color:t};e.push(n)})),K&&e.push(...me),e}const t=[];t.push(...pe),Q.forEach(((o,r)=>{if(null===o)return;const n=le[r],s=e.find((e=>e.name===n.name));if(s)return t.push(s);const a={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:o};t.push(a)})),K&&t.push(...me);const o=e.filter((e=>e.custom));return t.push(...o),t}))}),[le,pe,me,Q,K]);const xe=(0,r.useMemo)((()=>{if(!le)return;if(null===X)return;const e=le[X];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]}),[le,X]),ve=(0,r.useMemo)((()=>{if(!ce||!L||!le)return;const e={};return le.forEach(((t,o)=>{let{name:r,data:n}=t;if(!Q[o])return;const s=Q[o];Object.entries(n).forEach(((t,o)=>{let[n,a]=t;const c=E[o];e[r+"-"+n]={data:a,color:s,dash:c}}))})),e}),[ce,L,le,Q]),ge=(0,r.useCallback)((e=>{G.current.togglePlaying(!1),G.current.currentFrame=e}),[]),ye=(0,r.useCallback)((e=>{const t=Math.round(e*(ue-1));U.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]}),[ue]);if(ne)return(0,P.jsx)(R.A,{});if(ae)return ae.toString();if(!se)return"Something bad happened";if(!H||!B)return(0,P.jsx)(R.A,{});if(0===V.length)return"Missing epitopes data";const be=ee*oe,je=(ee+1)*oe;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(h.A,{className:g,children:(0,P.jsx)("div",{className:v,ref:q,children:(0,P.jsxs)(s.A,{stickyHeader:!0,size:"small",children:[(0,P.jsx)(a.A,{children:(0,P.jsxs)(c.A,{children:[(0,P.jsx)(l.A,{children:(0,P.jsx)(i.A,{onChange:()=>W((e=>!e)),control:(0,P.jsx)(u.A,{checked:K}),label:"Epitopes"})},0),(0,P.jsx)(l.A,{children:"Average SAS and exposure"},1)]})}),(0,P.jsx)(d.A,{children:le.slice(be,je).map(((e,t)=>{let{name:o,summary:r}=e;const n=ee*oe+t;return(0,P.jsx)(c.A,{role:"checkbox",className:n===X?j:C,onMouseEnter:()=>Z(n),onMouseLeave:()=>Z((e=>e===n?null:e)),children:[(0,P.jsx)(i.A,{"data-key":o,onMouseOver:()=>{D.current=n},onMouseOut:()=>{D.current=null},onChange:()=>$((e=>(e[n]?(J(e[n]),e[n]=null):e[n]=Y(),[...e]))),control:(0,P.jsx)(u.A,{checked:!!Q[n],style:{color:Q[n]?Q[n]:"black"},inputProps:{"data-key":o}}),label:(0,P.jsx)("a",{href:"https://www.rcsb.org/structure/"+o,target:"_blank",rel:"noreferrer noopener",children:o})},o),r].map((e=>(0,P.jsx)(l.A,{children:e},e)))},o)}))}),(0,P.jsx)(p.A,{children:(0,P.jsx)(c.A,{children:(0,P.jsx)(m.A,{rowsPerPageOptions:O,colSpan:4,count:le.length,rowsPerPage:oe,page:ee,onPageChange:(e,t)=>{te(t),q.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;re(t),te(0)}})})})]})})}),(0,P.jsx)(h.A,{className:y,ref:e,children:t?(0,P.jsx)(A.default,{className:b,startingComponents:fe,representationsState:[he,Ae],snapRepresentations:xe,onProgress:ye,ref:G}):(0,P.jsx)("div",{style:{height:"50vh"}})}),(0,P.jsxs)(h.A,{className:M,children:[Q.every((e=>null===e))&&(0,P.jsx)("div",{className:k,children:(0,P.jsx)(f.A,{variant:"h6",children:"No epitope selected"})}),(0,P.jsx)(I,{yData:ve,step:ie,xTooltip:de,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:ge,displayLegend:!0,className:M,ref:U})]})]})}},12110:(e,t,o)=>{o.d(t,{A:()=>x});var r=o(58168),n=o(98587),s=o(65043),a=o(58387),c=o(98610),l=o(34535),i=o(98206),u=o(63336),d=o(92532),p=o(72372);function m(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var f=o(70579);const h=["className","raised"],A=(0,l.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),x=s.forwardRef((function(e,t){const o=(0,i.b)({props:e,name:"MuiCard"}),{className:s,raised:l=!1}=o,u=(0,n.A)(o,h),d=(0,r.A)({},o,{raised:l}),p=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(d);return(0,f.jsx)(A,(0,r.A)({className:(0,a.A)(p.root,s),elevation:l?8:void 0,ref:t,ownerState:d},u))}))},26494:(e,t,o)=>{o.d(t,{A:()=>A});var r=o(58168),n=o(98587),s=o(65043),a=o(58387),c=o(98610),l=o(34535),i=o(98206),u=o(92532),d=o(72372);function p(e){return(0,d.Ay)("MuiCardContent",e)}(0,u.A)("MuiCardContent",["root"]);var m=o(70579);const f=["className","component"],h=(0,l.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),A=s.forwardRef((function(e,t){const o=(0,i.b)({props:e,name:"MuiCardContent"}),{className:s,component:l="div"}=o,u=(0,n.A)(o,f),d=(0,r.A)({},o,{component:l}),A=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},p,t)})(d);return(0,m.jsx)(h,(0,r.A)({as:l,className:(0,a.A)(A.root,s),ownerState:d,ref:t},u))}))},51962:(e,t,o)=>{o.d(t,{A:()=>w});var r=o(98587),n=o(58168),s=o(65043),a=o(58387),c=o(98610),l=o(67266),i=o(33064),u=o(59662),d=o(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),f=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var h=o(6803),A=o(98206),x=o(34535),v=o(61475),g=o(92532),y=o(72372);function b(e){return(0,y.Ay)("MuiCheckbox",e)}const j=(0,g.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),C=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],M=(0,x.Ay)(i.A,{shouldForwardProp:e=>(0,v.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.indeterminate&&t.indeterminate,t["size".concat((0,h.A)(o.size))],"default"!==o.color&&t["color".concat((0,h.A)(o.color))]]}})((e=>{let{theme:t,ownerState:o}=e;return(0,n.A)({color:(t.vars||t).palette.text.secondary},!o.disableRipple&&{"&:hover":{backgroundColor:t.vars?"rgba(".concat("default"===o.color?t.vars.palette.action.activeChannel:t.vars.palette[o.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.X4)("default"===o.color?t.palette.action.active:t.palette[o.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==o.color&&{["&.".concat(j.checked,", &.").concat(j.indeterminate)]:{color:(t.vars||t).palette[o.color].main},["&.".concat(j.disabled)]:{color:(t.vars||t).palette.action.disabled}})})),k=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),R=(0,d.jsx)(f,{}),w=s.forwardRef((function(e,t){var o,l;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=k,color:p="primary",icon:m=S,indeterminate:f=!1,indeterminateIcon:x=R,inputProps:v,size:g="medium",className:y}=i,j=(0,r.A)(i,C),w=f?x:m,_=f?x:u,N=(0,n.A)({},i,{color:p,indeterminate:f,size:g}),z=(e=>{const{classes:t,indeterminate:o,color:r,size:s}=e,a={root:["root",o&&"indeterminate","color".concat((0,h.A)(r)),"size".concat((0,h.A)(s))]},l=(0,c.A)(a,b,t);return(0,n.A)({},t,l)})(N);return(0,d.jsx)(M,(0,n.A)({type:"checkbox",inputProps:(0,n.A)({"data-indeterminate":f},v),icon:s.cloneElement(w,{fontSize:null!=(o=w.props.fontSize)?o:g}),checkedIcon:s.cloneElement(_,{fontSize:null!=(l=_.props.fontSize)?l:g}),ownerState:N,ref:t,className:(0,a.A)(z.root,y)},j,{classes:z}))}))},207:(e,t,o)=>{o.d(t,{A:()=>g});var r=o(58168),n=o(98587),s=o(65043),a=o(58387),c=o(98610),l=o(21573),i=o(98206),u=o(34535),d=o(92532),p=o(72372);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var f=o(70579);const h=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),x={variant:"footer"},v="tfoot",g=s.forwardRef((function(e,t){const o=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:s,component:u=v}=o,d=(0,n.A)(o,h),p=(0,r.A)({},o,{component:u}),g=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(p);return(0,f.jsx)(l.A.Provider,{value:x,children:(0,f.jsx)(A,(0,r.A)({as:u,className:(0,a.A)(g.root,s),ref:t,role:u===v?null:"rowgroup",ownerState:p},d))})}))}}]);
//# sourceMappingURL=epitopes.1507a5d7.chunk.js.map