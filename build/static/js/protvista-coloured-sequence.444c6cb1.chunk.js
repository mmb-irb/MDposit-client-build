"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[2707,1307],{67340:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});var i=s(32577),a=s(77665),r=s(5753);const h=JSON.parse('{"I":-0.31,"L":-0.56,"F":-1.13,"V":0.07,"M":-0.23,"P":0.45,"W":-1.85,"H":0.17,"T":0.14,"E":-0.01,"Q":0.58,"C":-0.24,"Y":-0.94,"A":0.17,"S":0.13,"N":0.42,"D":-0.07,"R":0.81,"G":0.01,"K":0.99}'),n=JSON.parse('{"I":-1.12,"L":-1.25,"F":-1.71,"V":-0.46,"M":-0.67,"P":0.14,"W":-2.09,"H":0.11,"T":0.25,"E":0.11,"Q":0.77,"C":-0.02,"Y":-0.71,"A":0.5,"S":0.46,"N":0.85,"D":0.43,"R":1.15,"G":3.63,"K":3.64}'),c=JSON.parse('{"I":-0.81,"L":-0.69,"F":-0.58,"V":-0.53,"M":-0.44,"P":-0.31,"W":-0.24,"H":-0.06,"T":0.11,"E":1.61,"Q":0.19,"C":0.22,"Y":0.23,"A":0.33,"S":0.33,"N":0.43,"D":2.41,"R":1,"G":1.14,"K":1.81}'),o=JSON.parse('{"I":6.04,"L":6.04,"F":5.91,"V":6.02,"M":5.74,"P":6.3,"W":5.88,"H":7.64,"T":5.6,"E":3.08,"Q":5.65,"C":5.02,"Y":5.63,"A":6.11,"S":5.68,"N":5.41,"D":2.87,"R":10.76,"G":6.06,"K":9.47}'),l=["hydrophobicity-interface-scale","hydrophobicity-octanol-scale","hydrophobicity-scale","isoelectric-point-scale"],d={domain:[-2,2],range:["#ffdd00","#0000FF"]};class g extends a.default{static get observedAttributes(){return a.default.observedAttributes.concat("scale","color_range")}_createSequence(){this.svg=(0,i.Ltv)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",this._height),this.uniqueID=Math.random().toString(36).substring(7),this.gradient=this.svg.append("defs").append("linearGradient").attr("id","scale-gradient-".concat(this.uniqueID)),this.seq_g=this.svg.append("g").attr("class","background"),this.seq_greadient=this.svg.append("rect").attr("class","seq-gradient").style("pointer-events","none"),this._getCharSize(),this.trackHighlighter.appendHighlightTo(this.svg),this.refresh()}getScaleFromAttribute(){let t=null;if(l.indexOf(this._scale)>=0)switch(this._scale){case"hydrophobicity-scale":return c;case"hydrophobicity-interface-scale":return h;case"isoelectric-point-scale":return o;case"hydrophobicity-octanol-scale":return n;default:return null}if(/([ILFVMPWHTEQCYASNDRGK]:-?\d+\.?\d*)(,[ILFVMPWHTEQCYASNDRGK]:-?\d+\.?\d*)*/.test(this._scale))try{t=(0,r.xG)(this._scale,{keyFormatter:t=>t.toUpperCase(),valueFormatter:t=>parseFloat(t)})}catch(e){console.error("Couldn't parse the given scale ".concat(this._scale),e)}return t}refresh(){if(this.seq_g){const t=this.getScaleFromAttribute();if(null===t)return void console.error("The attribute scale is not valid.");const e=(0,i.m4Y)();this.colorScale=d,this._color_range&&(this.colorScale=(0,r.rb)(this._color_range)),e.domain(this.colorScale.domain).range(this.colorScale.range);const s=this.getSingleBaseWidth(),a=Math.round(Math.max(0,this._displaystart-2)),h=Math.round(Math.min(this.sequence.length,this._displayend+1)),n=this.sequence.slice(a,h).split("").map(((s,i)=>{const r=s.toUpperCase()in t?t[s.toUpperCase()]:0;return{start:1+a+i,end:1+a+i,aa:s,value:r,colour:e(r)}}));this.residues=this.seq_g.selectAll("rect.base_bg").data(s<8?[]:n,(t=>t.start)),this.residues.enter().append("rect").attr("class","base_bg feature").attr("data-base",(t=>{let{aa:e}=t;return e})).attr("data-pos",(t=>{let{start:e}=t;return e})).attr("height",this._height).merge(this.residues).attr("width",s).attr("fill",(t=>{let{colour:e}=t;return e})).attr("x",(t=>{let{start:e}=t;return this.getXFromSeqPosition(e)})).call(this.bindEvents,this),this.residues.exit().remove();const c=this.gradient.selectAll("stop").data(this.sequence.split(""));c.enter().append("stop").merge(c).attr("offset",((t,e)=>(e+.5)/this.sequence.length)).attr("stop-color",(s=>e(s.toUpperCase()in t?t[s.toUpperCase()]:0))),this.gradient.exit().remove(),this.seq_greadient.attr("x",this.getXFromSeqPosition(1)).attr("y",0).attr("height",this._height).attr("width",this.getXFromSeqPosition(this.sequence.length)-this.getXFromSeqPosition(0)).style("opacity",s<8?1:8/s).attr("fill","url(#scale-gradient-".concat(this.uniqueID,")")),this._updateHighlight()}}}const u=g},77665:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var i=s(32577),a=s(41502);class r extends a.A{connectedCallback(){super.connectedCallback(),this.sequence=this.getAttribute("sequence");const t=this.getAttribute("numberofticks");this.numberOfTicks=Number.isInteger(parseInt(t,10))?t:3,this.sequence&&this._createSequence(),this.addEventListener("load",(t=>{this.data=t.detail.payload}))}static get observedAttributes(){return a.A.observedAttributes.concat("highlightstart","highlightend")}get data(){return this.sequence}set data(t){"string"===typeof t?this.sequence=t:"sequence"in t&&(this.sequence=t.sequence),this.sequence&&!super.svg?this._createSequence():this.refresh()}_getCharSize(){if(!this.seq_g)return;const t=this.seq_g.select("text.base").node();if(t)this.chWidth=.8*t.getBBox().width,this.chHeight=1.6*t.getBBox().height;else{const t=this.seq_g.append("text").attr("class","base").text("T");this.chWidth=.8*t.node().getBBox().width,this.chHeight=1.6*t.node().getBBox().height,t.remove()}}_createSequence(){(0,i.Ltv)(this).selectAll("div").remove(),super.svg=(0,i.Ltv)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",this._height),this.seq_bg=super.svg.append("g").attr("class","background"),this.axis=super.svg.append("g").attr("class","x axis"),this.seq_g=super.svg.append("g").attr("class","sequence").attr("transform","translate(0,".concat(.75*this._height,")")),this.trackHighlighter.appendHighlightTo(this.svg),this.refresh()}refresh(){if(this._getCharSize(),this.axis){const t=this.getSingleBaseWidth(),e=t-this.chWidth,s=t/2,a=Math.round(Math.max(0,this._displaystart-2)),r=Math.round(Math.min(this.sequence.length,this._displayend+1)),h=e<0?[]:this.sequence.slice(a,r).split("").map(((t,e)=>({start:1+a+e,end:1+a+e,aa:t})));this.height>this.chHeight&&(this.xAxis=(0,i.l78)(this.xScale).tickFormat((t=>Number.isInteger(t)?t:"")).ticks(this.numberOfTicks,"s"),this.axis.call(this.xAxis)),this.axis.attr("transform","translate(".concat(this.margin.left+s,",0)")),this.axis.select(".domain").remove(),this.axis.selectAll(".tick line").remove(),this.bases=this.seq_g.selectAll("text.base").data(h,(t=>t.start)),this.bases.enter().append("text").attr("class","base").attr("text-anchor","middle").attr("x",(t=>this.getXFromSeqPosition(t.start)+s)).text((t=>t.aa)).style("pointer-events","none").style("font-family","monospace"),this.bases.exit().remove(),this.bases.attr("x",(t=>this.getXFromSeqPosition(t.start)+s)),this.background=this.seq_bg.selectAll("rect.base_bg").data(h,(t=>t.start)),this.background.enter().append("rect").attr("class","base_bg feature").attr("height",this._height).merge(this.background).attr("width",t).attr("fill",(t=>Math.round(t.start)%2?"#ccc":"#eee")).attr("x",(t=>this.getXFromSeqPosition(t.start))).call(this.bindEvents,this),this.background.exit().remove(),this.seq_g.style("opacity",Math.min(1,e)),this.background.style("opacity",Math.min(1,e)),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}const h=r}}]);
//# sourceMappingURL=protvista-coloured-sequence.444c6cb1.chunk.js.map