"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[6525],{3152:(t,e,i)=>{i.d(e,{A:()=>l});var a=i(54577),n=i(10500),r=i(28593),s=i(28666),o=a.A?a.A.prototype:void 0,h=o?o.toString:void 0;const c=function t(e){if("string"==typeof e)return e;if((0,r.A)(e))return(0,n.A)(e,t)+"";if((0,s.A)(e))return h?h.call(e):"";var i=e+"";return"0"==i&&1/e==-1/0?"-0":i};const l=function(t){return null==t?"":c(t)}},3777:(t,e,i)=>{i.d(e,{A:()=>n});var a=i(99944);const n=function(t){var e=(0,a.A)(t),i=e%1;return e===e?i?e-i:e:0}},4796:(t,e,i)=>{i.d(e,{A:()=>c});var a=i(32880),n=i(54577),r=i(94443),s=i(28593),o=n.A?n.A.isConcatSpreadable:void 0;const h=function(t){return(0,s.A)(t)||(0,r.A)(t)||!!(o&&t&&t[o])};const c=function t(e,i,n,r,s){var o=-1,c=e.length;for(n||(n=h),s||(s=[]);++o<c;){var l=e[o];i>0&&n(l)?i>1?t(l,i-1,n,r,s):(0,a.A)(s,l):r||(s[s.length]=l)}return s}},6376:(t,e,i)=>{i.d(e,{A:()=>d});var a=i(21584);const n=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)};var r=Math.max;const s=function(t,e,i){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,s=-1,o=r(a.length-e,0),h=Array(o);++s<o;)h[s]=a[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=a[s];return c[e]=i(h),n(t,this,c)}};const o=function(t){return function(){return t}};var h=i(87371);const c=h.A?function(t,e){return(0,h.A)(t,"toString",{configurable:!0,enumerable:!1,value:o(e),writable:!0})}:a.A;var l=Date.now;const u=function(t){var e=0,i=0;return function(){var a=l(),n=16-(a-i);if(i=a,n>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(c);const d=function(t,e){return u(s(t,e,a.A),t+"")}},10312:(t,e,i)=>{i.d(e,{A:()=>r});var a=i(67522);function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var i=function(){var a=arguments,n=e?e.apply(this,a):a[0],r=i.cache;if(r.has(n))return r.get(n);var s=t.apply(this,a);return i.cache=r.set(n,s)||r,s};return i.cache=new(n.Cache||a.A),i}n.Cache=a.A;const r=n},10500:(t,e,i)=>{i.d(e,{A:()=>a});const a=function(t,e){for(var i=-1,a=null==t?0:t.length,n=Array(a);++i<a;)n[i]=e(t[i],i,t);return n}},10709:(t,e,i)=>{i.d(e,{A:()=>a});const a=function(t){return function(e){return null==e?void 0:e[t]}}},21584:(t,e,i)=>{i.d(e,{A:()=>a});const a=function(t){return t}},29533:(t,e,i)=>{i.d(e,{A:()=>r});var a=i(59758),n=i(10666);const r=function(t){return(0,n.A)(t)&&(0,a.A)(t)}},40830:(t,e,i)=>{i.d(e,{A:()=>a});const a=function(){}},88393:(t,e,i)=>{i.r(e),i.d(e,{default:()=>de});var a=i(89379),n=i(57631);const r=function(t,e,i,a){for(var n=t.length,r=i+(a?1:-1);a?r--:++r<n;)if(e(t[r],r,t))return r;return-1};const s=function(t){return t!==t};const o=function(t,e,i){for(var a=i-1,n=t.length;++a<n;)if(t[a]===e)return a;return-1};const h=function(t,e,i){return e===e?o(t,e,i):r(t,s,i)};var c=i(59758),l=i(66445),u=i(28593),d=i(10666);const g=function(t){return"string"==typeof t||!(0,u.A)(t)&&(0,d.A)(t)&&"[object String]"==(0,l.A)(t)};var f=i(3777),p=i(10500);const _=function(t,e){return(0,p.A)(e,function(e){return t[e]})};var m=i(21251);const v=function(t){return null==t?[]:_(t,(0,m.A)(t))};var b=Math.max;const y=function(t,e,i,a){t=(0,c.A)(t)?t:v(t),i=i&&!a?(0,f.A)(i):0;var n=t.length;return i<0&&(i=b(n+i,0)),g(t)?i<=n&&t.indexOf(e,i)>-1:!!n&&h(t,e,i)>-1};var A=i(13808);const L=function(t,e,i,a){for(var n=-1,r=null==t?0:t.length;++n<r;){var s=t[n];e(a,s,i(s),t)}return a};const F=function(t){return function(e,i,a){for(var n=-1,r=Object(e),s=a(e),o=s.length;o--;){var h=s[t?o:++n];if(!1===i(r[h],h,r))break}return e}}();const C=function(t,e){return function(i,a){if(null==i)return i;if(!(0,c.A)(i))return t(i,a);for(var n=i.length,r=e?n:-1,s=Object(i);(e?r--:++r<n)&&!1!==a(s[r],r,s););return i}}(function(t,e){return t&&F(t,e,m.A)});const S=function(t,e,i,a){return C(t,function(t,n,r){e(a,t,i(t),r)}),a};var P=i(52607),O=i(67522);const x=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};const w=function(t){return this.__data__.has(t)};function M(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new O.A;++e<i;)this.add(t[e])}M.prototype.add=M.prototype.push=x,M.prototype.has=w;const H=M;const j=function(t,e){for(var i=-1,a=null==t?0:t.length;++i<a;)if(e(t[i],i,t))return!0;return!1};const k=function(t,e){return t.has(e)};const N=function(t,e,i,a,n,r){var s=1&i,o=t.length,h=e.length;if(o!=h&&!(s&&h>o))return!1;var c=r.get(t);if(c&&r.get(e))return c==e;var l=-1,u=!0,d=2&i?new H:void 0;for(r.set(t,e),r.set(e,t);++l<o;){var g=t[l],f=e[l];if(a)var p=s?a(f,g,l,e,t,r):a(g,f,l,t,e,r);if(void 0!==p){if(p)continue;u=!1;break}if(d){if(!j(e,function(t,e){if(!k(d,e)&&(g===t||n(g,t,i,a,r)))return d.push(e)})){u=!1;break}}else if(g!==f&&!n(g,f,i,a,r)){u=!1;break}}return r.delete(t),r.delete(e),u};var W=i(54577),E=i(37524),T=i(32424);const R=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t,a){i[++e]=[a,t]}),i};const q=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i};var B=W.A?W.A.prototype:void 0,I=B?B.valueOf:void 0;const D=function(t,e,i,a,n,r,s){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new E.A(t),new E.A(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,T.A)(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var o=R;case"[object Set]":var h=1&a;if(o||(o=q),t.size!=e.size&&!h)return!1;var c=s.get(t);if(c)return c==e;a|=2,s.set(t,e);var l=N(o(t),o(e),a,n,r,s);return s.delete(t),l;case"[object Symbol]":if(I)return I.call(t)==I.call(e)}return!1};var Y=i(71394),Z=Object.prototype.hasOwnProperty;const G=function(t,e,i,a,n,r){var s=1&i,o=(0,Y.A)(t),h=o.length;if(h!=(0,Y.A)(e).length&&!s)return!1;for(var c=h;c--;){var l=o[c];if(!(s?l in e:Z.call(e,l)))return!1}var u=r.get(t);if(u&&r.get(e))return u==e;var d=!0;r.set(t,e),r.set(e,t);for(var g=s;++c<h;){var f=t[l=o[c]],p=e[l];if(a)var _=s?a(p,f,l,e,t,r):a(f,p,l,t,e,r);if(!(void 0===_?f===p||n(f,p,i,a,r):_)){d=!1;break}g||(g="constructor"==l)}if(d&&!g){var m=t.constructor,v=e.constructor;m==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof v&&v instanceof v||(d=!1)}return r.delete(t),r.delete(e),d};var U=i(26346),z=i(17526),X=i(18732),V="[object Arguments]",Q="[object Array]",$="[object Object]",K=Object.prototype.hasOwnProperty;const J=function(t,e,i,a,n,r){var s=(0,u.A)(t),o=(0,u.A)(e),h=s?Q:(0,U.A)(t),c=o?Q:(0,U.A)(e),l=(h=h==V?$:h)==$,d=(c=c==V?$:c)==$,g=h==c;if(g&&(0,z.A)(t)){if(!(0,z.A)(e))return!1;s=!0,l=!1}if(g&&!l)return r||(r=new P.A),s||(0,X.A)(t)?N(t,e,i,a,n,r):D(t,e,h,i,a,n,r);if(!(1&i)){var f=l&&K.call(t,"__wrapped__"),p=d&&K.call(e,"__wrapped__");if(f||p){var _=f?t.value():t,m=p?e.value():e;return r||(r=new P.A),n(_,m,i,a,r)}}return!!g&&(r||(r=new P.A),G(t,e,i,a,n,r))};const tt=function t(e,i,a,n,r){return e===i||(null==e||null==i||!(0,d.A)(e)&&!(0,d.A)(i)?e!==e&&i!==i:J(e,i,a,n,t,r))};const et=function(t,e,i,a){var n=i.length,r=n,s=!a;if(null==t)return!r;for(t=Object(t);n--;){var o=i[n];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<r;){var h=(o=i[n])[0],c=t[h],l=o[1];if(s&&o[2]){if(void 0===c&&!(h in t))return!1}else{var u=new P.A;if(a)var d=a(c,l,h,t,e,u);if(!(void 0===d?tt(l,c,3,a,u):d))return!1}}return!0};var it=i(65709);const at=function(t){return t===t&&!(0,it.A)(t)};const nt=function(t){for(var e=(0,m.A)(t),i=e.length;i--;){var a=e[i],n=t[a];e[i]=[a,n,at(n)]}return e};const rt=function(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}};const st=function(t){var e=nt(t);return 1==e.length&&e[0][2]?rt(e[0][0],e[0][1]):function(i){return i===t||et(i,t,e)}};var ot=i(28666),ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/;const lt=function(t,e){if((0,u.A)(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!(0,ot.A)(t))||(ct.test(t)||!ht.test(t)||null!=e&&t in Object(e))};var ut=i(10312);var dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/\\(\\)?/g;const ft=function(t){var e=(0,ut.A)(t,function(t){return 500===i.size&&i.clear(),t}),i=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(dt,function(t,i,a,n){e.push(a?n.replace(gt,"$1"):i||t)}),e});var pt=i(3152);const _t=function(t,e){return(0,u.A)(t)?t:lt(t,e)?[t]:ft((0,pt.A)(t))};const mt=function(t){if("string"==typeof t||(0,ot.A)(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e};const vt=function(t,e){for(var i=0,a=(e=_t(e,t)).length;null!=t&&i<a;)t=t[mt(e[i++])];return i&&i==a?t:void 0};const bt=function(t,e,i){var a=null==t?void 0:vt(t,e);return void 0===a?i:a};const yt=function(t,e){return null!=t&&e in Object(t)};var At=i(94443),Lt=i(26761),Ft=i(902);const Ct=function(t,e,i){for(var a=-1,n=(e=_t(e,t)).length,r=!1;++a<n;){var s=mt(e[a]);if(!(r=null!=t&&i(t,s)))break;t=t[s]}return r||++a!=n?r:!!(n=null==t?0:t.length)&&(0,Ft.A)(n)&&(0,Lt.A)(s,n)&&((0,u.A)(t)||(0,At.A)(t))};const St=function(t,e){return null!=t&&Ct(t,e,yt)};const Pt=function(t,e){return lt(t)&&at(e)?rt(mt(t),e):function(i){var a=bt(i,t);return void 0===a&&a===e?St(i,t):tt(e,a,3)}};var Ot=i(21584),xt=i(10709);const wt=function(t){return function(e){return vt(e,t)}};const Mt=function(t){return lt(t)?(0,xt.A)(mt(t)):wt(t)};const Ht=function(t){return"function"==typeof t?t:null==t?Ot.A:"object"==typeof t?(0,u.A)(t)?Pt(t[0],t[1]):st(t):Mt(t)};const jt=function(t,e){return function(i,a){var n=(0,u.A)(i)?L:S,r=e?e():{};return n(i,t,Ht(a,2),r)}};var kt=Object.prototype.hasOwnProperty;const Nt=jt(function(t,e,i){kt.call(t,i)?t[i].push(e):(0,A.A)(t,i,[e])});var Wt=i(4796),Et=i(6376);const Tt=function(t,e){return!!(null==t?0:t.length)&&h(t,e,0)>-1};const Rt=function(t,e,i){for(var a=-1,n=null==t?0:t.length;++a<n;)if(i(e,t[a]))return!0;return!1};var qt=i(94993),Bt=i(40830),It=qt.A&&1/q(new qt.A([,-0]))[1]==1/0?function(t){return new qt.A(t)}:Bt.A;const Dt=It;const Yt=function(t,e,i){var a=-1,n=Tt,r=t.length,s=!0,o=[],h=o;if(i)s=!1,n=Rt;else if(r>=200){var c=e?null:Dt(t);if(c)return q(c);s=!1,n=k,h=new H}else h=e?[]:o;t:for(;++a<r;){var l=t[a],u=e?e(l):l;if(l=i||0!==l?l:0,s&&u===u){for(var d=h.length;d--;)if(h[d]===u)continue t;e&&h.push(u),o.push(l)}else n(h,u,i)||(h!==o&&h.push(u),o.push(l))}return o};var Zt=i(29533);const Gt=(0,Et.A)(function(t){return Yt((0,Wt.A)(t,1,Zt.A,!0))});var Ut=i(88981),zt=Math.min;const Xt=function(t,e,i){for(var a=i?Rt:Tt,n=t[0].length,r=t.length,s=r,o=Array(r),h=1/0,c=[];s--;){var l=t[s];s&&e&&(l=(0,p.A)(l,(0,Ut.A)(e))),h=zt(l.length,h),o[s]=!i&&(e||n>=120&&l.length>=120)?new H(s&&l):void 0}l=t[0];var u=-1,d=o[0];t:for(;++u<n&&c.length<h;){var g=l[u],f=e?e(g):g;if(g=i||0!==g?g:0,!(d?k(d,f):a(c,f,i))){for(s=r;--s;){var _=o[s];if(!(_?k(_,f):a(t[s],f,i)))continue t}d&&d.push(f),c.push(g)}}return c};const Vt=function(t){return(0,Zt.A)(t)?t:[]};const Qt=(0,Et.A)(function(t){var e=(0,p.A)(t,Vt);return e.length&&e[0]===t[0]?Xt(e):[]});var $t=i(41502);const Kt=10;class Jt{getFeatureShape(t,e,i,a){return a=a||"rectangle",this._ftLength=i,this._ftHeight=e,this._ftWidth=t*i,"function"!==typeof this["_"+a]&&(a="rectangle"),this["_"+a]()}static isContinuous(t){return"bridge"!==(t=t.toLowerCase())}_rectangle(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+"Z"}_roundRectangle(){return"M6,0h"+(this._ftWidth-12)+",0a6,6 0 0 1 6,6v"+(this._ftHeight-12)+"a6,6 0 0 1 "+"-6,6h"+(12-this._ftWidth)+"a6,6 0 0 1 "+"-6,"+"-6v"+(12-this._ftHeight)+"a6,6 0 0 1 6,"+"-6Z"}_line(){return"M0,".concat(this._ftHeight/2," L").concat(this._ftWidth,",").concat(this._ftHeight/2)}_bridge(){return 1!==this._ftLength?"M0,"+this._ftHeight+"L0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L"+this._ftWidth+",2L0,2Z":"M0,"+this._ftHeight+"L0,"+this._ftHeight/2+"L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth/2+",0L"+this._ftWidth/2+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight/2+"L"+this._ftWidth+","+this._ftHeight+"Z"}_getMiddleLine(t){return"M0,"+t+"L"+this._ftWidth+","+t+"Z"}_diamond(){const t=this._ftWidth/2,e="M"+t+",0L"+(t+5)+",5L"+t+","+"10L"+(t-5)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth):e+"Z"}_chevron(){const t=this._ftWidth/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+","+"10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==this._ftLength?e+"L"+t+",5"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_catFace(){const t=this._ftWidth/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+","+"10L"+(2+t)+","+"10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==this._ftLength?e+"M"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_triangle(){const t=this._ftWidth/2,e="M"+t+",0L"+(5+t)+","+"10L"+(-5+t)+","+Kt;return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_wave(){const t=this._ftWidth/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==this._ftLength?e+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getPolygon(t){let e="M ";const i=this._ftWidth/2;for(let a=0;a<t;a++)e+=5*Math.cos(2*Math.PI*a/t)+i+","+(5*Math.sin(2*Math.PI*a/t)+5)+" ";return 1!==this._ftLength?e+" "+(5*Math.cos(0)+i)+","+(5*Math.sin(0)+5)+" "+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_hexagon(){return this._getPolygon(6)}_pentagon(){return this._getPolygon(5)}_circle(){const t=this._ftWidth/2,e=Math.sqrt(Kt/Math.PI),i="M"+t+",0A"+e+","+e+" 0 1,1 "+t+","+"10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==this._ftLength?i+this._getMiddleLine(5,this._ftWidth)+"Z":i+"Z"}_arrow(){const t=this._ftWidth/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+this._ftHeight+"L"+t+","+this._ftHeight+"L"+(4+t)+",4";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_doubleBar(){const t=this._ftWidth/2,e="M"+t+",0L"+(-5+t)+","+"10L"+t+","+"10L"+(5+t)+",0";return 1!==this._ftLength?e+"L"+t+",0"+this._getMiddleLine(5,this._ftWidth)+"Z":e+"Z"}_getBrokenEnd(){const t=this._ftHeight/4;return"L"+(this._ftWidth-t)+","+t+"L"+this._ftWidth+","+2*t+"L"+(this._ftWidth-t)+","+3*t+"L"+this._ftWidth+","+this._ftHeight}_getBrokenStart(){const t=this._ftHeight/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t}_discontinuosStart(){return"M0,0L"+this._ftWidth+",0L"+this._ftWidth+","+this._ftHeight+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuos(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+this._getBrokenStart()+"Z"}_discontinuosEnd(){return"M0,0L"+this._ftWidth+",0"+this._getBrokenEnd()+"L0,"+this._ftHeight+"Z"}_helix(){const t=2.5;let e=2.5;const i=Math.round(this._ftWidth/5);let a="";for(let n=0;n<i;n++){a+="M"+(-2.5+e)+","+this._ftHeight+" C"+(e+t)+",7.5 "+(2.5+e)+","+t+" "+e+", 0 C"+(e-t)+","+t+" "+e+",7.5 "+(2.5+e)+","+this._ftHeight,e+=5}return a}_strand(){let t=0;this._ftWidth>5&&(t=this._ftWidth-5);const e=this._ftHeight/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+("M"+t+",0L"+this._ftWidth+","+2*e+"L"+t+","+this._ftHeight+"Z")}}class te{constructor(t){let{layoutHeight:e,padding:i=1,minHeight:a=17}=t;this._padding=i,this._minHeight=a,this._layoutHeight=e}init(t){this._features=t}getFeatureYPos(){const t=this.getFeatureHeight();return this._layoutHeight/2-t/2}getFeatureHeight(){return Math.min(this._layoutHeight,this._minHeight)-this._padding}}const ee=(t,e)=>e.some(e=>{return i=t,a=e,!(Number(a.start)>Number(i.end)||Number(a.end)<Number(i.start));var i,a});class ie extends te{constructor(t){super(t),this.featuresMap=new Map,this._rowHeight=0,this._rows=[],this._minHeight=15}init(t){t.forEach(t=>{const e=this._rows.findIndex(e=>!ee(t,e));e>=0?(this._rows[e].push(t),this.featuresMap.set(t,e)):(this._rows.push([t]),this.featuresMap.set(t,this._rows.length-1))}),this._rowHeight=Math.min(this._layoutHeight/this._rows.length,this._minHeight)}getOffset(){return this._rows.length*this._rowHeight<this._layoutHeight?this._layoutHeight/2-this._rows.length*this._rowHeight/2:0}getFeatureYPos(t){const e=this.featuresMap.get(t);return this.getOffset()+this._rowHeight*e+2*this._padding}getFeatureHeight(){return this._rowHeight-2*this._padding}}const ae={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},EPITOPE:{name:"epitope",label:"Epitopes",tooltip:"",shape:"rectangle",color:"#4ade33"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},ne=t=>{if(ae[t.toUpperCase()])return ae[t.toUpperCase()].shape;const e=Object.values(ae).find(e=>e.name.toUpperCase()===t.toUpperCase());return e?e.shape:"rectangle"},re=t=>{if(ae[t.toUpperCase()])return ae[t.toUpperCase()].color;const e=Object.values(ae).find(e=>e.name.toUpperCase()===t.toUpperCase());return e||console.log(t),e?e.color:"black"};class se extends $t.A{getLayout(){return"non-overlapping"===String(this.getAttribute("layout")).toLowerCase()?new ie({layoutHeight:this._height}):new te({layoutHeight:this._height})}connectedCallback(){super.connectedCallback(),this._color=this.getAttribute("color"),this._shape=this.getAttribute("shape"),this._featureShape=new Jt,this._layoutObj=this.getLayout(),this._data&&this._createTrack(),this.addEventListener("load",t=>{y(this.children,t.target)&&(this.data=t.detail.payload)})}static normalizeLocations(t){return t.map(t=>{const{locations:e,start:i,end:a}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:i,end:a}]}]})})}processData(t){this._originalData=se.normalizeLocations(t)}set data(t){this.processData(t),this._applyFilters(),this._layoutObj=this.getLayout(),this._createTrack()}set filters(t){this._filters=t,this._applyFilters(),this._createTrack()}static get observedAttributes(){return $t.A.observedAttributes.concat(["highlight","color","shape","filters"])}_getFeatureColor(t){return t.color?t.color:t.feature&&t.feature.color?t.feature.color:this._color?this._color:t.type?re(t.type):t.feature&&t.feature.type?re(t.feature.type):"black"}_getFeatureFillColor(t){return t.fill?t.fill:t.feature&&t.feature.fill?t.feature.fill:this._getFeatureColor(t)}_getShape(t){return t.shape?t.shape:t.feature&&t.feature.shape?t.feature.shape:this._shape?this._shape:t.type?ne(t.type):t.feature&&t.feature.type?ne(t.feature.type):"rectangle"}_createTrack(){this._layoutObj.init(this._data),(0,n.Ltv)(this).selectAll("div").remove(),this.svg=(0,n.Ltv)(this).append("div").style("line-height",0).append("svg").attr("width",this.width).attr("height",this._height),this.trackHighlighter.appendHighlightTo(this.svg),this.seq_g=this.svg.append("g").attr("class","sequence-features"),this._createFeatures()}_createFeatures(){this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data),this.locations=this.featuresG.enter().append("g").attr("class","feature-group").attr("id",t=>"g_".concat(t.accession)).selectAll("g.location-group").data(t=>t.locations.map(e=>Object.assign({},e,{feature:t}))).enter().append("g").attr("class","location-group");const t=this.locations.selectAll("g.fragment-group").data(t=>t.fragments.map(e=>Object.assign({},e,{feature:t.feature}))).enter().append("g").attr("class","fragment-group");t.append("path").attr("class",t=>"".concat(this._getShape(t)," feature")).attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(this._layoutObj.getFeatureYPos(t.feature),")")).attr("fill",t=>this._getFeatureFillColor(t)).attr("stroke",t=>this._getFeatureColor(t)).style("fill-opacity",t=>{let{feature:e}=t;return e.opacity?e.opacity:.9}).style("stroke-opacity",t=>{let{feature:e}=t;return e.opacity?e.opacity:.9});const e=t.selectAll("g.residue-group").data(t=>{var e;return t.feature.ptms?[null===(e=t.feature.ptms)||void 0===e?void 0:e.map(e=>Object.assign({},e,{feature:t.feature,position:e.position}))]:[]}).enter().append("g").attr("class","residue-group");t.append("rect").attr("class","outer-rectangle feature").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(this._layoutObj.getFeatureYPos(t.feature),")")).attr("fill","transparent").attr("stroke","transparent").call(this.bindEvents,this),e.selectAll("g.residue").data(t=>t).enter().append("path").attr("class",t=>"".concat(this._getShape(t)," residue")).attr("d",t=>{let e=1;return this.length>500&&(e=this.getSingleBaseWidth()<4?4:1),this._featureShape.getFeatureShape(this.getSingleBaseWidth()/2,this._layoutObj.getFeatureHeight(),e,this._getShape(t))}).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(Number(t.feature.start)+Number(t.position)-1)+this.getSingleBaseWidth()/4,",\n          ").concat(this._layoutObj.getFeatureYPos(t.feature),")")).attr("fill","#06038D").style("fill-opacity",t=>{let{feature:e}=t;return e.opacity?e.opacity:.9}).style("stroke-opacity",t=>{let{feature:e}=t;return e.opacity?e.opacity:.9}).call(this.bindEvents,this)}_applyFilters(){if(!this._filters||this._filters.length<=0)return void(this._data=this._originalData);const t=Nt(this._filters,"category"),e=Object.values(t).map(t=>{const e=t.map(t=>t.filterFn(this._originalData));return Gt(...e)}),i=Qt(...e);this._data=i}refresh(){if(this.xScale&&this.seq_g){const t=this.seq_g.selectAll("g.fragment-group").data(this._data.reduce((t,e)=>t.concat(e.locations.reduce((t,i)=>t.concat(i.fragments.map(t=>Object.assign({},t,{feature:e}))),[])),[])),e=this.seq_g.selectAll("g.residue-group").data(this._data.reduce((t,e)=>{var i;return t.concat([null===(i=e.ptms)||void 0===i?void 0:i.reduce(t=>t.concat(t=>Object.assign({},t,{feature:e,position:t.position})),[])])},[]));t.selectAll("path.feature").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t),t.end?t.end-t.start+1:1,this._getShape(t))).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(this._layoutObj.getFeatureYPos(t.feature),")")),e.selectAll("path.residue").attr("d",t=>{let e=1;return this.length>500&&(e=this.getSingleBaseWidth()<4?4:1),this._featureShape.getFeatureShape(this.getSingleBaseWidth()/2,this._layoutObj.getFeatureHeight(t),e,this._getShape(t))}).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(Number(t.feature.start)+Number(t.position)-1)+this.getSingleBaseWidth()/4,",").concat(this._layoutObj.getFeatureYPos(t.feature),")")),t.selectAll("rect.outer-rectangle").attr("width",t=>this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)).attr("height",t=>this._layoutObj.getFeatureHeight(t)).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(this._layoutObj.getFeatureYPos(t.feature),")")),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}const oe=se;class he extends te{init(t,e){let i=0;if(this.height={},this.yPos={},this.maxYPos=0,!t)return;this.innerPadding=3;const a={};for(let n=0;n<t.length;n++){const e=t[n];this.height[e.accession]=this.expanded?14:16,this.yPos[e.accession]=this._padding,i=this.height[e.accession]+2*this._padding,this.maxYPos=Math.max(this.maxYPos,i),e.accession in a||(a[e.accession]={}),e.residues&&(i=this._initResidues(e.residues,e.accession,e.locations,this.expanded?i:this.yPos[e.accession],n,a,this.expanded))}if(e)for(let n=0;n<e.length;n++){const t=e[n];t.accession in this.height||(this.height[t.accession]=10,this.yPos[t.accession]=(this.expanded?this.maxYPos:this.innerPadding)+this._padding,i+=2*this._padding+(this.expanded?this.height[t.accession]:0),this.maxYPos=Math.max(this.maxYPos,i)),t.accession in a||(a[t.accession]={}),t.residues&&(i=this._initResidues(t.residues,t.accession,t.locations,t.expanded?i:this.yPos[t.accession],n,a,t.expanded))}this.maxYPos+=this._padding}_initResidues(t,e,i,a,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];for(let o=0;o<t.length;o++){const h=t[o];he._filterOutResidueFragmentsOutOfLocation(h,i),h.accession in r[e]||(r[e][h.accession]={});for(let t=0;t<h.locations.length;t++){const i=h.locations[t].description;i in r[e][h.accession]||(r[e][h.accession][i]={height:s?10:this.height[e]-2*this.innerPadding,yPos:s?this.maxYPos+this._padding:a+this.innerPadding},a=s?this.maxYPos+2*this._padding+10:a),this.height["".concat(h.accession,"_").concat(n,"_").concat(o,"_").concat(t)]=r[e][h.accession][i].height,this.yPos["".concat(h.accession,"_").concat(n,"_").concat(o,"_").concat(t)]=r[e][h.accession][i].yPos,this.maxYPos=Math.max(this.maxYPos,a)}}return s?a:this.maxYPos+2*this._padding}static _filterOutResidueFragmentsOutOfLocation(t,e){t.locations.forEach(t=>t.fragments=t.fragments.filter(t=>e.some(e=>e.fragments.some(e=>t.start>=e.start&&t.end<=e.end)))),t.locations=t.locations.filter(t=>t.fragments.length)}static _getAccFromFeature(t){let e="";return"string"===typeof t?e=t:t.accession&&(e=t.accession),e}getFeatureYPos(t){const e=he._getAccFromFeature(t);return e in this.yPos?this.yPos[e]:0}getFeatureHeight(t){const e=he._getAccFromFeature(t);return e in this.height?this.height[e]:0}}const ce=(t,e)=>{let i=(0,a.A)({value:1},t);const n=[];for(const a of e)i?i.end<a.start?(n.push(i),i=null,n.push(a)):i.start<a.start&&i.end>=a.end?(n.push({start:i.start,end:a.start-1,value:i.value}),n.push({start:a.start,end:a.end,value:a.value+i.value}),i=a.end===i.end?null:{start:a.end+1,end:i.end,value:i.value}):a.start<i.start&&a.end>i.end?(n.push({start:a.start,end:i.start-1,value:a.value}),n.push({start:i.start,end:i.end,value:a.value+i.value}),n.push({start:i.end+1,end:a.end,value:a.value}),i=null):a.end>=i.start&&a.end<=i.end?(a.start<i.start&&n.push({start:a.start,end:i.start-1,value:a.value}),n.push({start:i.start,end:a.end,value:a.value+i.value}),i=a.end<i.end?{start:a.end+1,end:i.end,value:i.value}:null):i.end>=a.start&&i.end<a.end?(n.push({start:i.start,end:a.start-1,value:i.value}),n.push({start:a.start,end:i.end,value:a.value+i.value}),n.push({start:i.end+1,end:a.end,value:a.value}),i=null):n.push(a):n.push(a);return i&&n.push(i),n},le=2;class ue extends oe{_createTrack(){this._layoutObj.expanded=this._expanded,super._createTrack(),this.children_g=null}connectedCallback(){super.connectedCallback(),this._expanded=this.hasAttribute("expanded"),this._haveCreatedFeatures=!1}attributeChangedCallback(t,e,i){if("expanded"===t&&e!==i&&this._contributors)for(const a of this._contributors)a.expanded=!e;super.attributeChangedCallback(t,e,i)}set contributors(t){this._contributors=ue.normalizeLocations(t),this._coverage=function(t){let e=[];return(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e=ce({start:1,end:arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,value:0},e)),t.forEach(t=>t.locations.forEach(t=>t.fragments.forEach(t=>{e=ce(t,e)}))),e}(this._contributors,this._length),this._data&&this._createTrack()}getLayout(){return new he({layoutHeight:this._height,expanded:this._expanded,padding:2})}static get observedAttributes(){return oe.observedAttributes.concat(["expanded","color"])}set color(t){this._color!==t&&(this._color=t,this.refresh())}static _createResidueGroup(t){return t.selectAll("g.residues-group").data(t=>t.residues?t.residues.map((e,i)=>(0,a.A)((0,a.A)({},e),{},{feature:t,i:i})):[]).enter().append("g").attr("class","residues-group").selectAll("g.residues-locations").data(t=>t.locations.map((e,i)=>(0,a.A)((0,a.A)({},e),{},{accession:t.accession,feature:t.feature,location:e,i:t.i,j:i}))).enter().append("g").attr("class","residues-locations")}_createResiduePaths(t){return t.selectAll("g.residue").data(t=>t.fragments.map(e=>(0,a.A)((0,a.A)({},e),{},{accession:t.accession,feature:(0,a.A)((0,a.A)({},t.feature),{},{currentResidue:(0,a.A)((0,a.A)({},e),{},{description:t.location.description})}),location:t.location,k:t.feature.k,i:t.i,j:t.j}))).enter().append("path").attr("class","feature rectangle residue").attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight("".concat(t.accession,"_").concat(t.k,"_").concat(t.i,"_").concat(t.j)),t.end?t.end-t.start+1:1,"rectangle")).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(le+this._layoutObj.getFeatureYPos("".concat(t.accession,"_").concat(t.k,"_").concat(t.i,"_").concat(t.j)),")")).attr("fill",t=>this._getFeatureColor(t)).attr("stroke","transparent").call(this.bindEvents,this)}_refreshResiduePaths(t,e){const i=new Set(t.data().map(t=>"".concat(t.feature.accession,"-").concat(t.location.description))).size;t.attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight("".concat(t.accession,"_").concat(t.k,"_").concat(t.i,"_").concat(t.j)),t.end?t.end-t.start+1:1,"rectangle")).attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(le+this._layoutObj.getFeatureYPos("".concat(t.accession,"_").concat(t.k,"_").concat(t.i,"_").concat(t.j)),")")).style("pointer-events",t=>e||t.feature&&t.feature.expanded?"auto":"none").style("stroke",()=>e?null:"none").style("opacity",()=>e?null:.8/i).attr("fill",t=>e||t.feature&&t.feature.expanded?this._getFeatureColor(t):"white")}_createFeatures(){if(this._layoutObj.init(this._data,this._contributors),this._data.forEach((t,e)=>t.k=e),this.featuresG=this.seq_g.selectAll("g.feature-group").data(this._data).enter().append("g").attr("class","feature-group").attr("id",t=>"g_".concat(t.accession)),this.locations=this.featuresG.selectAll("g.location-group").data(t=>t.locations.map(e=>(0,a.A)((0,a.A)({},e),{},{feature:t}))).enter().append("g").attr("class","location-group"),this.coverLines=this.locations.selectAll("line.cover").data(t=>[t.fragments.reduce((e,i)=>({start:Math.min(e.start,i.start),end:Math.max(e.end,i.end),feature:t.feature}),{start:1/0,end:-1/0})]).enter().append("line").attr("class","cover"),this.features=this.locations.selectAll("path.feature").data(t=>t.fragments.map(e=>(0,a.A)((0,a.A)({},e),{},{feature:t.feature,fragments:t.fragments}))).enter().append("path").attr("class",t=>"".concat(this._getShape(t)," feature")).on("click.expanded",()=>{this._expanded?this.removeAttribute("expanded"):this.setAttribute("expanded","expanded")}).call(this.bindEvents,this),this.residues_g=ue._createResidueGroup(this.featuresG),this.residues_loc=this._createResiduePaths(this.residues_g),this._contributors){this._contributors.forEach((t,e)=>t.k=e),this.children_g||(this.children_g=this.svg.append("g").attr("class","children-features")),this.childrenGroup=this.children_g.append("g").attr("class","children-group"),this.childGroup=this.childrenGroup.selectAll("g.child-group").data(this._contributors).enter().append("g").attr("class","child-group");const t=this.childGroup.selectAll("g.child-location-group").data(t=>(t.expanded=this._expanded,t.locations.map(e=>(0,a.A)((0,a.A)({},e),{},{feature:t})))).enter().append("g").attr("class",(t,e)=>"child-location-group clg-".concat(e));this.coverLinesChildren=t.selectAll("line.cover").data(t=>[t.fragments.reduce((e,i)=>({start:Math.min(e.start,i.start),end:Math.max(e.end,i.end),feature:t.feature}),{start:1/0,end:-1/0})]).enter().append("line").attr("class","cover"),this.featureChildren=t.selectAll("path.child-fragment").data(t=>t.fragments.map(e=>(0,a.A)((0,a.A)({},e),{},{feature:t.feature,fragments:t.fragments}))).enter().append("path").attr("class",t=>"".concat(this._getShape(t)," child-fragment feature")).call(this.bindEvents,this).on("click.expanded",t=>{t.feature.expanded=!t.feature.expanded,this.refresh()}),this.child_residues_g=ue._createResidueGroup(this.childGroup),this.child_residues_loc=this._createResiduePaths(this.child_residues_g),this._coverage&&this._coverage.length&&this._createCoverage()}this.svg.attr("height",this._layoutObj.maxYPos),this._haveCreatedFeatures=!0}_createCoverage(){this._accession=this._data&&this._data[0]&&this._data[0].accession||"_",this.coverage_mask=this.svg.append("defs").append("mask").attr("id","mask-".concat(this._accession)),this.coverageMaskFragment=this.coverage_mask.selectAll("rect").data(this._coverage).enter().append("rect").attr("y",0).attr("height",this._height)}_refreshCoverage(){this.featuresG.attr("mask",this._expanded?null:"url(#mask-".concat(this._accession,")")),this.coverageMaskFragment.attr("x",t=>this.getXFromSeqPosition(t.start)).attr("width",t=>this.getSingleBaseWidth()*(t.end-t.start+1)).attr("fill","white").attr("opacity",t=>(t.value/this._contributors.length+.3)/1.3)}_refreshFeatures(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=new Set(t.data().map(t=>t.feature.accession)).size;t.attr("d",t=>this._featureShape.getFeatureShape(this.getSingleBaseWidth(),this._layoutObj.getFeatureHeight(t.feature),t.end?t.end-t.start+1:1,e?this._getShape(t.shape?t:t.feature):"rectangle")).attr("fill",t=>e?this._getFeatureColor(t.feature):"white").attr("opacity",e?1:.8/i).style("stroke",t=>e?this._getFeatureColor(t.feature):"none").attr("transform",t=>"translate(".concat(this.getXFromSeqPosition(t.start),",").concat(le+this._layoutObj.getFeatureYPos(t.feature),")")).style("pointer-events",e?"auto":"none")}_refreshCoverLine(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.attr("x1",t=>this.getXFromSeqPosition(t.start)).attr("x2",t=>this.getXFromSeqPosition(t.end+1)).attr("y1",t=>le+this._layoutObj.getFeatureYPos(t.feature)+this._layoutObj.getFeatureHeight(t.feature)/2).attr("y2",t=>le+this._layoutObj.getFeatureYPos(t.feature)+this._layoutObj.getFeatureHeight(t.feature)/2).attr("stroke",t=>this._getFeatureColor(t.feature)).attr("visibility",e?"visible":"hidden")}refresh(){this._haveCreatedFeatures&&(this._layoutObj.expanded=this._expanded,this._layoutObj.init(this._data,this._contributors),this.height=this._layoutObj.maxYPos,this._refreshCoverLine(this.coverLines),this._refreshFeatures(this.features),this._refreshResiduePaths(this.residues_loc,this._expanded),this._contributors&&(this.childrenGroup.attr("visibility",this._expanded?"visible":"hidden"),this._refreshCoverLine(this.coverLinesChildren,this._expanded),this._refreshFeatures(this.featureChildren,this._expanded),this.child_residues_g.attr("visibility",()=>this._expanded?"visible":"hidden"),this._refreshResiduePaths(this.child_residues_loc),this._coverage&&this._coverage.length&&this._refreshCoverage()),this._updateHighlight(),this.svg.attr("height",this._layoutObj.maxYPos))}}const de=ue}}]);
//# sourceMappingURL=protvista-interpro-track.354975c5.chunk.js.map