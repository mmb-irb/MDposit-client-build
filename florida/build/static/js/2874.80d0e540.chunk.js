"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[2527,2874],{10419:(e,n,t)=>{t.d(n,{A:()=>o});var a=t(65043),r=t(29449),c=t(66496);const o=()=>{const{chains:e,metadata:n,topology:t}=(0,a.useContext)(r.f),{file:o}=(0,a.useContext)(r.I);return(0,a.useMemo)((()=>{if(!t)return[];const a=[],r=n&&n.LIGANDS;if(n&&e){const r=n.CHAINNAMES;if(r)for(const n of e){const e=r[n];a.push({name:e?e+" (Chain "+n+")":"Chain "+n,selection:":"+n})}else{[{name:"Protein",selection:"protein"},{name:"Nucleic acids",selection:"nucleic"}].forEach((e=>{(0,c.w1)(e.selection,o)&&a.push(e)}))}t.chainNames.forEach((n=>{if(-1!==e.indexOf(n))return;if(t.getChainByName(n).residues.every((e=>"ligand"===e.referenceType)))return;const c=r&&r[n]||n;a.push({name:c,selection:":"+n,type:"licorice",color:"purple",opacity:.5})}))}else a.push({name:"Main structure"});if(r)for(const e of r)if("string"===typeof e){const n=t.getReferenceResidueIndices(e);if(!n||0===n.length)continue;const{rangedSelection:r}=t.residueIndices2Ngl(n);a.push({name:e,selection:r,type:"ball+stick",color:"element"})}else{if(!e.ngl)continue;a.push({name:e.name,selection:e.ngl,type:"licorice"})}const s=[];if(t.residueAtomIndices.forEach((e=>{e.length>1||s.push(e[0])})),s.length>0){const e="@"+s.join(",");a.push({name:"Ions",selection:e,type:"spacefill",color:"element"})}const i=[];a.forEach((e=>{const n=void 0===e.type||"cartoon"===e.type,t=(0,c.kn)(e.selection,n,o);i.push(...t)}));const l=t.residueCount,m=[];for(let e=0;e<l;e++)-1===i.indexOf(e)&&m.push(e);if(m.length>0){const{rangedSelection:e}=t.residueIndices2Ngl(m);a.push({name:"Other",selection:e,type:"licorice",color:"grey",opacity:.3})}return a}),[e,n,t,o])}},13826:(e,n,t)=>{t.r(n),t.d(n,{default:()=>_});var a=t(89379),r=t(65043),c=t(26494),o=t(85865),s=t(43845),i=t(58338),l=t(10939),m=t(17545),f=t(34088),u=t(10419),d=t(29449),p=t(95747),h=t(52527),g=t(507),y=t(24310),x=t(70579);const A={base:["First frame","Second frame"],interface:["First frame interface","Second frame interface"]},b={base:["red","blue"],interface:[["orange","yellow"],["purple","green"]]},_=()=>{const{accessionAndMdNumber:e,metadata:n,interactions:t,topology:_}=(0,r.useContext)(d.f),E=(0,r.useRef)(null),S=(0,u.A)(),[w,C]=(0,r.useState)(null),[N,j]=(0,r.useState)(0),v="".concat(p.nP,"/").concat(e,"/analyses/rmsd-pairwise/"),{loading:I,payload:M,error:F}=(0,i.A)(v),k=(0,r.useMemo)((()=>{if(!t)return[{name:"Overall"}];t.forEach((e=>{e.label=e.name+" (interface residues)"}));return[{name:"Overall"},...t]}),[t]),{rmsds:R,AxesValues:O}=(0,r.useMemo)((()=>{if(!M)return{};const e=k[N],t=M.data.find((n=>n.name===e.name));if(!t)throw new Error('Dataset for interaction "'.concat(e.name,'" not found'));const a=t.rmsds,r=a.length,c=Math.floor(n.mdFrames/(r-1));return{rmsds:a,AxesValues:Array(r).fill(void 0).map(((e,n)=>n*c))}}),[M,n,k,N]),[V,T]=(0,r.useState)(null);(0,r.useMemo)((()=>{if(!w)return T(null);T((e=>null===e?w.map(((e,n)=>({name:"".concat(n,". Frame ").concat(e),frame:e}))):(w.forEach(((n,t)=>{const a=e[t];a.name="".concat(t,". Frame ").concat(n),a.frame=n})),[...e])))}),[w]);const[D,L]=(0,r.useState)(null);return(0,r.useMemo)((()=>{if(!V)return L(null);const e=k[N],n=[{name:e.agent_1,interface:e.interface_indices_1},{name:e.agent_2,interface:e.interface_indices_2}];L((e=>{const t=[],r=N>0,c=!(!e||!e.find((e=>e.reference&&e.reference.includes(A.interface[0]))));return null===e?V.forEach(((e,n)=>{S.forEach((c=>{const o=(0,a.A)({},c);o.name="".concat(e.name," - ").concat(c.name),o.color=b.base[n],o.component=e.name,o.reference="".concat(A.base[n]," - ").concat(c.name),r&&(o.name+=" reference",o.opacity=.1),t.push(o)}))})):V.forEach(((n,a)=>{S.forEach((o=>{const s="".concat(A.base[a]," - ").concat(o.name),i=e.find((e=>e.reference===s));if(!i)throw new Error("No previous representation with reference ".concat(s));const l=i.name.split(" - ")[0];i.name=i.name.replace(l,n.name),i.component=n.name,r&&!c&&(i.name+=" reference",i.opacity=.1),!r&&c&&(i.name=i.name.replace(" reference",""),i.opacity=1),t.push(i)}))})),r&&(!1===c?V.forEach(((e,a)=>{n.forEach(((n,r)=>{const c=n.interface&&_.residueIndices2Ngl(n.interface);t.push({name:"".concat(e.name," - ").concat(n.name," interface"),color:b.interface[a][r],selection:c.rangedSelection,type:"licorice",component:e.name,reference:"".concat(A.interface[a]," - ").concat(n.name)})}))})):V.forEach(((a,r)=>{n.forEach((n=>{const c=n.interface&&_.residueIndices2Ngl(n.interface),o="".concat(A.interface[r]," - ").concat(n.name),s=e.find((e=>e.reference===o));s.name="".concat(a.name," - ").concat(n.name," interface"),s.selection=c.rangedSelection,s.component=a.name,t.push(s)}))}))),e&&e.filter((e=>e.custom)).forEach((e=>{e.component=V[0].name,t.push(e)})),t}))}),[V,_,k,N,S]),I?(0,x.jsx)(m.A,{}):F?F.toString():M?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(l.A,{children:(0,x.jsxs)(c.A,{className:h.default.horizontal,children:[(0,x.jsx)(o.A,{variant:"h6",children:"Residues selection:"}),(0,x.jsx)(g.A,{interactions:k,selectedInteraction:N,setSelectedInteraction:j}),w&&(0,x.jsxs)("div",{children:[V&&V.map(((e,n)=>(0,x.jsx)(s.A,{label:"Frame "+e.frame,style:{margin:"0.2em",backgroundColor:0===n?"red":"blue"}},n))),N>0&&V&&V.map(((e,n)=>{const t=k[N];return[t.agent_1,t.agent_2].map(((t,a)=>(0,x.jsx)(s.A,{label:"Frame "+e.frame+" - "+t,style:{margin:"0.2em",backgroundColor:0===a?0===n?"orange":"purple":0===n?"yellow":"green"}},a)))}))]})]})}),(0,x.jsx)(l.A,{className:h.default.margined,id:"heatmap",children:(0,x.jsx)(c.A,{children:(0,x.jsx)(y.A,{inputData:{data:R,xLabels:O,yLabels:O},onTooltip:e=>{let{value:n,xAxisValue:t,yAxisValue:a}=e;return"".concat(t," - ").concat(a,"\n").concat(Math.round(100*n)/100," \xc5")},onClick:e=>{let{xAxisValue:n,yAxisValue:t}=e;return C([n,t])},legendTitle:"RMSD (\xc5)",maxColor:"red",minColor:"blue",xTitle:"Frames",yTitle:"Frames"})})}),(0,x.jsx)(f.A,{newViewer:V?{componentsState:[V,T],representationsState:[D,L],selRef:w,viewerRef:E}:null,onNail:e=>C((n=>e.selRef===n?null:n)),onClose:e=>C((n=>e.selRef===n?null:n))})]}):"Something bad happened"}},52527:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});const a={widest:"style_widest__hZ7sO",margined:"style_margined__GphyO","margined-bottom":"style_margined-bottom__KpiYO",horizontal:"style_horizontal__1xLer"}}}]);
//# sourceMappingURL=2874.80d0e540.chunk.js.map