"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3283,3653],{10939:(e,t,s)=>{s.d(t,{A:()=>u});var n=s(65043),a=s(12110),r=s(17604);const i="style_container__M9GCG";var l=s(70579);const o={opacity:[0,1]};(0,r.A)()||(o.transform=["translateY(50px)","translateY(0)"]);const c={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},u=(0,n.forwardRef)(((e,t)=>{let{overrideComponent:s,...r}=e;const u=(0,n.useRef)(null);(0,n.useLayoutEffect)((()=>{const e=u.current&&u.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),s=e.animate(o,{...c,delay:150*t});return()=>s.cancel()}),[]);const d=s?"section":a.A;return(0,l.jsx)("div",{ref:u,className:i,children:(0,l.jsx)(d,{component:"section",...r,ref:t})})}))},13653:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var n=s(65043),a=s(83283),r=s(58338),i=s(41399),l=s(29449),o=s(95747),c=s(26494),u=s(85865),d=s(99070),h=s(10939),m=s(17545),f=s(12110),p=s(2260),y=s(32143);const g="style_card__NWa7X",x="style_content__eXhNP",v="style_horizontal-margined__w4tJp";var _=s(70579);const w=e=>{let{label:t,options:s,selection:n,setter:a}=e;if(!s)return"Missing options argument";if(!n)return"Missing selection argument";if(!a)return"Missing setter argument";return(0,_.jsx)(f.A,{className:g,children:(0,_.jsxs)(c.A,{className:x,children:[t&&(0,_.jsx)(u.A,{variant:"h5",children:t}),(0,_.jsx)(p.A,{value:n,onChange:e=>{a(e.target.value)},className:v,children:s.map(((e,t)=>(0,_.jsx)(y.A,{value:e,children:e},t)))})]})})};var b=s(34088),j=s(62598);const N=(0,n.lazy)((()=>Promise.all([s.e(2577),s.e(1483)]).then(s.bind(s,53099)))),A=()=>{const{accessionAndMdNumber:e,files:t}=(0,n.useContext)(l.f),[s,f]=(0,n.useState)(null),[p,y]=(0,n.useState)(14),[g,x]=(0,n.useState)(20),[v,A]=(0,n.useState)("Overall"),S=(0,r.A)(`${o.nP}/${e}/analyses/clusters`),M=(0,n.useMemo)((()=>S&&S.payload&&S.payload.map((e=>e.name))),[S]),C=(0,n.useMemo)((()=>{if(!S.payload)return;const e=S.payload.find((e=>e.name===v));if(!e)throw new Error(`Analysis ${v} is not found in the summary`);return e.analysis}),[v,S.payload]),z=C?`${o.nP}/${e}/analyses/${C}`:null,R=(0,r.A)(z),$=(0,n.useRef)(R.payload);(0,n.useMemo)((()=>{R.payload&&($.current=R.payload)}),[R.payload]);const k=$.current,q=(0,n.useMemo)((()=>{if(!C)return[];const s=`${C.replace("-","_")}_screenshot_`;return t.filter((e=>e.includes(s))).sort().map((t=>`${o.nP}/${e}/files/${t}`))}),[t,C]),P=(0,i.A)(q),D=P.some((e=>e.loading)),E=(0,n.useRef)(null);(0,n.useMemo)((()=>{D||(E.current=P.map((e=>e&&e.payload?"data:image/png;base64,"+Buffer.from(e.payload,"binary").toString("base64"):null)))}),[P,D]);const O=E.current,{graphData:F,availableLinks:I,clusterIndices:L,version:H,step:J}=(0,n.useMemo)((()=>{if(!k)return{};k.clusters.forEach(((e,t)=>{e.index=t}));const e=[...k.clusters].sort(((e,t)=>t.frames.length-e.frames.length)).slice(0,p),t=e.map((e=>e.main)),s=e.reduce(((e,t)=>e+t.frames.length),0),n=e.map((e=>e.frames.length/s)),a=e.map((e=>e.index)),r=n[0],i=[];n.forEach(((e,s)=>{const n=1e4*e/r,a={id:s,radius:Math.sqrt(n/Math.PI),value:t[s],text:`Population: ${Math.round(1e4*e)/100} %\nFrame: ${t[s]}`};i.push(a)}));const l=[],o=k.transitions.filter((e=>a.includes(e.from)&&a.includes(e.to))),c=o.length,u=o.sort(((e,t)=>t.count-e.count)),d=u.map((e=>e.count)),h=d[0],m=d[d.length-1],f=h===m?1:9/(m-h);u.forEach(((e,t)=>{if(t>=g)return;const s=a.indexOf(e.from);if(-1===s)throw new Error("Not found source cluster index");const n=a.indexOf(e.to);if(-1===n)throw new Error("Not found target cluster index");const r=10-(e.count-h)*f,i=l.find((e=>e.source===n&&e.target===s));if(i)i.width+=r;else{const e={source:s,target:n,width:r};l.push(e)}}));const y=new j.Rx(k.version),x=k.step;return{graphData:{nodes:i,links:l},availableLinks:c,clusterIndices:a,version:y,step:x}}),[k,p,g]),Y=(0,n.useMemo)((()=>{if(L&&O)return L.map((e=>O[e]))}),[L,O]),T=(0,n.useCallback)((e=>{const t=H.equals("0.0")?e.value*J:e.value;f(t)}),[f,H,J]);return k?Y?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(w,{label:"Clusters analysis",options:M,selection:v,setter:A}),(0,_.jsx)(h.A,{children:(0,_.jsxs)("div",{className:R.loading?a.default.disabled:a.default.enabled,children:[(0,_.jsx)(N,{data:F,images:Y,selectedNodeValue:s,onSelectNode:T,className:a.default.graph}),(0,_.jsxs)(c.A,{children:[(0,_.jsxs)("div",{className:a.default.horizontal,children:[(0,_.jsx)(u.A,{variant:"h7",className:a.default.wide25,children:"Number of nodes: "}),(0,_.jsx)(d.Ay,{title:"Change number of nodes",value:p,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{y(t)},min:2,max:k.clusters.length,valueLabelDisplay:"auto",className:a.default.wide75})]}),(0,_.jsxs)("div",{className:a.default.horizontal,children:[(0,_.jsx)(u.A,{variant:"h7",className:a.default.wide25,children:"Number of links: "}),(0,_.jsx)(d.Ay,{title:"Change the RMSD cutoff",value:g,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{x(t)},min:0,max:I,valueLabelDisplay:"auto",className:a.default.wide75})]})]})]})}),(0,_.jsx)(b.A,{newViewer:s?{requestedFrame:s}:null,onNail:e=>f((t=>e.requestedFrame===t?null:t)),onClose:e=>f((t=>e.requestedFrame===t?null:t))})]}):(0,_.jsx)(m.A,{}):R.loading?(0,_.jsx)(m.A,{}):R.error?R.error.toString():"Something bad happened"}},34088:(e,t,s)=>{s.d(t,{A:()=>h});var n=s(65043),a=s(43126),r=s(10939);const i="style_rnd__Txifm",l="style_floating-card__HHpby";var o=s(70579);const c=(0,n.lazy)((()=>Promise.all([s.e(7784),s.e(8095),s.e(3845),s.e(2629),s.e(9070),s.e(2594),s.e(7955),s.e(349),s.e(1235),s.e(9117)]).then(s.bind(s,92428))));let u=0;const d=e=>{const t=e.viewerRef||(0,n.useRef)(null),[s,d]=(0,n.useState)((()=>{const{innerWidth:e,innerHeight:t,scrollY:s}=window,n=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,t/4),150),r=1.5*a;return{width:2*a,height:r,x:0,y:t-n-r-20+s}}));return(0,o.jsx)(a.p,{position:{x:s.x,y:s.y},size:{width:s.width,height:s.height},style:{zIndex:(u+=1,u)},className:i,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{d({...s})},onResizeStart:()=>{d({...s})},onDragStop:(e,t)=>{0===e.layerX&&0===e.layerY||s.x===t.x&&s.y===t.y||d({...s,x:t.x,y:t.y})},onResize:()=>t.current&&t.current.autoResize(),onResizeStop:(e,t,s,n,a)=>{d({width:s.style.width,height:s.style.height,...a})},children:(0,o.jsx)(r.A,{className:l,elevation:4,children:(0,o.jsx)(n.Suspense,{fallback:null,children:(0,o.jsx)(c,{className:l,ref:t,startsPlaying:!1,...e})})})})},h=e=>{let{newViewer:t,nailing:s=!0,onNail:a,onClose:r}=e;const[i,l]=(0,n.useState)([]),c=[...i],u=(0,n.useRef)([]);if(t){const e=()=>{let e=0;for(;e<999;){if(-1===u.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};t.id=e(),t.close=()=>{s&&l((e=>{const s=[...e],n=e.indexOf(t);return-1!==n&&s.splice(n,1),s})),r&&r(t),u.current.push(t.id)},s&&(t.nail=()=>{l((e=>[...e,t])),a&&a(t),u.current.push(t.id)}),c.push(t)}return c.map((e=>(0,o.jsx)(d,{...e},e.id)))}},62598:(e,t,s)=>{s.d(t,{JH:()=>a,Rx:()=>o,Wd:()=>r,s5:()=>l,wC:()=>i});var n=s(62629);const a=e=>JSON.parse(JSON.stringify(e)),r=e=>e.reduce(((e,t)=>e+t),0)/e.length,i=e=>Math.round(100*e)/100,l=e=>{const t=[];for(let s=0;s<e;s++){const a=n.Ay.hcl(s/e*360,80,70).css();t.push(a)}return t};class o{constructor(e){void 0===e&&(e="0.0.0");const t=e.split(".");this.major=t[0]&&+t[0],this.minor=t[1]&&+t[1],this.patch=t[2]&&+t[2]}toString(){let e=this.major.toString();return void 0===this.minor?e:(e+="."+this.minor.toString(),void 0===this.patch||(e+="."+this.patch.toString()),e)}equals(e){return"string"===typeof e?this.equals(new o(e)):e.major===this.major&&((void 0===e.minor||e.minor===this.minor)&&(void 0===e.patch||e.patch===this.patch))}}},83283:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});const n={graph:"style_graph__Q1ja5",horizontal:"style_horizontal__makgF",wide25:"style_wide25__KqdCT",wide75:"style_wide75__p0NKz",enabled:"style_enabled__ndc27",disabled:"style_disabled__s5ohr"}}}]);
//# sourceMappingURL=3653.f316158a.chunk.js.map