"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3960,5919,9117],{50953:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var s=a(89379),n=a(65043),r=a(89257),l=a(85865),o=a(32577),c=a(10939),d=a(92428),i=a(10419),u=a(17545),p=a(58338),h=a(29449),m=a(95747),g=a(63960),x=a(82746),f=a(48838),y=a(75291),b=a(70579);const A={triggerOnce:!0,rootMargin:"100px"},S=["grey","yellow","red"],C=e=>Math.round(100*e)/100,M=()=>{const[e,t]=(0,r.Wx)(A),{accessionAndMdNumber:a,metadata:M,topology:j,populations:_}=(0,n.useContext)(h.f),k=(0,i.A)(),R=(0,n.useRef)(null),v=(0,n.useRef)(null),{loading:T,payload:w,error:N}=(0,p.A)("".concat(m.nP,"/").concat(a,"/analyses/rmsd-perres/")),[D,E]=(0,n.useState)([]),{components:F,representations:L,analysisFrameCount:I,xAxisStep:P,xAxisLabel:W,isEnsemble:G,xTooltip:V,data:Y,xWeights:q}=(0,n.useMemo)((()=>{if(!j||!M||!w||_&&_.loading)return{};const e=w.rmsdpr,t=[],n=[];e.forEach((e=>{if(null===e)t.push(null),n.push(null);else{const[a,s]=(e=>{const t=e.length,a=e.reduce(((e,t)=>e+t))/t,s=Math.sqrt(e.map((e=>Math.pow(e-a,2))).reduce(((e,t)=>e+t))/t);return[C(a),C(s)]})(e);t.push(a),n.push(s)}}));const r={rmsdpr:e,means:t,stdvs:n},l=Math.max(...t),c=Math.min(...t),d=(0,o.m4Y)().range(S).domain([c,(c+l)/2,l]),i=x.ColormakerRegistry.addScheme((function(e){this.atomColor=e=>{const a=e.residueIndex,s=t[a];if(null===s)return 16777215;const n=(0,o.yWT)(d(s)).formatHex();return parseInt(n.substring(1),16)}})),u=M.mdFrames,p=w.step,h="".concat(m.nP,"/").concat(a,"/trajectory"),g=[{trajectoryURLs:["".concat(h,"?frames=1:").concat(u,":").concat(p)]}],f=[];k.forEach((e=>{const t=(0,s.A)({},e);t.color="custom",t.customScheme=i,f.push(t)}));const y=e[0].length,b=M.timeLength,A="ensemble"===M.TYPE;let R,v,T,N;if(A||!b?(R=p,v="Frames",T=e=>"frame "+e):(R=b/(y-1),v="Time (ns)",T=e=>+e.toFixed(2)+" ns"),_&&_.payload){N=[];for(let e=0;e<_.payload.length;e+=R)N.push(_.payload[e])}return{components:g,representations:f,analysisFrameCount:y,xAxisStep:R,xAxisLabel:v,isEnsemble:A,xTooltip:T,data:r,xWeights:N}}),[w,j,M,a,k,_]),{selectedData:B,selectedResidueIndices:H}=(0,n.useMemo)((()=>{const e={},t=[];return D.forEach(((a,s)=>{const n={data:Y.rmsdpr[a.index]};n.color=a.color,e[s]=n,t.push(a.index)})),{selectedData:e,selectedResidueIndices:t}}),[Y,D]),J=(0,n.useCallback)((e=>{R.current.togglePlaying(!1),R.current.currentFrame=e}),[]),K=(0,n.useCallback)((e=>{if(!v.current)return;const t=Math.round(e*(I-1));v.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]}),[I]),O=(0,n.useCallback)(((e,t,a)=>{const s={color:a,index:t};E((e=>[...e,s]))}),[E]),U=(0,n.useCallback)(((e,t)=>{E((e=>e.filter((e=>e.index!==t))))}),[E]),Z=(0,n.useCallback)((()=>{E([])}),[E]),z=(0,n.useCallback)(((e,t)=>{const a=Y.means[t],s=Y.stdvs[t],n=Math.round(100*a)/100,r=Math.round(100*s)/100;return"Mean RMSD: ".concat(n,"\nStandard deviation: ").concat(r)}),[Y]);return T||_&&_.loading?(0,b.jsx)(u.A,{}):N?N.toString():_&&_.error?_.error.toString():w?_&&!_.payload?"Something bad happened with populations":j?(0,b.jsxs)(n.Suspense,{fallback:(0,b.jsx)(u.A,{}),children:[(0,b.jsx)(c.A,{children:(0,b.jsx)(f.A,{residueValues:Y.means,legendTitle:"Average RMSD (\xc5)",onSelect:O,onDeselect:U,onClean:Z,onTooltip:z})}),(0,b.jsx)(c.A,{className:g.default.graphcard,children:D.length>0?(0,b.jsx)(y.default,{yData:B,step:P,xAxisLabel:W,type:G?"dots":"line",xWeights:q,xTooltip:V,yAxisLabel:"RMSd (\xc5)",onSelect:J,className:g.default.graph,ref:v}):(0,b.jsx)("div",{className:g.default["graph-placeholder"],children:(0,b.jsx)(l.A,{variant:"h6",children:"No residue selected"})})}),(0,b.jsx)(c.A,{className:g.default.nglcard,ref:e,children:t?(0,b.jsx)(d.default,{className:g.default.container,startingComponents:F,startingRepresentations:L,selectedResidueIndices:H,onProgress:K,ref:R,framesSelect:!1}):(0,b.jsx)("div",{style:{height:"50vh"}})})]}):(0,b.jsx)(u.A,{}):"Something bad happened with the analysis data"}},63960:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});const s={graphcard:"style_graphcard__VoJ6R",graph:"style_graph__GoAAc","graph-placeholder":"style_graph-placeholder__bh3Kw",nglcard:"style_nglcard__Zr+kp",container:"style_container__lBCpG"}}}]);
//# sourceMappingURL=5919.20def3dd.chunk.js.map