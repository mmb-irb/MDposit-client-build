"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[1502],{5753:(t,e,i)=>{i.d(e,{rb:()=>u,eX:()=>d,xG:()=>g,Hu:()=>c,Zd:()=>m});class n{constructor(){let{min:t=-1/0,max:e=1/0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.segments=[],this.max=e,this.min=t,this.regionString=null}encode(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.segments.map((e=>{let{start:i,end:n,color:s}=e;if(t)return"".concat(i,":").concat(n).concat(s?":".concat(s):"");const r=i===this.min?"":i,o=n===this.max?"":n;return"".concat(r,":").concat(o).concat(s?":".concat(s):"")})).join(",")}decode(t){"undefined"!==typeof t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map((t=>{const[e,i,n,s]=t.split(":");if("undefined"!==typeof s)throw new Error("there should be at most 2 ':' per region. Region: ".concat(t));let r=e?Number(e):this.min,o=i?Number(i):this.max;const h=""!==n?n:void 0;if(r>o&&([r,o]=[o,r]),r<this.min&&(r=this.min),o>this.max&&(o=this.max),Number.isNaN(r))throw new Error("The parsed value of ".concat(e," is NaN. Region: ").concat(t));if(Number.isNaN(o))throw new Error("The parsed value of ".concat(i," is NaN. Region: ").concat(t));if(h&&!h.match(/^#[0-9a-f]{6,8}$/i))throw new Error("The parsed value of ".concat(n," is not a color in hex format. Region: ").concat(t));return{start:r,end:o,color:h}})):this.segments=[]}}const s="#FFEB3B66",r=(t,e)=>t?e?"".concat(t,",").concat(e):t:e;const o=t=>t;const h=["left","right","top","bottom"],a=h.map((t=>"margin".concat(t))),l=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{initialValue:{top:0,bottom:0,left:0,right:0}};class i extends t{constructor(){super(),this.margin=e.initialValue}static get observedAttributes(){return[...super.observedAttributes,...a]}attributeChangedCallback(t,e,i){e!==i&&a.includes(t)&&(this[t]=i),super.attributeChangedCallback(t,e,i)}}for(const n of h)Object.defineProperty(i.prototype,"margin".concat(n),{get(){return this.margin[n]||0},set(t){this.margin[n]=+t}});return i},c=class{constructor(t){let{element:e,min:i,max:r}=t;this.element=e,this.element._highlightcolor=s,this.region=new n({min:i,max:r}),this.fixedHighlight=null}set max(t){this.region.max=t}setAttributesInElement(){this.region.decode(this.element.getAttribute("highlight")),0===this.region.segments.length&&(this.element._highlightstart=Number(this.element.getAttribute("highlightstart")),this.element._highlightend=Number(this.element.getAttribute("highlightend")),this.element._highlightcolor=this.element.getAttribute("highlightcolor")||s,null!==this.element._highlightstart&&null!==this.element._highlightend&&"number"===typeof this.element._highlightstart&&"number"===typeof this.element._highlightend&&(this.element._highlight="".concat(this.element._highlightstart,":").concat(this.element._highlightend),this.region.decode(r(this.fixedHighlight,this.element._highlight))))}setFloatAttribute(t,e){const i=parseFloat(e);this.element["_".concat(t)]=Number.isNaN(i)?e:i}changedCallBack(t,e){switch(t){case"highlightstart":case"highlightend":this.setFloatAttribute(t,e),this.element._highlight=Number.isNaN(this.element._highlightstart)||Number.isNaN(this.element._highlightend)||void 0===this.element._highlightstart||void 0===this.element._highlightend||null===this.element._highlightstart||null===this.element._highlightend?"":"".concat(Math.max(this.region.min,this.element._highlightstart),":").concat(Math.min(this.region.max,this.element._highlightend));break;default:this.element._highlight=e}this.region.decode(r(this.fixedHighlight,this.element._highlight)),this.element.refresh()}setFixedHighlight(t){this.fixedHighlight=t,this.region.decode(r(t,this.element._highlight)),this.element.refresh()}appendHighlightTo(t){this.highlighted=t.append("g").attr("class","highlighted")}updateHighlight(){const t=this.highlighted.selectAll("rect").data(this.region.segments);t.enter().append("rect").style("pointer-events","none").merge(t).attr("fill",(t=>t.color?t.color:this.element._highlightcolor)).attr("height",this.element._height).attr("x",(t=>this.element.getXFromSeqPosition(t.start))).attr("width",(t=>this.element.getSingleBaseWidth()*(t.end-t.start+1))),t.exit().remove()}},u=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=[],i=[];if(null!==t&&"string"!==typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){const n=t.split(",").map((t=>t.split(":")));if(n.length<2)throw new Error("There should be at least 2 points to create a scale");e=n.map((t=>{const e=t[0].trim().toUpperCase();if(!function(t){const e=document.createElement("div");return e.style.borderColor="",e.style.borderColor=t,""!==e.style.borderColor}(e))throw new Error("The color '".concat(e," is not valid'"));return e})),i=n.map(((t,e)=>{const i=parseFloat(t[1]);if(Number.isNaN(i))throw new Error("The second part of every point should be a number. Error in point ".concat(e,": ").concat(t));return i}))}return{range:e,domain:i}},g=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,{keyFormatter:e=o,valueFormatter:i=o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==t&&"string"!==typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){const n=t.split(",").map((t=>t.split(":"))),s={};return n.forEach((t=>{if(2!==t.length)throw new Error("Bad block: ".concat(t.join(":"),"\n The blocks of the string should follow the format KEY:VALUE"));s[e(t[0])]=i(t[1])})),s}return{}},d=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;this.element=t,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null,this.scrollDelay=e}setElementScrollable(t){this.element.setAttribute("scrollable",t)}startResetScrollableTimer(){this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout((()=>{this.setElementScrollable(!0),this.resetScrollableTimeout=null}),this.scrollDelay)}blockScroll(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}wheel(t){let{target:e,timeStamp:i}=t;this.element.contains(e)?i<this.timeStampWheelOutside+this.scrollDelay?this.blockScroll(i):this.setElementScrollable(!0):this.blockScroll(i)}},m=l},41502:(t,e,i)=>{i.d(e,{A:()=>k});var n=i(32577),s=i(5753),r=function(){if("undefined"!==typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var s=n[i];t.call(e,s[1],s[0])}},e}()}(),o="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,h="undefined"!==typeof i.g&&i.g.Math===Math?i.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),a="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(h):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var l=["top","right","bottom","left","width","height","size","weight"],c="undefined"!==typeof MutationObserver,u=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,s=0;function r(){i&&(i=!1,t()),n&&h()}function o(){a(r)}function h(){var t=Date.now();if(i){if(t-s<2)return;n=!0}else i=!0,n=!1,setTimeout(o,e);s=t}return h}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){o&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){o&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;l.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),g=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var s=n[i];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},d=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||h},m=y(0,0,0,0);function f(t){return parseFloat(t)||0}function p(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+f(t["border-"+i+"-width"])}),0)}function _(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return m;var n=d(t).getComputedStyle(t),s=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var s=n[i],r=t["padding-"+s];e[s]=f(r)}return e}(n),r=s.left+s.right,o=s.top+s.bottom,h=f(n.width),a=f(n.height);if("border-box"===n.boxSizing&&(Math.round(h+r)!==e&&(h-=p(n,"left","right")+r),Math.round(a+o)!==i&&(a-=p(n,"top","bottom")+o)),!function(t){return t===d(t).document.documentElement}(t)){var l=Math.round(h+r)-e,c=Math.round(a+o)-i;1!==Math.abs(l)&&(h-=l),1!==Math.abs(c)&&(a-=c)}return y(s.left,s.top,h,a)}var b="undefined"!==typeof SVGGraphicsElement?function(t){return t instanceof d(t).SVGGraphicsElement}:function(t){return t instanceof d(t).SVGElement&&"function"===typeof t.getBBox};function v(t){return o?b(t)?function(t){var e=t.getBBox();return y(0,0,e.width,e.height)}(t):_(t):m}function y(t,e,i,n){return{x:t,y:e,width:i,height:n}}var w=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=v(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),E=function(t,e){var i=function(t){var e=t.x,i=t.y,n=t.width,s=t.height,r="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(r.prototype);return g(o,{x:e,y:i,width:n,height:s,top:i,right:e+n,bottom:s+i,left:e}),o}(e);g(this,{target:t,contentRect:i})},x=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new r,"function"!==typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof d(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new w(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof d(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new E(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),S="undefined"!==typeof WeakMap?new WeakMap:new r,A=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=u.getInstance(),n=new x(e,i,this);S.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){A.prototype[t]=function(){var e;return(e=S.get(this))[t].apply(e,arguments)}}));const T="undefined"!==typeof h.ResizeObserver?h.ResizeObserver:A;class O extends HTMLElement{constructor(){super(),O._polyfillElementClosest(),this._updateScaleDomain=this._updateScaleDomain.bind(this),this._initZoom=this._initZoom.bind(this),this.zoomed=this.zoomed.bind(this),this._applyZoomTranslation=this.applyZoomTranslation.bind(this),this._resetEventHandler=this._resetEventHandler.bind(this);let t=!1;this.applyZoomTranslation=()=>{t||(t=!0,requestAnimationFrame((()=>{t=!1,this._applyZoomTranslation()})))},this._onResize=this._onResize.bind(this),this._listenForResize=this._listenForResize.bind(this),this.trackHighlighter=new s.Hu({element:this,min:1}),this.scrollFilter=new s.eX(this),this.wheelListener=t=>this.scrollFilter.wheel(t)}connectedCallback(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth,this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=this.getAttribute("length")?parseFloat(this.getAttribute("length")):0,this._displaystart=this.getAttribute("displaystart")?parseFloat(this.getAttribute("displaystart")):1,this._displayend=this.getAttribute("displayend")?parseFloat(this.getAttribute("displayend")):this.length,this._height=this.getAttribute("height")?Number(this.getAttribute("height")):44,this._highlightEvent=this.getAttribute("highlight-event")?this.getAttribute("highlight-event"):"onclick",this.trackHighlighter.setAttributesInElement(this),this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this._initZoom(),this._listenForResize(),this.addEventListener("error",(t=>{console.error(t)})),"none"!==this._highlightEvent&&this.addEventListener("click",this._resetEventHandler),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0})}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro?this._ro.unobserve(this):window.removeEventListener("resize",this._onResize),"none"!==this._highlightEvent&&this.removeEventListener("click",this._resetEventHandler),document.removeEventListener("wheel",this.wheelListener)}get width(){return this._width}set width(t){this._width=t}set height(t){this._height=t}get height(){return this._height}set length(t){this._length=t,this.trackHighlighter.max=t}get length(){return this._length}get xScale(){return this._xScale}set xScale(t){this._xScale=t}get zoom(){return this._zoom}set svg(t){this._svg=t,t.call(this._zoom),this.applyZoomTranslation()}get svg(){return this._svg}set fixedHighlight(t){this.trackHighlighter.setFixedHighlight(t)}getWidthWithMargins(){return this.width?this.width-this.margin.left-this.margin.right:0}_updateScaleDomain(){this.xScale=(0,n.m4Y)().domain([1,this._length+1]).range([0,this.getWidthWithMargins()])}_initZoom(){this._zoom=(0,n.s_O)().scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]).extent([[0,0],[this.getWidthWithMargins(),0]]).filter((()=>{if(!(n.f0J instanceof WheelEvent))return!0;if(this.hasAttribute("no-scroll"))return!1;if(this.hasAttribute("filter-scroll")){const t=this.getAttribute("scrollable");if(t)return"true"===t}return!this.hasAttribute("use-ctrl-to-zoom")||n.f0J.ctrlKey})).on("zoom",this.zoomed)}static get observedAttributes(){return["displaystart","displayend","length","highlight"]}setFloatAttribute(t,e){const i=parseFloat(e);this["_".concat(t)]=Number.isNaN(i)?e:i}attributeChangedCallback(t,e,i){if("null"===i&&(i=null),e!==i){if(t.startsWith("highlight"))return void this.trackHighlighter.changedCallBack(t,i);this.setFloatAttribute(t,i),"length"===t&&(this._updateScaleDomain(),this._originXScale=this.xScale.copy()),this.applyZoomTranslation()}}zoomed(){if(this.xScale=n.f0J.transform.rescaleX(this._originXScale),this.dontDispatch)return;const[t,e]=this.xScale.domain();this.dispatchEvent(new CustomEvent("change",{detail:{displaystart:Math.max(1,t),displayend:Math.min(this.length,Math.max(e-1,t+1))},bubbles:!0,cancelable:!0}))}applyZoomTranslation(){if(!this.svg||!this._originXScale)return;const t=Math.max(1,this.length/(1+this._displayend-this._displaystart)),e=-this._originXScale(this._displaystart);this.dontDispatch=!0,this.svg.call(this.zoom.transform,n.GSI.scale(t).translate(e,0)),this.dontDispatch=!1,this.refresh()}_onResize(){this.width=this.offsetWidth,this._updateScaleDomain(),this._originXScale=this.xScale.copy(),this.svg&&this.svg.attr("width",this.width),this._zoom.scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]),this.applyZoomTranslation()}_listenForResize(){this._ro=new T(this._onResize),this._ro.observe(this)}_resetEventHandler(t){t.target.closest(".feature")||this.dispatchEvent(this.createEvent("reset",null,!0))}getXFromSeqPosition(t){return this.margin.left+this.xScale(t)}getSingleBaseWidth(){return this.xScale(2)-this.xScale(1)}static _getClickCoords(){return n.f0J?[n.f0J.pageX,n.f0J.pageY]:null}static _polyfillElementClosest(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=t=>{let e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null})}createEvent(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0;e&&(e=e.feature?e.feature:e);const a={eventtype:t,coords:O._getClickCoords(),feature:e,target:h};return i&&(e&&e.fragments?a.highlight=e.fragments.map((t=>"".concat(t.start,":").concat(t.end))).join(","):n.f0J&&n.f0J.shiftKey&&this._highlight?a.highlight="".concat(this._highlight,",").concat(r,":").concat(o):a.highlight=r&&o?"".concat(r,":").concat(o):null),s&&(a.selectedid=e&&e.protvistaFeatureId),new CustomEvent("change",{detail:a,bubbles:!0,cancelable:!0})}bindEvents(t,e){t.on("mouseover",((t,i,n)=>{e.dispatchEvent(e.createEvent("mouseover",t,"onmouseover"===e._highlightEvent,!1,t.start,t.end,n[i]))})).on("mouseout",(()=>{e.dispatchEvent(e.createEvent("mouseout",null,"onmouseover"===e._highlightEvent))})).on("click",((t,i,n)=>{e.dispatchEvent(e.createEvent("click",t,"onclick"===e._highlightEvent,!0,t.start,t.end,n[i]))}))}}const k=(0,s.Zd)(O,{initialValue:{top:10,right:10,bottom:10,left:10}})}}]);
//# sourceMappingURL=1502.4a720608.chunk.js.map