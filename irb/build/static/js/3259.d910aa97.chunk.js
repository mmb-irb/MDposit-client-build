"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3259,7732,9117],{23621:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var a=t(89379),n=t(65043),l=t(89257),r=t(85865),o=t(32577),c=t(10939),i=t(92428),d=t(10419),u=t(17545),p=t(58338),h=t(29449),f=t(95747),m=t(27732),g=t(82746),x=t(48838),y=t(75291),b=t(70579);const A={triggerOnce:!0,rootMargin:"100px"},S=["grey","yellow","red"],C={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},k=()=>{const[e,s]=(0,l.Wx)(A),{accession:t,accessionAndMdNumber:k,metadata:v,topology:j,populations:_}=(0,n.useContext)(h.f),R=(0,d.A)(),M=(0,n.useRef)(null),N=(0,n.useRef)(null),{loading:T,payload:I,error:w}=(0,p.A)("".concat(f.nP,"/").concat(k,"/analyses/sasa/")),[E,L]=(0,n.useState)([]),{components:P,representations:D,framesNumber:F,xAxisStep:W,xAxisLabel:H,isEnsemble:B,xTooltip:Y,xWeights:G,data:O}=(0,n.useMemo)((()=>{if(!j||!v||!I||_&&_.loading)return{};const e=j.residueCount;if(e!==I.saspf.length)throw new Error("Number of residues in the analysis does not match number of residues in the topology");const s={saspf:[],means:[],stdvs:[]};for(let a=0;a<e;a++){1===j.getResidueByIndex(a).atomCount?(s.saspf[a]=null,s.means[a]=null,s.stdvs[a]=null):(s.saspf[a]=I.saspf[a],s.means[a]=I.means[a],s.stdvs[a]=I.stdvs[a])}let t;for(let a=0;a<e;a++)if(s.saspf[a]){if(void 0!==t){t=null;break}t=a}null!==t&&L([{color:"black",index:t}]);const n=s.means,l=Math.max(...n),r=Math.min(...n),c=(0,o.m4Y)().range(S).domain([r,(r+l)/2,l]),i=g.ColormakerRegistry.addScheme((function(e){this.atomColor=e=>{const s=e.residueIndex;if(1===j.getResidueByIndex(s).atomCount)return 16777215;const t=n[s];if(null===t)return 16777215;const a=(0,o.yWT)(c(t)).formatHex();return parseInt(a.substring(1),16)}})),d=I.step,u="".concat(f.nP,"/").concat(k,"/files/trajectory"),p=[{trajectoryURLs:["".concat(u,"?frames=1:").concat(v.mdFrames,":").concat(d)]}],h=[];R.forEach((e=>{const s=(0,a.A)({},e);s.color="custom",s.customScheme=i,s.type="spacefill",h.push(s)}));const m=s.saspf[0].length,x=v.timeLength,y="ensemble"===v.TYPE;let b,A,C,M;if(y||!x?(b=d,A="Frames",C=e=>"frame "+e):(b=x/(m-1),A="Time (ns)",C=e=>+e.toFixed(2)+" ns"),_&&_.payload){M=[];for(let e=0;e<_.payload.length;e+=b)M.push(_.payload[e])}return{components:p,representations:h,framesNumber:m,xAxisStep:b,xAxisLabel:A,isEnsemble:y,xTooltip:C,xWeights:M,data:s}}),[I,j,v,t,R,_,L]),{selectedData:U,selectedResidueIndices:V}=(0,n.useMemo)((()=>{const e={},s=[];return E.forEach(((t,a)=>{const n={data:O.saspf[t.index]};n.color=t.color,e[a]=n,s.push(t.index)})),{selectedData:e,selectedResidueIndices:s}}),[O,E]),q=(0,n.useCallback)((e=>{M.current.togglePlaying(!1),M.current.currentFrame=e}),[]),z=(0,n.useCallback)((e=>{if(!N.current)return;const s=Math.round(e*(F-1));N.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]}),[F]),J=(0,n.useCallback)(((e,s,t)=>{const a={color:t,index:s};L((e=>[...e,a]))}),[L]),K=(0,n.useCallback)(((e,s)=>{L((e=>e.filter((e=>e.index!==s))))}),[L]),Q=(0,n.useCallback)((()=>{L([])}),[L]),X=(0,n.useCallback)(((e,s)=>{const t=O.means[s],a=O.stdvs[s],n=Math.round(100*t)/100,l=Math.round(100*a)/100;return"Mean SAS: ".concat(n,"\nStandard deviation: ").concat(l)}),[O]);return T||_&&_.loading?(0,b.jsx)(u.A,{}):w?w.toString():_&&_.error?_.error.toString():I?_&&!_.payload?"Something bad happened with populations":j&&v?(0,b.jsxs)(n.Suspense,{fallback:(0,b.jsx)(u.A,{}),children:[j.residueCount>1&&(0,b.jsx)(c.A,{children:(0,b.jsx)(x.A,{residueValues:O.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:J,onDeselect:K,onClean:Q,onTooltip:X})}),(0,b.jsx)(c.A,{className:m.default.graphcard,children:E.length>0?(0,b.jsx)(y.default,{yData:U,step:W,xAxisLabel:H,yAxisLabel:"Relative SAS (\xc5\xb2)",type:B?"dots":"line",xWeights:G,xTooltip:Y,onSelect:q,className:m.default.graph,ref:N}):(0,b.jsx)("div",{className:m.default["graph-placeholder"],children:(0,b.jsx)(r.A,{variant:"h6",children:"No residue selected"})})}),(0,b.jsx)(c.A,{className:m.default.nglcard,ref:e,children:s?(0,b.jsx)(i.default,{className:m.default.container,startingComponents:P,startingRepresentations:D,selectedResidueIndices:V,onProgress:z,ref:M,framesSelect:!1,highlightTypes:C}):(0,b.jsx)("div",{style:{height:"50vh"}})})]}):(0,b.jsx)(u.A,{}):"Something bad happened"}},27732:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});const a={graphcard:"style_graphcard__Cgh8H",graph:"style_graph__rikGP","graph-placeholder":"style_graph-placeholder__ef29F",nglcard:"style_nglcard__lD0br",container:"style_container__lvt9H"}}}]);
//# sourceMappingURL=3259.d910aa97.chunk.js.map