"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3283,3653],{10939:(e,t,n)=>{n.d(t,{A:()=>d});var s=n(65043),a=n(12110),r=n(17604);const l="style_container__M9GCG";var i=n(70579);const o={opacity:[0,1]};(0,r.A)()||(o.transform=["translateY(50px)","translateY(0)"]);const u={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},d=(0,s.forwardRef)(((e,t)=>{let{overrideComponent:n,...r}=e;const d=(0,s.useRef)(null);(0,s.useLayoutEffect)((()=>{const e=d.current&&d.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),n=e.animate(o,{...u,delay:150*t});return()=>n.cancel()}),[]);const c=n?"section":a.A;return(0,i.jsx)("div",{ref:d,className:l,children:(0,i.jsx)(c,{component:"section",...r,ref:t})})}))},13653:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var s=n(65043),a=n(83283),r=n(58338),l=n(41399),i=n(29449),o=n(95747),u=n(26494),d=n(85865),c=n(99070),h=n(10939),m=n(17545),f=n(12110),p=n(2260),y=n(32143);const g="style_card__NWa7X",x="style_content__eXhNP",_="style_horizontal-margined__w4tJp";var v=n(70579);const b=e=>{let{label:t,options:n,selection:s,setter:a}=e;if(!n)return"Missing options argument";if(!s)return"Missing selection argument";if(!a)return"Missing setter argument";return(0,v.jsx)(f.A,{className:g,children:(0,v.jsxs)(u.A,{className:x,children:[t&&(0,v.jsx)(d.A,{variant:"h5",children:t}),(0,v.jsx)(p.A,{value:s,onChange:e=>{a(e.target.value)},className:_,children:n.map(((e,t)=>(0,v.jsx)(y.A,{value:e,children:e},t)))})]})})};var w=n(34088),j=n(70068);const N=(0,s.lazy)((()=>Promise.all([n.e(2577),n.e(1483)]).then(n.bind(n,53099)))),A=()=>{const{accessionAndMdNumber:e,files:t}=(0,s.useContext)(i.f),[n,f]=(0,s.useState)(null),[p,y]=(0,s.useState)(14),[g,x]=(0,s.useState)(20),[_,A]=(0,s.useState)("Overall"),M=(0,r.A)(`${o.nP}/${e}/analyses/clusters`),S=(0,s.useMemo)((()=>M&&M.payload&&M.payload.map((e=>e.name))),[M]),z=(0,s.useMemo)((()=>{if(!M.payload)return;const e=M.payload.find((e=>e.name===_));if(!e)throw new Error(`Analysis ${_} is not found in the summary`);return e.analysis}),[_,M.payload]),C=z?`${o.nP}/${e}/analyses/${z}`:null,R=(0,r.A)(C),$=(0,s.useRef)(R.payload);(0,s.useMemo)((()=>{R.payload&&($.current=R.payload)}),[R.payload]);const k=$.current,P=(0,s.useMemo)((()=>{if(!z)return[];const n=`${z.replace("-","_")}_screenshot_`;return t.filter((e=>e.includes(n))).sort().map((t=>`${o.nP}/${e}/files/${t}`))}),[t,z]),q=(0,l.A)(P),D=q.some((e=>e.loading)),E=(0,s.useRef)(null);(0,s.useMemo)((()=>{D||(E.current=q.map((e=>e&&e.payload?"data:image/png;base64,"+Buffer.from(e.payload,"binary").toString("base64"):null)))}),[q,D]);const F=E.current,{graphData:I,availableLinks:L,clusterIndices:O,version:Y,step:H}=(0,s.useMemo)((()=>{if(!k)return{};k.clusters.forEach(((e,t)=>{e.index=t}));const e=[...k.clusters].sort(((e,t)=>t.frames.length-e.frames.length)).slice(0,p),t=e.map((e=>e.main)),n=e.reduce(((e,t)=>e+t.frames.length),0),s=e.map((e=>e.frames.length/n)),a=e.map((e=>e.index)),r=s[0],l=[];s.forEach(((e,n)=>{const s=1e4*e/r,a={id:n,radius:Math.sqrt(s/Math.PI),value:t[n],text:`Population: ${Math.round(1e4*e)/100} %\nFrame: ${t[n]}`};l.push(a)}));const i=[],o=k.transitions.filter((e=>a.includes(e.from)&&a.includes(e.to))),u=o.length,d=o.sort(((e,t)=>t.count-e.count)),c=d.map((e=>e.count)),h=c[0],m=c[c.length-1],f=h===m?1:9/(m-h);d.forEach(((e,t)=>{if(t>=g)return;const n=a.indexOf(e.from);if(-1===n)throw new Error("Not found source cluster index");const s=a.indexOf(e.to);if(-1===s)throw new Error("Not found target cluster index");const r=10-(e.count-h)*f,l=i.find((e=>e.source===s&&e.target===n));if(l)l.width+=r;else{const e={source:n,target:s,width:r};i.push(e)}}));const y=new j.Rx(k.version),x=k.step;return{graphData:{nodes:l,links:i},availableLinks:u,clusterIndices:a,version:y,step:x}}),[k,p,g]),T=(0,s.useMemo)((()=>{if(O&&F)return O.map((e=>F[e]))}),[O,F]),V=(0,s.useCallback)((e=>{const t=Y.equals("0.0")?e.value*H:e.value;f(t)}),[f,Y,H]);return k?T?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(b,{label:"Clusters analysis",options:S,selection:_,setter:A}),(0,v.jsx)(h.A,{children:(0,v.jsxs)("div",{className:R.loading?a.default.disabled:a.default.enabled,children:[(0,v.jsx)(N,{data:I,images:T,selectedNodeValue:n,onSelectNode:V,className:a.default.graph}),(0,v.jsxs)(u.A,{children:[(0,v.jsxs)("div",{className:a.default.horizontal,children:[(0,v.jsx)(d.A,{variant:"h7",className:a.default.wide25,children:"Number of nodes: "}),(0,v.jsx)(c.Ay,{title:"Change number of nodes",value:p,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{y(t)},min:2,max:k.clusters.length,valueLabelDisplay:"auto",className:a.default.wide75})]}),(0,v.jsxs)("div",{className:a.default.horizontal,children:[(0,v.jsx)(d.A,{variant:"h7",className:a.default.wide25,children:"Number of links: "}),(0,v.jsx)(c.Ay,{title:"Change the RMSD cutoff",value:g,"aria-labelledby":"continuous-slider",onChange:(e,t)=>{x(t)},min:0,max:L,valueLabelDisplay:"auto",className:a.default.wide75})]})]})]})}),(0,v.jsx)(w.A,{newViewer:n?{requestedFrame:n}:null,onNail:e=>f((t=>e.requestedFrame===t?null:t)),onClose:e=>f((t=>e.requestedFrame===t?null:t))})]}):(0,v.jsx)(m.A,{}):R.loading?(0,v.jsx)(m.A,{}):R.error?R.error.toString():"Something bad happened"}},34088:(e,t,n)=>{n.d(t,{A:()=>h});var s=n(65043),a=n(43126),r=n(10939);const l="style_rnd__Txifm",i="style_floating-card__HHpby";var o=n(70579);const u=(0,s.lazy)((()=>Promise.all([n.e(7784),n.e(8095),n.e(3845),n.e(9070),n.e(2594),n.e(7955),n.e(7240),n.e(1235),n.e(9117)]).then(n.bind(n,92428))));let d=0;const c=e=>{const t=e.viewerRef||(0,s.useRef)(null),[n,c]=(0,s.useState)((()=>{const{innerWidth:e,innerHeight:t,scrollY:n}=window,s=document.querySelector("main").offsetTop,a=Math.max(Math.min(e/4,t/4),150),r=1.5*a;return{width:2*a,height:r,x:0,y:t-s-r-20+n}}));return(0,o.jsx)(a.p,{position:{x:n.x,y:n.y},size:{width:n.width,height:n.height},style:{zIndex:(d+=1,d)},className:l,"data-rnd":!0,bounds:"window",cancel:"canvas, [data-popover], #preventDragSize, .prevent-drag",onDragStart:()=>{c({...n})},onResizeStart:()=>{c({...n})},onDragStop:(e,t)=>{0===e.layerX&&0===e.layerY||n.x===t.x&&n.y===t.y||c({...n,x:t.x,y:t.y})},onResize:()=>t.current&&t.current.autoResize(),onResizeStop:(e,t,n,s,a)=>{c({width:n.style.width,height:n.style.height,...a})},children:(0,o.jsx)(r.A,{className:i,elevation:4,children:(0,o.jsx)(s.Suspense,{fallback:null,children:(0,o.jsx)(u,{className:i,ref:t,startsPlaying:!1,...e})})})})},h=e=>{let{newViewer:t,nailing:n=!0,onNail:a,onClose:r}=e;const[l,i]=(0,s.useState)([]),u=[...l],d=(0,s.useRef)([]);if(t){const e=()=>{let e=0;for(;e<999;){if(-1===d.current.indexOf(e))return e;e+=1}console.error("Maximum number of viewers reached")};t.id=e(),t.close=()=>{n&&i((e=>{const n=[...e],s=e.indexOf(t);return-1!==s&&n.splice(s,1),n})),r&&r(t),d.current.push(t.id)},n&&(t.nail=()=>{i((e=>[...e,t])),a&&a(t),d.current.push(t.id)}),u.push(t)}return u.map((e=>(0,o.jsx)(c,{...e},e.id)))}},83283:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});const s={graph:"style_graph__Q1ja5",horizontal:"style_horizontal__makgF",wide25:"style_wide25__KqdCT",wide75:"style_wide75__p0NKz",enabled:"style_enabled__ndc27",disabled:"style_disabled__s5ohr"}}}]);
//# sourceMappingURL=3653.125f65bf.chunk.js.map