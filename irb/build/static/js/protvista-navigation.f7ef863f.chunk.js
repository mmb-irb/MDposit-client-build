"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[5874],{6843:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});var s=i(32577),h=i(5753);class r extends HTMLElement{constructor(){super(),this._x=null,this._padding=0,this.height=40,this.dontDispatch=!1}_refreshWidth(){this.style.display="block",this.style.width="100%",this.width=this.offsetWidth-this.margin.left-this.margin.right,this.width>0&&(this._padding=10)}connectedCallback(){this._refreshWidth(),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this._length=parseFloat(this.getAttribute("length")),this._displaystart=parseFloat(this.getAttribute("displaystart"))||1,this._displayend=parseFloat(this.getAttribute("displayend"))||this._length,this._highlightStart=parseFloat(this.getAttribute("highlightStart")),this._highlightEnd=parseFloat(this.getAttribute("highlightEnd")),this._rulerstart=parseFloat(this.getAttribute("rulerStart"))||1,this._onResize=this._onResize.bind(this),this._createNavRuler()}disconnectedCallback(){this.manager&&this.manager.unregister(this),this._ro&&this._ro.unobserve(this),window.removeEventListener("resize",this._onResize)}static get observedAttributes(){return["length","displaystart","displayend","highlightStart","highlightEnd","width","rulerstart"]}attributeChangedCallback(t,e,i){e!==i&&(this["_".concat(t)]=parseFloat(i),this._updateNavRuler())}get width(){return this._width}set width(t){this._width=t}_createNavRuler(){this._x=(0,s.m4Y)().range([this._padding,this.width-this._padding]),this._x.domain([this._rulerstart,this._rulerstart+this._length-1]),(0,s.Ltv)(this).selectAll("div").remove(),this._container=(0,s.Ltv)(this).append("div").attr("class","container"),this._svg=this._container.append("svg").attr("id","").attr("width",this.width).attr("height",this.height),this._xAxis=(0,s.l78)(this._x),this._displaystartLabel=this._svg.append("text").attr("class","start-label").attr("x",0).attr("y",this.height-this._padding),this._displayendLabel=this._svg.append("text").attr("class","end-label").attr("x",this.width).attr("y",this.height-this._padding).attr("text-anchor","end"),this._axis=this._svg.append("g").attr("class","x axis").call(this._xAxis),this._viewport=(0,s.n55)().extent([[this._padding,0],[this.width-this._padding,.51*this.height]]).on("brush",(()=>{s.f0J.selection&&(this._displaystart=(0,s.GPZ)("d")(this._x.invert(s.f0J.selection[0])),this._displayend=(0,s.GPZ)("d")(this._x.invert(s.f0J.selection[1])),this.dontDispatch||this.dispatchEvent(new CustomEvent("change",{detail:{displayend:this._displayend,displaystart:this._displaystart,extra:{transform:s.f0J.transform}},bubbles:!0,cancelable:!0})),this._updateLabels(),this._updatePolygon())})),this._brushG=this._svg.append("g").attr("class","brush").call(this._viewport),this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.polygon=this._svg.append("polygon").attr("class","zoom-polygon").attr("fill","#777").attr("fill-opacity","0.3"),this._updateNavRuler(),"ResizeObserver"in window&&(this._ro=new ResizeObserver(this._onResize),this._ro.observe(this)),window.addEventListener("resize",this._onResize)}_onResize(){this._refreshWidth(),this._x=this._x.range([this._padding,this.width-this._padding]),this._svg.attr("width",this.width),this._viewport.extent([[this._padding,0],[this.width-this._padding,.51*this.height]]),this._brushG.call(this._viewport),this._updateNavRuler()}_updateNavRuler(){this._x&&(this._container.style("padding-left","".concat(this.margin.left,"px")).style("padding-right","".concat(this.margin.right,"px")).style("padding-top","".concat(this.margin.top,"px")).style("padding-bottom","".concat(this.margin.bottom,"px")),this._x.domain([this._rulerstart,this._rulerstart+this._length-1]),this._axis.call(this._xAxis),this._updatePolygon(),this._updateLabels(),this._brushG&&(this.dontDispatch=!0,this._brushG.call(this._viewport.move,[this._x(this._displaystart),this._x(this._displayend)]),this.dontDispatch=!1))}_updateLabels(){this._displaystartLabel&&this._displaystartLabel.text(this._displaystart),this._displayendLabel&&this._displayendLabel.attr("x",this.width).text(this._displayend)}_updatePolygon(){this.polygon&&this.polygon.attr("points","".concat(this._x(this._displaystart),",").concat(this.height/2,"\n        ").concat(this._x(this._displayend),",").concat(this.height/2,"\n        ").concat(this.width,",").concat(this.height,"\n        0,").concat(this.height))}}const n=(0,h.Zd)(r)},5753:(t,e,i)=>{i.d(e,{rb:()=>d,eX:()=>m,xG:()=>c,Hu:()=>g,Zd:()=>p});class s{constructor(){let{min:t=-1/0,max:e=1/0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.segments=[],this.max=e,this.min=t,this.regionString=null}encode(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.segments.map((e=>{let{start:i,end:s,color:h}=e;if(t)return"".concat(i,":").concat(s).concat(h?":".concat(h):"");const r=i===this.min?"":i,n=s===this.max?"":s;return"".concat(r,":").concat(n).concat(h?":".concat(h):"")})).join(",")}decode(t){"undefined"!==typeof t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map((t=>{const[e,i,s,h]=t.split(":");if("undefined"!==typeof h)throw new Error("there should be at most 2 ':' per region. Region: ".concat(t));let r=e?Number(e):this.min,n=i?Number(i):this.max;const a=""!==s?s:void 0;if(r>n&&([r,n]=[n,r]),r<this.min&&(r=this.min),n>this.max&&(n=this.max),Number.isNaN(r))throw new Error("The parsed value of ".concat(e," is NaN. Region: ").concat(t));if(Number.isNaN(n))throw new Error("The parsed value of ".concat(i," is NaN. Region: ").concat(t));if(a&&!a.match(/^#[0-9a-f]{6,8}$/i))throw new Error("The parsed value of ".concat(s," is not a color in hex format. Region: ").concat(t));return{start:r,end:n,color:a}})):this.segments=[]}}const h="#FFEB3B66",r=(t,e)=>t?e?"".concat(t,",").concat(e):t:e;const n=t=>t;const a=["left","right","top","bottom"],l=a.map((t=>"margin".concat(t))),o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{initialValue:{top:0,bottom:0,left:0,right:0}};class i extends t{constructor(){super(),this.margin=e.initialValue}static get observedAttributes(){return[...super.observedAttributes,...l]}attributeChangedCallback(t,e,i){e!==i&&l.includes(t)&&(this[t]=i),super.attributeChangedCallback(t,e,i)}}for(const s of a)Object.defineProperty(i.prototype,"margin".concat(s),{get(){return this.margin[s]||0},set(t){this.margin[s]=+t}});return i},g=class{constructor(t){let{element:e,min:i,max:r}=t;this.element=e,this.element._highlightcolor=h,this.region=new s({min:i,max:r}),this.fixedHighlight=null}set max(t){this.region.max=t}setAttributesInElement(){this.region.decode(this.element.getAttribute("highlight")),0===this.region.segments.length&&(this.element._highlightstart=Number(this.element.getAttribute("highlightstart")),this.element._highlightend=Number(this.element.getAttribute("highlightend")),this.element._highlightcolor=this.element.getAttribute("highlightcolor")||h,null!==this.element._highlightstart&&null!==this.element._highlightend&&"number"===typeof this.element._highlightstart&&"number"===typeof this.element._highlightend&&(this.element._highlight="".concat(this.element._highlightstart,":").concat(this.element._highlightend),this.region.decode(r(this.fixedHighlight,this.element._highlight))))}setFloatAttribute(t,e){const i=parseFloat(e);this.element["_".concat(t)]=Number.isNaN(i)?e:i}changedCallBack(t,e){switch(t){case"highlightstart":case"highlightend":this.setFloatAttribute(t,e),this.element._highlight=Number.isNaN(this.element._highlightstart)||Number.isNaN(this.element._highlightend)||void 0===this.element._highlightstart||void 0===this.element._highlightend||null===this.element._highlightstart||null===this.element._highlightend?"":"".concat(Math.max(this.region.min,this.element._highlightstart),":").concat(Math.min(this.region.max,this.element._highlightend));break;default:this.element._highlight=e}this.region.decode(r(this.fixedHighlight,this.element._highlight)),this.element.refresh()}setFixedHighlight(t){this.fixedHighlight=t,this.region.decode(r(t,this.element._highlight)),this.element.refresh()}appendHighlightTo(t){this.highlighted=t.append("g").attr("class","highlighted")}updateHighlight(){const t=this.highlighted.selectAll("rect").data(this.region.segments);t.enter().append("rect").style("pointer-events","none").merge(t).attr("fill",(t=>t.color?t.color:this.element._highlightcolor)).attr("height",this.element._height).attr("x",(t=>this.element.getXFromSeqPosition(t.start))).attr("width",(t=>this.element.getSingleBaseWidth()*(t.end-t.start+1))),t.exit().remove()}},d=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=[],i=[];if(null!==t&&"string"!==typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){const s=t.split(",").map((t=>t.split(":")));if(s.length<2)throw new Error("There should be at least 2 points to create a scale");e=s.map((t=>{const e=t[0].trim().toUpperCase();if(!function(t){const e=document.createElement("div");return e.style.borderColor="",e.style.borderColor=t,""!==e.style.borderColor}(e))throw new Error("The color '".concat(e," is not valid'"));return e})),i=s.map(((t,e)=>{const i=parseFloat(t[1]);if(Number.isNaN(i))throw new Error("The second part of every point should be a number. Error in point ".concat(e,": ").concat(t));return i}))}return{range:e,domain:i}},c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,{keyFormatter:e=n,valueFormatter:i=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==t&&"string"!==typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){const s=t.split(",").map((t=>t.split(":"))),h={};return s.forEach((t=>{if(2!==t.length)throw new Error("Bad block: ".concat(t.join(":"),"\n The blocks of the string should follow the format KEY:VALUE"));h[e(t[0])]=i(t[1])})),h}return{}},m=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;this.element=t,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null,this.scrollDelay=e}setElementScrollable(t){this.element.setAttribute("scrollable",t)}startResetScrollableTimer(){this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout((()=>{this.setElementScrollable(!0),this.resetScrollableTimeout=null}),this.scrollDelay)}blockScroll(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}wheel(t){let{target:e,timeStamp:i}=t;this.element.contains(e)?i<this.timeStampWheelOutside+this.scrollDelay?this.blockScroll(i):this.setElementScrollable(!0):this.blockScroll(i)}},p=o}}]);
//# sourceMappingURL=protvista-navigation.f7ef863f.chunk.js.map