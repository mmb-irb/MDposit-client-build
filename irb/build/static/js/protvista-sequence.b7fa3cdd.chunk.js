"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[1307],{77665:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});var i=s(32577),a=s(41502);class h extends a.A{connectedCallback(){super.connectedCallback(),this.sequence=this.getAttribute("sequence");const t=this.getAttribute("numberofticks");this.numberOfTicks=Number.isInteger(parseInt(t,10))?t:3,this.sequence&&this._createSequence(),this.addEventListener("load",(t=>{this.data=t.detail.payload}))}static get observedAttributes(){return a.A.observedAttributes.concat("highlightstart","highlightend")}get data(){return this.sequence}set data(t){"string"===typeof t?this.sequence=t:"sequence"in t&&(this.sequence=t.sequence),this.sequence&&!super.svg?this._createSequence():this.refresh()}_getCharSize(){if(!this.seq_g)return;const t=this.seq_g.select("text.base").node();if(t)this.chWidth=.8*t.getBBox().width,this.chHeight=1.6*t.getBBox().height;else{const t=this.seq_g.append("text").attr("class","base").text("T");this.chWidth=.8*t.node().getBBox().width,this.chHeight=1.6*t.node().getBBox().height,t.remove()}}_createSequence(){(0,i.Ltv)(this).selectAll("div").remove(),super.svg=(0,i.Ltv)(this).append("div").attr("class","").append("svg").attr("id","").attr("width",this.width).attr("height",this._height),this.seq_bg=super.svg.append("g").attr("class","background"),this.axis=super.svg.append("g").attr("class","x axis"),this.seq_g=super.svg.append("g").attr("class","sequence").attr("transform","translate(0,".concat(.75*this._height,")")),this.trackHighlighter.appendHighlightTo(this.svg),this.refresh()}refresh(){if(this._getCharSize(),this.axis){const t=this.getSingleBaseWidth(),e=t-this.chWidth,s=t/2,a=Math.round(Math.max(0,this._displaystart-2)),h=Math.round(Math.min(this.sequence.length,this._displayend+1)),r=e<0?[]:this.sequence.slice(a,h).split("").map(((t,e)=>({start:1+a+e,end:1+a+e,aa:t})));this.height>this.chHeight&&(this.xAxis=(0,i.l78)(this.xScale).tickFormat((t=>Number.isInteger(t)?t:"")).ticks(this.numberOfTicks,"s"),this.axis.call(this.xAxis)),this.axis.attr("transform","translate(".concat(this.margin.left+s,",0)")),this.axis.select(".domain").remove(),this.axis.selectAll(".tick line").remove(),this.bases=this.seq_g.selectAll("text.base").data(r,(t=>t.start)),this.bases.enter().append("text").attr("class","base").attr("text-anchor","middle").attr("x",(t=>this.getXFromSeqPosition(t.start)+s)).text((t=>t.aa)).style("pointer-events","none").style("font-family","monospace"),this.bases.exit().remove(),this.bases.attr("x",(t=>this.getXFromSeqPosition(t.start)+s)),this.background=this.seq_bg.selectAll("rect.base_bg").data(r,(t=>t.start)),this.background.enter().append("rect").attr("class","base_bg feature").attr("height",this._height).merge(this.background).attr("width",t).attr("fill",(t=>Math.round(t.start)%2?"#ccc":"#eee")).attr("x",(t=>this.getXFromSeqPosition(t.start))).call(this.bindEvents,this),this.background.exit().remove(),this.seq_g.style("opacity",Math.min(1,e)),this.background.style("opacity",Math.min(1,e)),this._updateHighlight()}}_updateHighlight(){this.trackHighlighter.updateHighlight()}}const r=h}}]);
//# sourceMappingURL=protvista-sequence.b7fa3cdd.chunk.js.map