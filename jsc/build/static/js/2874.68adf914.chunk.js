"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[2527,2874],{10419:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(65043),a=t(29449),o=t(66496);const s=()=>{const{chains:e,metadata:n,topology:t}=(0,r.useContext)(a.f),{file:s}=(0,r.useContext)(a.I);return(0,r.useMemo)((()=>{if(!t)return[];const r=[],a=n&&n.LIGANDS;if(n&&e){const a=n.CHAINNAMES;if(a)for(const n of e){const e=a[n];r.push({name:e?e+" (Chain "+n+")":"Chain "+n,selection:":"+n})}else{[{name:"Protein",selection:"protein"},{name:"Nucleic acids",selection:"nucleic"}].forEach((e=>{(0,o.w1)(e.selection,s)&&r.push(e)}))}t.chainNames.forEach((n=>{if(-1!==e.indexOf(n))return;if(t.getChainByName(n).residues.every((e=>"ligand"===e.referenceType)))return;const o=a&&a[n]||n;r.push({name:o,selection:":"+n,type:"licorice",color:"purple",opacity:.5})}))}else r.push({name:"Main structure"});if(a)for(const e of a)if("string"===typeof e){const n=t.getReferenceResidueIndices(e);if(!n||0===n.length)continue;const{rangedSelection:a}=t.residueIndices2Ngl(n);r.push({name:e,selection:a,type:"ball+stick",color:"element"})}else{if(!e.ngl)continue;r.push({name:e.name,selection:e.ngl,type:"licorice"})}const i=[];if(t.residueAtomIndices.forEach((e=>{e.length>1||i.push(e[0])})),i.length>0){const e="@"+i.join(",");r.push({name:"Ions",selection:e,type:"spacefill",color:"element"})}const c=[];r.forEach((e=>{const n=void 0===e.type||"cartoon"===e.type,t=(0,o.kn)(e.selection,n,s);c.push(...t)}));const l=t.residueCount,m=[];for(let e=0;e<l;e++)-1===c.indexOf(e)&&m.push(e);if(m.length>0){const{rangedSelection:e}=t.residueIndices2Ngl(m);r.push({name:"Other",selection:e,type:"licorice",color:"grey",opacity:.3})}return r}),[e,n,t,s])}},13826:(e,n,t)=>{t.r(n),t.d(n,{default:()=>_});var r=t(65043),a=t(26494),o=t(85865),s=t(43845),i=t(58338),c=t(10939),l=t(17545),m=t(34088),u=t(10419),f=t(29449),d=t(95747),p=t(52527),h=t(507),g=t(24310),y=t(70579);const x=["First frame","Second frame"],A=["First frame interface","Second frame interface"],$={base:["red","blue"],interface:[["orange","yellow"],["purple","green"]]},_=()=>{const{accessionAndMdNumber:e,metadata:n,interactions:t,topology:_}=(0,r.useContext)(f.f),b=(0,r.useRef)(null),E=(0,u.A)(),[S,w]=(0,r.useState)(null),[C,N]=(0,r.useState)(0),j=`${d.nP}/${e}/analyses/rmsd-pairwise/`,{loading:v,payload:I,error:M}=(0,i.A)(j),F=(0,r.useMemo)((()=>{if(!t)return[{name:"Overall"}];t.forEach((e=>{e.label=e.name+" (interface residues)"}));return[{name:"Overall"},...t]}),[t]),{rmsds:k,AxesValues:R}=(0,r.useMemo)((()=>{if(!I)return{};const e=F[C],t=I.data.find((n=>n.name===e.name));if(!t)throw new Error(`Dataset for interaction "${e.name}" not found`);const r=t.rmsds,a=r.length,o=Math.floor(n.mdFrames/(a-1));return{rmsds:r,AxesValues:Array(a).fill(void 0).map(((e,n)=>n*o))}}),[I,n,F,C]),[O,V]=(0,r.useState)(null);(0,r.useMemo)((()=>{if(!S)return V(null);V((e=>null===e?S.map(((e,n)=>({name:`${n}. Frame ${e}`,frame:e}))):(S.forEach(((n,t)=>{const r=e[t];r.name=`${t}. Frame ${n}`,r.frame=n})),[...e])))}),[S]);const[T,D]=(0,r.useState)(null);return(0,r.useMemo)((()=>{if(!O)return D(null);const e=F[C],n=[{name:e.agent_1,interface:e.interface_indices_1},{name:e.agent_2,interface:e.interface_indices_2}];D((e=>{const t=[],r=C>0,a=!(!e||!e.find((e=>e.reference&&e.reference.includes(A[0]))));return null===e?O.forEach(((e,n)=>{E.forEach((a=>{const o={...a};o.name=`${e.name} - ${a.name}`,o.color=$.base[n],o.component=e.name,o.reference=`${x[n]} - ${a.name}`,r&&(o.name+=" reference",o.opacity=.1),t.push(o)}))})):O.forEach(((n,o)=>{E.forEach((s=>{const i=`${x[o]} - ${s.name}`,c=e.find((e=>e.reference===i));if(!c)throw new Error(`No previous representation with reference ${i}`);const l=c.name.split(" - ")[0];c.name=c.name.replace(l,n.name),c.component=n.name,r&&!a&&(c.name+=" reference",c.opacity=.1),!r&&a&&(c.name=c.name.replace(" reference",""),c.opacity=1),t.push(c)}))})),r&&(!1===a?O.forEach(((e,r)=>{n.forEach(((n,a)=>{const o=n.interface&&_.residueIndices2Ngl(n.interface);t.push({name:`${e.name} - ${n.name} interface`,color:$.interface[r][a],selection:o.rangedSelection,type:"licorice",component:e.name,reference:`${A[r]} - ${n.name}`})}))})):O.forEach(((r,a)=>{n.forEach((n=>{const o=n.interface&&_.residueIndices2Ngl(n.interface),s=`${A[a]} - ${n.name}`,i=e.find((e=>e.reference===s));i.name=`${r.name} - ${n.name} interface`,i.selection=o.rangedSelection,i.component=r.name,t.push(i)}))}))),e&&e.filter((e=>e.custom)).forEach((e=>{e.component=O[0].name,t.push(e)})),t}))}),[O,_,F,C,E]),v?(0,y.jsx)(l.A,{}):M?M.toString():I?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.A,{children:(0,y.jsxs)(a.A,{className:p.default.horizontal,children:[(0,y.jsx)(o.A,{variant:"h6",children:"Residues selection:"}),(0,y.jsx)(h.A,{interactions:F,selectedInteraction:C,setSelectedInteraction:N}),S&&(0,y.jsxs)("div",{children:[O&&O.map(((e,n)=>(0,y.jsx)(s.A,{label:"Frame "+e.frame,style:{margin:"0.2em",backgroundColor:0===n?"red":"blue"}},n))),C>0&&O&&O.map(((e,n)=>{const t=F[C];return[t.agent_1,t.agent_2].map(((t,r)=>(0,y.jsx)(s.A,{label:"Frame "+e.frame+" - "+t,style:{margin:"0.2em",backgroundColor:0===r?0===n?"orange":"purple":0===n?"yellow":"green"}},r)))}))]})]})}),(0,y.jsx)(c.A,{className:p.default.margined,id:"heatmap",children:(0,y.jsx)(a.A,{children:(0,y.jsx)(g.A,{inputData:{data:k,xLabels:R,yLabels:R},onTooltip:e=>{let{value:n,xAxisValue:t,yAxisValue:r}=e;return`${t} - ${r}\n${Math.round(100*n)/100} \xc5`},onClick:e=>{let{xAxisValue:n,yAxisValue:t}=e;return w([n,t])},legendTitle:"RMSD (\xc5)",maxColor:"red",minColor:"blue",xTitle:"Frames",yTitle:"Frames"})})}),(0,y.jsx)(m.A,{newViewer:O?{componentsState:[O,V],representationsState:[T,D],selRef:S,viewerRef:b}:null,onNail:e=>w((n=>e.selRef===n?null:n)),onClose:e=>w((n=>e.selRef===n?null:n))})]}):"Something bad happened"}},52527:(e,n,t)=>{t.r(n),t.d(n,{default:()=>r});const r={widest:"style_widest__hZ7sO",margined:"style_margined__GphyO","margined-bottom":"style_margined-bottom__KpiYO",horizontal:"style_horizontal__1xLer"}}}]);
//# sourceMappingURL=2874.68adf914.chunk.js.map