"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[7526],{10939:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(65043),o=r(12110),s=r(17604);const a="style_container__M9GCG";var c=r(70579);const l={opacity:[0,1]};(0,s.A)()||(l.transform=["translateY(50px)","translateY(0)"]);const i={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},u=(0,n.forwardRef)(((e,t)=>{let{overrideComponent:r,...s}=e;const u=(0,n.useRef)(null);(0,n.useLayoutEffect)((()=>{const e=u.current&&u.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),r=e.animate(l,{...i,delay:150*t});return()=>r.cancel()}),[]);const d=r?"section":o.A;return(0,c.jsx)("div",{ref:u,className:a,children:(0,c.jsx)(d,{component:"section",...s,ref:t})})}))},35847:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(65043),o=r(29449);const s=()=>{const{topology:e}=(0,n.useContext)(o.f);return(0,n.useMemo)((()=>{if(!e)return;if(!e.proteinReferences.some((e=>!!e.epitopes)))return;const t=e.proteinReferences.map((t=>{const r=t.uniprot,n=t.epitopes;if(!n)return[];const o=Object.values(n).map((e=>e.residues)),s=[].concat.apply([],o),a=Array.from(new Set(s)),c=e.getReferenceResidueIndices(r,a);return c||[]})),r=[].concat.apply([],Object.values(t)),{rangedSelection:n,small:o}=e.residueIndices2Ngl(r);return[{name:"Epitopes",selection:n||"none",type:o?"licorice":"cartoon",color:"purple"}]}),[e])}},97318:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(65043);const o=["red","green","blue","orange","purple"],s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const r=(0,n.useRef)([]);return(0,n.useMemo)((()=>[()=>{for(const t of e){if(-1===r.current.indexOf(t))return r.current.push(t),t}return t},e=>{if(e===t)return;const n=r.current.indexOf(e);if(-1===n)throw new Error(`Color ${e} is not used`);r.current.splice(n,1)},()=>{r.current=[]}]),[e,t])}},67526:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(65043),o=r(89257),s=r(71806),a=r(84882),c=r(28076),l=r(10039),i=r(37597),u=r(51962),d=r(73460),p=r(207),m=r(67803),f=r(85865),h=r(10939),A=r(92428),g=r(10419),x=r(88939),y=r(29449),v=r(17545),b=r(58338),j=r(97318),M=r(95747),k=r(35847),S=r(70579);const C=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],w=[10,25,50,100],_=(0,n.lazy)((()=>Promise.all([r.e(2577),r.e(2460),r.e(5291),r.e(5077)]).then(r.bind(r,75291)))),R={triggerOnce:!0,rootMargin:"100px"},N=e=>Math.round(10*e)/10,z=()=>{const[e,t]=(0,o.Wx)(R),{accessionAndMdNumber:r,metadata:z,proteinReferences:P,topology:$}=(0,n.useContext)(y.f),E=(0,n.useMemo)((()=>{if(!P)return[];const e=[];return P.forEach((t=>{const r=t.epitopes;if(!r)return;const n=Object.entries(r).map((e=>{let[r,n]=e;return[t.uniprot,r,n.residues,n.mas]}));e.push(...n)})),e}),[P]),O=(0,n.useRef)(null),I=(0,n.useRef)(null),F=(0,n.useRef)(null),T=(0,n.useRef)(null),[L,H]=(0,j.A)(),[B,V]=(0,n.useState)(!1),[D,q]=(0,n.useState)(null),[G,U]=(0,n.useState)([]),[Y,J]=(0,n.useState)(0),[K,Q]=(0,n.useState)(10),{loading:W,payload:X,error:Z}=(0,b.A)(`${M.nP}/${r}/analyses/sasa/`),{data:ee,epitopesData:te,frameStep:re,frameCount:ne,xTooltip:oe}=(0,n.useMemo)((()=>{if(!X||!z||!$||0===E.length)return{};const e=X.saspf,t=e[0].length,r=X.step||Math.floor(z.mdFrames/(t-1)),n=[];E.forEach((r=>{let[o,s,a,c]=r;const l=$.getReferenceResidueIndices(o,a);if(0===l.length)return{};const i=$.byChains(l),u=Object.keys(i),d={};Object.entries(i).forEach((t=>{let[r,n]=t;const o=n.map((t=>{const r={saspf:e[t]};return r.atoms=$.getResidueByIndex(t).atomCount,r}));d[r]=o}));const p={},m=[];Object.entries(d).forEach((e=>{let[r,n]=e;const o=n.length/a.length,s=o%1===0,l=c*o,i=[],u=[];for(let a=0;a<t;a++){const e=n.map((e=>e.saspf[a]*e.atoms)).reduce(((e,t)=>e+t),0);i.push(e);const t=e/l*100;u.push(t)}const d=(e=>{const t=e.reduce(((e,t)=>e+t),0),r=e.length;return N(t/r)})(i),f=`${r}:${d} \xc5\xb2 (${N(d/l*100)}%)${s?"":"*"}`;m.push(f),p[r]=u}));const{rangedSelection:f,small:h}=$.residueIndices2Ngl(l);n.push({name:s,data:p,selection:f,small:h,chains:u,summary:m.join("\n")})})),U(new Array(n.length).fill(null));return{data:e,epitopesData:n,frameStep:r,frameCount:t,xTooltip:e=>"frame "+e}}),[X,z,$,E]),se=(0,g.A)(),ae=(0,k.A)(),ce=(0,n.useMemo)((()=>{if(!r)return;return[{trajectoryURLs:[`${`${M.nP}/${r}/files/trajectory`}?frames=1:${z.mdFrames}:${re}`]}]}),[r,z,re]),[le,ie]=(0,n.useState)(null);(0,n.useMemo)((()=>{se&&0!==se.length&&ae&&0!==ae.length&&te&&ie((e=>{if(null===e){const e=[];return se.forEach((t=>{t.opacity=.3,t.color="black",e.push(t)})),G.forEach(((t,r)=>{if(null===t)return;const n=te[r],o={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:t};e.push(o)})),B&&e.push(...ae),e}const t=[];t.push(...se),G.forEach(((r,n)=>{if(null===r)return;const o=te[n],s=e.find((e=>e.name===o.name));if(s)return t.push(s);const a={name:o.name,selection:o.selection,type:o.small?"licorice":"cartoon",color:r};t.push(a)})),B&&t.push(...ae);const r=e.filter((e=>e.custom));return t.push(...r),t}))}),[te,se,ae,G,B]);const ue=(0,n.useMemo)((()=>{if(!te)return;if(null===D)return;const e=te[D];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]}),[te,D]),de=(0,n.useMemo)((()=>{if(!ee||!z||!te)return;const e={};return te.forEach(((t,r)=>{let{name:n,data:o}=t;if(!G[r])return;const s=G[r];Object.entries(o).forEach(((t,r)=>{let[o,a]=t;const c=C[r];e[n+"-"+o]={data:a,color:s,dash:c}}))})),e}),[ee,z,te,G]),pe=(0,n.useCallback)((e=>{F.current.togglePlaying(!1),F.current.currentFrame=e}),[]),me=(0,n.useCallback)((e=>{const t=Math.round(e*(ne-1));T.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]}),[ne]);if(W)return(0,S.jsx)(v.A,{});if(Z)return Z.toString();if(!X)return"Something bad happened";if(!$||!P)return(0,S.jsx)(v.A,{});if(0===E.length)return"Missing epitopes data";const fe=Y*K,he=(Y+1)*K;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.A,{className:x.default.tablecard,children:(0,S.jsx)("div",{className:x.default.paper,ref:I,children:(0,S.jsxs)(s.A,{stickyHeader:!0,size:"small",children:[(0,S.jsx)(a.A,{children:(0,S.jsxs)(c.A,{children:[(0,S.jsx)(l.A,{children:(0,S.jsx)(i.A,{onChange:()=>V((e=>!e)),control:(0,S.jsx)(u.A,{checked:B}),label:"Epitopes"})},0),(0,S.jsx)(l.A,{children:"Average SAS and exposure"},1)]})}),(0,S.jsx)(d.A,{children:te.slice(fe,he).map(((e,t)=>{let{name:r,summary:n}=e;const o=Y*K+t;return(0,S.jsx)(c.A,{role:"checkbox",className:o===D?x.default.selectedrow:x.default.row,onMouseEnter:()=>q(o),onMouseLeave:()=>q((e=>e===o?null:e)),children:[(0,S.jsx)(i.A,{"data-key":r,onMouseOver:()=>{O.current=o},onMouseOut:()=>{O.current=null},onChange:()=>U((e=>(e[o]?(H(e[o]),e[o]=null):e[o]=L(),[...e]))),control:(0,S.jsx)(u.A,{checked:!!G[o],style:{color:G[o]?G[o]:"black"},inputProps:{"data-key":r}}),label:(0,S.jsx)("a",{href:"https://www.rcsb.org/structure/"+r,target:"_blank",rel:"noreferrer noopener",children:r})},r),n].map((e=>(0,S.jsx)(l.A,{children:e},e)))},r)}))}),(0,S.jsx)(p.A,{children:(0,S.jsx)(c.A,{children:(0,S.jsx)(m.A,{rowsPerPageOptions:w,colSpan:4,count:te.length,rowsPerPage:K,page:Y,onPageChange:(e,t)=>{J(t),I.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;Q(t),J(0)}})})})]})})}),(0,S.jsx)(h.A,{className:x.default.nglcard,ref:e,children:t?(0,S.jsx)(A.default,{className:x.default.container,startingComponents:ce,representationsState:[le,ie],snapRepresentations:ue,onProgress:me,ref:F}):(0,S.jsx)("div",{style:{height:"50vh"}})}),(0,S.jsxs)(h.A,{className:x.default.graph,children:[G.every((e=>null===e))&&(0,S.jsx)("div",{className:x.default["graph-placeholder"],children:(0,S.jsx)(f.A,{variant:"h6",children:"No epitope selected"})}),(0,S.jsx)(_,{yData:de,step:re,xTooltip:oe,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:pe,displayLegend:!0,className:x.default.graph,ref:T})]})]})}},12110:(e,t,r)=>{r.d(t,{A:()=>g});var n=r(58168),o=r(98587),s=r(65043),a=r(58387),c=r(98610),l=r(34535),i=r(98206),u=r(63336),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var f=r(70579);const h=["className","raised"],A=(0,l.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),g=s.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:s,raised:l=!1}=r,u=(0,o.A)(r,h),d=(0,n.A)({},r,{raised:l}),p=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(d);return(0,f.jsx)(A,(0,n.A)({className:(0,a.A)(p.root,s),elevation:l?8:void 0,ref:t,ownerState:d},u))}))},51962:(e,t,r)=>{r.d(t,{A:()=>_});var n=r(98587),o=r(58168),s=r(65043),a=r(58387),c=r(98610),l=r(60061),i=r(33064),u=r(59662),d=r(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),f=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var h=r(6803),A=r(98206),g=r(34535),x=r(61475),y=r(92532),v=r(72372);function b(e){return(0,v.Ay)("MuiCheckbox",e)}const j=(0,y.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),M=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],k=(0,g.Ay)(i.A,{shouldForwardProp:e=>(0,x.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t[`size${(0,h.A)(r.size)}`],"default"!==r.color&&t[`color${(0,h.A)(r.color)}`]]}})((e=>{let{theme:t,ownerState:r}=e;return(0,o.A)({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${"default"===r.color?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,l.X4)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{[`&.${j.checked}, &.${j.indeterminate}`]:{color:(t.vars||t).palette[r.color].main},[`&.${j.disabled}`]:{color:(t.vars||t).palette.action.disabled}})})),S=(0,d.jsx)(m,{}),C=(0,d.jsx)(p,{}),w=(0,d.jsx)(f,{}),_=s.forwardRef((function(e,t){var r,l;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=S,color:p="primary",icon:m=C,indeterminate:f=!1,indeterminateIcon:g=w,inputProps:x,size:y="medium",className:v}=i,j=(0,n.A)(i,M),_=f?g:m,R=f?g:u,N=(0,o.A)({},i,{color:p,indeterminate:f,size:y}),z=(e=>{const{classes:t,indeterminate:r,color:n,size:s}=e,a={root:["root",r&&"indeterminate",`color${(0,h.A)(n)}`,`size${(0,h.A)(s)}`]},l=(0,c.A)(a,b,t);return(0,o.A)({},t,l)})(N);return(0,d.jsx)(k,(0,o.A)({type:"checkbox",inputProps:(0,o.A)({"data-indeterminate":f},x),icon:s.cloneElement(_,{fontSize:null!=(r=_.props.fontSize)?r:y}),checkedIcon:s.cloneElement(R,{fontSize:null!=(l=R.props.fontSize)?l:y}),ownerState:N,ref:t,className:(0,a.A)(z.root,v)},j,{classes:z}))}))},207:(e,t,r)=>{r.d(t,{A:()=>y});var n=r(58168),o=r(98587),s=r(65043),a=r(58387),c=r(98610),l=r(21573),i=r(98206),u=r(34535),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var f=r(70579);const h=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),g={variant:"footer"},x="tfoot",y=s.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:s,component:u=x}=r,d=(0,o.A)(r,h),p=(0,n.A)({},r,{component:u}),y=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(p);return(0,f.jsx)(l.A.Provider,{value:g,children:(0,f.jsx)(A,(0,n.A)({as:u,className:(0,a.A)(y.root,s),ref:t,role:u===x?null:"rowgroup",ownerState:p},d))})}))},88939:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n={paper:"style_paper__INgwI",tablecard:"style_tablecard__04qFr",nglcard:"style_nglcard__L-RSO",margined:"style_margined__SQ+iA",container:"style_container__UgV8T",selectedrow:"style_selectedrow__vdp-o",row:"style_row__6TSz1",graph:"style_graph__IyyKm","graph-placeholder":"style_graph-placeholder__ZJ5fh"}}}]);
//# sourceMappingURL=7526.151bd7e3.chunk.js.map