"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[790,9117],{10939:(e,t,r)=>{r.d(t,{A:()=>u});var o=r(65043),n=r(12110),s=r(17604);const a="style_container__M9GCG";var c=r(70579);const l={opacity:[0,1]};(0,s.A)()||(l.transform=["translateY(50px)","translateY(0)"]);const i={fill:"both",easing:"cubic-bezier(0, .99, .56, 1.1)",duration:500},u=(0,o.forwardRef)(((e,t)=>{let{overrideComponent:r,...s}=e;const u=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{const e=u.current&&u.current.firstElementChild;if(!e||!e.animate)return;const t=Array.from(document.querySelectorAll("main section")).findIndex((t=>e===t)),r=e.animate(l,{...i,delay:150*t});return()=>r.cancel()}),[]);const d=r?"section":n.A;return(0,c.jsx)("div",{ref:u,className:a,children:(0,c.jsx)(d,{component:"section",...s,ref:t})})}))},35847:(e,t,r)=>{r.d(t,{A:()=>s});var o=r(65043),n=r(29449);const s=()=>{const{topology:e}=(0,o.useContext)(n.f);return(0,o.useMemo)((()=>{if(!e)return;if(!e.proteinReferences.some((e=>!!e.epitopes)))return;const t=e.proteinReferences.map((t=>{const r=t.uniprot,o=t.epitopes;if(!o)return[];const n=Object.values(o).map((e=>e.residues)),s=[].concat.apply([],n),a=Array.from(new Set(s)),c=e.getReferenceResidueIndices(r,a);return c||[]})),r=[].concat.apply([],Object.values(t)),{rangedSelection:o,small:n}=e.residueIndices2Ngl(r);return[{name:"Epitopes",selection:o||"none",type:n?"licorice":"cartoon",color:"purple"}]}),[e])}},97318:(e,t,r)=>{r.d(t,{A:()=>s});var o=r(65043);const n=["red","green","blue","orange","purple"],s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black";const r=(0,o.useRef)([]);return(0,o.useMemo)((()=>[()=>{for(const t of e){if(-1===r.current.indexOf(t))return r.current.push(t),t}return t},e=>{if(e===t)return;const o=r.current.indexOf(e);if(-1===o)throw new Error(`Color ${e} is not used`);r.current.splice(o,1)},()=>{r.current=[]}]),[e,t])}},56642:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var o=r(65043),n=r(89257),s=r(71806),a=r(84882),c=r(28076),l=r(10039),i=r(68577),u=r(51962),d=r(73460),p=r(207),m=r(67803),f=r(85865),h=r(10939),A=r(92428),x=r(10419);const v="style_paper__INgwI",g="style_tablecard__04qFr",y="style_nglcard__L-RSO",b="style_container__UgV8T",j="style_selectedrow__vdp-o",C="style_row__6TSz1",M="style_graph__IyyKm",k="style_graph-placeholder__ZJ5fh";var S=r(29449),R=r(17545),w=r(58338),_=r(97318),N=r(95747),z=r(35847),P=r(70579);const $=[null,"10, 4","4, 4","10, 4, 1, 4","10, 4, 1, 4, 1, 4","1, 4"],E=[10,25,50,100],O=(0,o.lazy)((()=>Promise.all([r.e(4040),r.e(2577),r.e(5291),r.e(5077)]).then(r.bind(r,75291)))),I={triggerOnce:!0,rootMargin:"100px"},F=e=>Math.round(10*e)/10,T=()=>{const[e,t]=(0,n.Wx)(I),{accessionAndMdNumber:r,metadata:T,proteinReferences:L,topology:B}=(0,o.useContext)(S.f),H=(0,o.useMemo)((()=>{if(!L)return[];const e=[];return L.forEach((t=>{const r=t.epitopes;if(!r)return;const o=Object.entries(r).map((e=>{let[r,o]=e;return[t.uniprot,r,o.residues,o.mas]}));e.push(...o)})),e}),[L]),V=(0,o.useRef)(null),D=(0,o.useRef)(null),q=(0,o.useRef)(null),G=(0,o.useRef)(null),[U,Y]=(0,_.A)(),[J,K]=(0,o.useState)(!1),[W,X]=(0,o.useState)(null),[Z,Q]=(0,o.useState)([]),[ee,te]=(0,o.useState)(0),[re,oe]=(0,o.useState)(10),{loading:ne,payload:se,error:ae}=(0,w.A)(`${N.nP}/${r}/analyses/sasa/`),{data:ce,epitopesData:le,frameStep:ie,frameCount:ue,xTooltip:de}=(0,o.useMemo)((()=>{if(!se||!T||!B||0===H.length)return{};const e=se.saspf,t=e[0].length,r=se.step||Math.floor(T.mdFrames/(t-1)),o=[];H.forEach((r=>{let[n,s,a,c]=r;const l=B.getReferenceResidueIndices(n,a);if(0===l.length)return{};const i=B.byChains(l),u=Object.keys(i),d={};Object.entries(i).forEach((t=>{let[r,o]=t;const n=o.map((t=>{const r={saspf:e[t]};return r.atoms=B.getResidueByIndex(t).atomCount,r}));d[r]=n}));const p={},m=[];Object.entries(d).forEach((e=>{let[r,o]=e;const n=o.length/a.length,s=n%1===0,l=c*n,i=[],u=[];for(let a=0;a<t;a++){const e=o.map((e=>e.saspf[a]*e.atoms)).reduce(((e,t)=>e+t),0);i.push(e);const t=e/l*100;u.push(t)}const d=(e=>{const t=e.reduce(((e,t)=>e+t),0),r=e.length;return F(t/r)})(i),f=`${r}:${d} \xc5\xb2 (${F(d/l*100)}%)${s?"":"*"}`;m.push(f),p[r]=u}));const{rangedSelection:f,small:h}=B.residueIndices2Ngl(l);o.push({name:s,data:p,selection:f,small:h,chains:u,summary:m.join("\n")})})),Q(new Array(o.length).fill(null));return{data:e,epitopesData:o,frameStep:r,frameCount:t,xTooltip:e=>"frame "+e}}),[se,T,B,H]),pe=(0,x.A)(),me=(0,z.A)(),fe=(0,o.useMemo)((()=>{if(!r)return;return[{trajectoryURLs:[`${`${N.nP}/${r}/files/trajectory`}?frames=1:${T.mdFrames}:${ie}`]}]}),[r,T,ie]),[he,Ae]=(0,o.useState)(null);(0,o.useMemo)((()=>{pe&&0!==pe.length&&me&&0!==me.length&&le&&Ae((e=>{if(null===e){const e=[];return pe.forEach((t=>{t.opacity=.3,t.color="black",e.push(t)})),Z.forEach(((t,r)=>{if(null===t)return;const o=le[r],n={name:o.name,selection:o.selection,type:o.small?"licorice":"cartoon",color:t};e.push(n)})),J&&e.push(...me),e}const t=[];t.push(...pe),Z.forEach(((r,o)=>{if(null===r)return;const n=le[o],s=e.find((e=>e.name===n.name));if(s)return t.push(s);const a={name:n.name,selection:n.selection,type:n.small?"licorice":"cartoon",color:r};t.push(a)})),J&&t.push(...me);const r=e.filter((e=>e.custom));return t.push(...r),t}))}),[le,pe,me,Z,J]);const xe=(0,o.useMemo)((()=>{if(!le)return;if(null===W)return;const e=le[W];return[{name:e.name,selection:e.selection,type:"spacefill",color:"yellow",opacity:.15}]}),[le,W]),ve=(0,o.useMemo)((()=>{if(!ce||!T||!le)return;const e={};return le.forEach(((t,r)=>{let{name:o,data:n}=t;if(!Z[r])return;const s=Z[r];Object.entries(n).forEach(((t,r)=>{let[n,a]=t;const c=$[r];e[o+"-"+n]={data:a,color:s,dash:c}}))})),e}),[ce,T,le,Z]),ge=(0,o.useCallback)((e=>{q.current.togglePlaying(!1),q.current.currentFrame=e}),[]),ye=(0,o.useCallback)((e=>{const t=Math.round(e*(ue-1));G.current.marks=[{x:t,attr:{fill:"#c8c8c8"}}]}),[ue]);if(ne)return(0,P.jsx)(R.A,{});if(ae)return ae.toString();if(!se)return"Something bad happened";if(!B||!L)return(0,P.jsx)(R.A,{});if(0===H.length)return"Missing epitopes data";const be=ee*re,je=(ee+1)*re;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(h.A,{className:g,children:(0,P.jsx)("div",{className:v,ref:D,children:(0,P.jsxs)(s.A,{stickyHeader:!0,size:"small",children:[(0,P.jsx)(a.A,{children:(0,P.jsxs)(c.A,{children:[(0,P.jsx)(l.A,{children:(0,P.jsx)(i.A,{onChange:()=>K((e=>!e)),control:(0,P.jsx)(u.A,{checked:J}),label:"Epitopes"})},0),(0,P.jsx)(l.A,{children:"Average SAS and exposure"},1)]})}),(0,P.jsx)(d.A,{children:le.slice(be,je).map(((e,t)=>{let{name:r,summary:o}=e;const n=ee*re+t;return(0,P.jsx)(c.A,{role:"checkbox",className:n===W?j:C,onMouseEnter:()=>X(n),onMouseLeave:()=>X((e=>e===n?null:e)),children:[(0,P.jsx)(i.A,{"data-key":r,onMouseOver:()=>{V.current=n},onMouseOut:()=>{V.current=null},onChange:()=>Q((e=>(e[n]?(Y(e[n]),e[n]=null):e[n]=U(),[...e]))),control:(0,P.jsx)(u.A,{checked:!!Z[n],style:{color:Z[n]?Z[n]:"black"},inputProps:{"data-key":r}}),label:(0,P.jsx)("a",{href:"https://www.rcsb.org/structure/"+r,target:"_blank",rel:"noreferrer noopener",children:r})},r),o].map((e=>(0,P.jsx)(l.A,{children:e},e)))},r)}))}),(0,P.jsx)(p.A,{children:(0,P.jsx)(c.A,{children:(0,P.jsx)(m.A,{rowsPerPageOptions:E,colSpan:4,count:le.length,rowsPerPage:re,page:ee,onPageChange:(e,t)=>{te(t),D.current.scrollTop=0},onRowsPerPageChange:e=>{let{target:{value:t}}=e;oe(t),te(0)}})})})]})})}),(0,P.jsx)(h.A,{className:y,ref:e,children:t?(0,P.jsx)(A.default,{className:b,startingComponents:fe,representationsState:[he,Ae],snapRepresentations:xe,onProgress:ye,ref:q}):(0,P.jsx)("div",{style:{height:"50vh"}})}),(0,P.jsxs)(h.A,{className:M,children:[Z.every((e=>null===e))&&(0,P.jsx)("div",{className:k,children:(0,P.jsx)(f.A,{variant:"h6",children:"No epitope selected"})}),(0,P.jsx)(O,{yData:ve,step:ie,xTooltip:de,xScaleFactor:1,xAxisLabel:"Frames",yAxisLabel:"Exposure (%)",showPrecisionSlider:!1,blockMaxPrecision:!0,roundcents:!1,onSelect:ge,displayLegend:!0,className:M,ref:G})]})]})}},12110:(e,t,r)=>{r.d(t,{A:()=>x});var o=r(58168),n=r(98587),s=r(65043),a=r(58387),c=r(98610),l=r(34535),i=r(98206),u=r(63336),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var f=r(70579);const h=["className","raised"],A=(0,l.Ay)(u.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),x=s.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:s,raised:l=!1}=r,u=(0,n.A)(r,h),d=(0,o.A)({},r,{raised:l}),p=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(d);return(0,f.jsx)(A,(0,o.A)({className:(0,a.A)(p.root,s),elevation:l?8:void 0,ref:t,ownerState:d},u))}))},26494:(e,t,r)=>{r.d(t,{A:()=>A});var o=r(58168),n=r(98587),s=r(65043),a=r(58387),c=r(98610),l=r(34535),i=r(98206),u=r(92532),d=r(72372);function p(e){return(0,d.Ay)("MuiCardContent",e)}(0,u.A)("MuiCardContent",["root"]);var m=r(70579);const f=["className","component"],h=(0,l.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),A=s.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiCardContent"}),{className:s,component:l="div"}=r,u=(0,n.A)(r,f),d=(0,o.A)({},r,{component:l}),A=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},p,t)})(d);return(0,m.jsx)(h,(0,o.A)({as:l,className:(0,a.A)(A.root,s),ownerState:d,ref:t},u))}))},51962:(e,t,r)=>{r.d(t,{A:()=>w});var o=r(98587),n=r(58168),s=r(65043),a=r(58387),c=r(98610),l=r(67266),i=r(33064),u=r(59662),d=r(70579);const p=(0,u.A)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),f=(0,u.A)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var h=r(6803),A=r(98206),x=r(34535),v=r(61475),g=r(92532),y=r(72372);function b(e){return(0,y.Ay)("MuiCheckbox",e)}const j=(0,g.A)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),C=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],M=(0,x.Ay)(i.A,{shouldForwardProp:e=>(0,v.A)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.indeterminate&&t.indeterminate,t[`size${(0,h.A)(r.size)}`],"default"!==r.color&&t[`color${(0,h.A)(r.color)}`]]}})((e=>{let{theme:t,ownerState:r}=e;return(0,n.A)({color:(t.vars||t).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${"default"===r.color?t.vars.palette.action.activeChannel:t.vars.palette[r.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,l.X4)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{[`&.${j.checked}, &.${j.indeterminate}`]:{color:(t.vars||t).palette[r.color].main},[`&.${j.disabled}`]:{color:(t.vars||t).palette.action.disabled}})})),k=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),R=(0,d.jsx)(f,{}),w=s.forwardRef((function(e,t){var r,l;const i=(0,A.b)({props:e,name:"MuiCheckbox"}),{checkedIcon:u=k,color:p="primary",icon:m=S,indeterminate:f=!1,indeterminateIcon:x=R,inputProps:v,size:g="medium",className:y}=i,j=(0,o.A)(i,C),w=f?x:m,_=f?x:u,N=(0,n.A)({},i,{color:p,indeterminate:f,size:g}),z=(e=>{const{classes:t,indeterminate:r,color:o,size:s}=e,a={root:["root",r&&"indeterminate",`color${(0,h.A)(o)}`,`size${(0,h.A)(s)}`]},l=(0,c.A)(a,b,t);return(0,n.A)({},t,l)})(N);return(0,d.jsx)(M,(0,n.A)({type:"checkbox",inputProps:(0,n.A)({"data-indeterminate":f},v),icon:s.cloneElement(w,{fontSize:null!=(r=w.props.fontSize)?r:g}),checkedIcon:s.cloneElement(_,{fontSize:null!=(l=_.props.fontSize)?l:g}),ownerState:N,ref:t,className:(0,a.A)(z.root,y)},j,{classes:z}))}))},207:(e,t,r)=>{r.d(t,{A:()=>g});var o=r(58168),n=r(98587),s=r(65043),a=r(58387),c=r(98610),l=r(21573),i=r(98206),u=r(34535),d=r(92532),p=r(72372);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,d.A)("MuiTableFooter",["root"]);var f=r(70579);const h=["className","component"],A=(0,u.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"table-footer-group"}),x={variant:"footer"},v="tfoot",g=s.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiTableFooter"}),{className:s,component:u=v}=r,d=(0,n.A)(r,h),p=(0,o.A)({},r,{component:u}),g=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},m,t)})(p);return(0,f.jsx)(l.A.Provider,{value:x,children:(0,f.jsx)(A,(0,o.A)({as:u,className:(0,a.A)(g.root,s),ref:t,role:u===v?null:"rowgroup",ownerState:p},d))})}))}}]);
//# sourceMappingURL=epitopes.f3bd95f5.chunk.js.map