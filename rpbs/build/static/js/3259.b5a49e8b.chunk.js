"use strict";(self.webpackChunkmdposit=self.webpackChunkmdposit||[]).push([[3259,7732,9117],{23621:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(65043),n=t(89257),l=t(85865),r=t(32577),o=t(10939),i=t(92428),c=t(10419),d=t(17545),u=t(58338),p=t(29449),h=t(95747),f=t(27732),m=t(82746),g=t(48838),x=t(75291),y=t(70579);const b={triggerOnce:!0,rootMargin:"100px"},A=["grey","yellow","red"],S={atoms:"spacefill",residues:"spacefill",chains:"spacefill",selections:"spacefill"},C=()=>{const[e,s]=(0,n.Wx)(b),{accession:t,accessionAndMdNumber:C,metadata:k,topology:v,populations:j}=(0,a.useContext)(p.f),_=(0,c.A)(),R=(0,a.useRef)(null),M=(0,a.useRef)(null),{loading:N,payload:T,error:$}=(0,u.A)(`${h.nP}/${C}/analyses/sasa/`),[I,w]=(0,a.useState)([]),{components:E,representations:L,framesNumber:P,xAxisStep:D,xAxisLabel:F,isEnsemble:W,xTooltip:H,xWeights:B,data:Y}=(0,a.useMemo)((()=>{if(!v||!k||!T||j&&j.loading)return{};const e=v.residueCount;if(e!==T.saspf.length)throw new Error("Number of residues in the analysis does not match number of residues in the topology");const s={saspf:[],means:[],stdvs:[]};for(let r=0;r<e;r++){1===v.getResidueByIndex(r).atomCount?(s.saspf[r]=null,s.means[r]=null,s.stdvs[r]=null):(s.saspf[r]=T.saspf[r],s.means[r]=T.means[r],s.stdvs[r]=T.stdvs[r])}let t;for(let r=0;r<e;r++)if(s.saspf[r]){if(void 0!==t){t=null;break}t=r}null!==t&&w([{color:"black",index:t}]);const a=s.means,n=Math.max(...a),l=Math.min(...a),o=(0,r.m4Y)().range(A).domain([l,(l+n)/2,n]),i=m.ColormakerRegistry.addScheme((function(e){this.atomColor=e=>{const s=e.residueIndex;if(1===v.getResidueByIndex(s).atomCount)return 16777215;const t=a[s];if(null===t)return 16777215;const n=(0,r.yWT)(o(t)).formatHex();return parseInt(n.substring(1),16)}})),c=T.step,d=[{trajectoryURLs:[`${`${h.nP}/${C}/files/trajectory`}?frames=1:${k.mdFrames}:${c}`]}],u=[];_.forEach((e=>{const s={...e};s.color="custom",s.customScheme=i,s.type="spacefill",u.push(s)}));const p=s.saspf[0].length,f=k.timeLength,g="ensemble"===k.TYPE;let x,y,b,S;if(g||!f?(x=c,y="Frames",b=e=>"frame "+e):(x=f/(p-1),y="Time (ns)",b=e=>+e.toFixed(2)+" ns"),j&&j.payload){S=[];for(let e=0;e<j.payload.length;e+=x)S.push(j.payload[e])}return{components:d,representations:u,framesNumber:p,xAxisStep:x,xAxisLabel:y,isEnsemble:g,xTooltip:b,xWeights:S,data:s}}),[T,v,k,t,_,j,w]),{selectedData:G,selectedResidueIndices:O}=(0,a.useMemo)((()=>{const e={},s=[];return I.forEach(((t,a)=>{const n={data:Y.saspf[t.index]};n.color=t.color,e[a]=n,s.push(t.index)})),{selectedData:e,selectedResidueIndices:s}}),[Y,I]),U=(0,a.useCallback)((e=>{R.current.togglePlaying(!1),R.current.currentFrame=e}),[]),V=(0,a.useCallback)((e=>{if(!M.current)return;const s=Math.round(e*(P-1));M.current.marks=[{x:s,attr:{fill:"#c8c8c8"}}]}),[P]),q=(0,a.useCallback)(((e,s,t)=>{const a={color:t,index:s};w((e=>[...e,a]))}),[w]),z=(0,a.useCallback)(((e,s)=>{w((e=>e.filter((e=>e.index!==s))))}),[w]),J=(0,a.useCallback)((()=>{w([])}),[w]),K=(0,a.useCallback)(((e,s)=>{const t=Y.means[s],a=Y.stdvs[s];return`Mean SAS: ${Math.round(100*t)/100}\nStandard deviation: ${Math.round(100*a)/100}`}),[Y]);return N||j&&j.loading?(0,y.jsx)(d.A,{}):$?$.toString():j&&j.error?j.error.toString():T?j&&!j.payload?"Something bad happened with populations":v&&k?(0,y.jsxs)(a.Suspense,{fallback:(0,y.jsx)(d.A,{}),children:[v.residueCount>1&&(0,y.jsx)(o.A,{children:(0,y.jsx)(g.A,{residueValues:Y.means,legendTitle:"Average Relative SAS (\xc5\xb2)",onSelect:q,onDeselect:z,onClean:J,onTooltip:K})}),(0,y.jsx)(o.A,{className:f.default.graphcard,children:I.length>0?(0,y.jsx)(x.default,{yData:G,step:D,xAxisLabel:F,yAxisLabel:"Relative SAS (\xc5\xb2)",type:W?"dots":"line",xWeights:B,xTooltip:H,onSelect:U,className:f.default.graph,ref:M}):(0,y.jsx)("div",{className:f.default["graph-placeholder"],children:(0,y.jsx)(l.A,{variant:"h6",children:"No residue selected"})})}),(0,y.jsx)(o.A,{className:f.default.nglcard,ref:e,children:s?(0,y.jsx)(i.default,{className:f.default.container,startingComponents:E,startingRepresentations:L,selectedResidueIndices:O,onProgress:V,ref:R,framesSelect:!1,highlightTypes:S}):(0,y.jsx)("div",{style:{height:"50vh"}})})]}):(0,y.jsx)(d.A,{}):"Something bad happened"}},27732:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});const a={graphcard:"style_graphcard__Cgh8H",graph:"style_graph__rikGP","graph-placeholder":"style_graph-placeholder__ef29F",nglcard:"style_nglcard__lD0br",container:"style_container__lvt9H"}}}]);
//# sourceMappingURL=3259.b5a49e8b.chunk.js.map